/*! For license information please see owl.slim.502620b0e0457194f383.js.LICENSE.txt */
var Microsoft;!function(){"use strict";var n,t,e,o,i={9323:function(n,t,e){e.d(t,{X:function(){return u}});var o=e(4401),i=e(857),r=e(765),u=function(n){function t(t){var e=n.call(this)||this;return e.H=t,e}return o.ZT(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype.A=function(t){var e=n.prototype.A.call(this,t);return e&&!e.closed&&t.next(this.H),e},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.N;return this.H},t.prototype.next=function(t){n.prototype.next.call(this,this.H=t)},t}(i.xQ)},4813:function(n,t,e){e.d(t,{y:function(){return l}});var o=e(7191),i=e(3066),r=e(2055),u=e(3140);function s(n){return n}var a=e(4505),l=function(){function n(n){this.F=!1,n&&(this.A=n)}return n.prototype.lift=function(t){var e=new n;return e.source=this,e.operator=t,e},n.prototype.subscribe=function(n,t,e){var u=this.operator,s=function(n,t,e){if(n){if(n instanceof o.L)return n;if(n[i.b])return n[i.b]()}return n||t||e?new o.L(n,t,e):new o.L(r.c)}(n,t,e);if(u?s.add(u.call(s,this.source)):s.add(this.source||a.v.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this.A(s):this.P(s)),a.v.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},n.prototype.P=function(n){try{return this.A(n)}catch(t){a.v.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=t),function(n){for(;n;){var t=n,e=t.closed,i=t.destination,r=t.isStopped;if(e||r)return!1;n=i&&i instanceof o.L?i:null}return!0}(n)&&n.error(t)}},n.prototype.forEach=function(n,t){var e=this;return new(t=c(t))((function(t,o){var i;i=e.subscribe((function(t){try{n(t)}catch(n){o(n),i&&i.unsubscribe()}}),o,t)}))},n.prototype.A=function(n){var t=this.source;return t&&t.subscribe(n)},n.prototype[u.L]=function(){return this},n.prototype.pipe=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return 0===n.length?this:(0===(e=n).length?s:1===e.length?e[0]:function(n){return e.reduce((function(n,t){return t(n)}),n)})(this);var e},n.prototype.toPromise=function(n){var t=this;return new(n=c(n))((function(n,e){var o;t.subscribe((function(n){return o=n}),(function(n){return e(n)}),(function(){return n(o)}))}))},n.create=function(t){return new n(t)},n}();function c(n){if(n||(n=a.v.Promise||Promise),!n)throw new Error("no Promise impl found");return n}},2055:function(n,t,e){e.d(t,{c:function(){return r}});var o=e(4505),i=e(9567),r={closed:!0,next:function(n){},error:function(n){if(o.v.useDeprecatedSynchronousErrorHandling)throw n;(0,i.z)(n)},complete:function(){}}},857:function(n,t,e){e.d(t,{xQ:function(){return d}});var o=e(4401),i=e(4813),r=e(7191),u=e(9640),s=e(765),a=function(n){function t(t,e){var o=n.call(this)||this;return o.subject=t,o.subscriber=e,o.closed=!1,o}return o.ZT(t,n),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var n=this.subject,t=n.observers;if(this.subject=null,t&&0!==t.length&&!n.isStopped&&!n.closed){var e=t.indexOf(this.subscriber);-1!==e&&t.splice(e,1)}}},t}(u.w),l=e(3066),c=function(n){function t(t){var e=n.call(this,t)||this;return e.destination=t,e}return o.ZT(t,n),t}(r.L),d=function(n){function t(){var t=n.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o.ZT(t,n),t.prototype[l.b]=function(){return new c(this)},t.prototype.lift=function(n){var t=new f(this,this);return t.operator=n,t},t.prototype.next=function(n){if(this.closed)throw new s.N;if(!this.isStopped)for(var t=this.observers,e=t.length,o=t.slice(),i=0;i<e;i++)o[i].next(n)},t.prototype.error=function(n){if(this.closed)throw new s.N;this.hasError=!0,this.thrownError=n,this.isStopped=!0;for(var t=this.observers,e=t.length,o=t.slice(),i=0;i<e;i++)o[i].error(n);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.N;this.isStopped=!0;for(var n=this.observers,t=n.length,e=n.slice(),o=0;o<t;o++)e[o].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype.P=function(t){if(this.closed)throw new s.N;return n.prototype.P.call(this,t)},t.prototype.A=function(n){if(this.closed)throw new s.N;return this.hasError?(n.error(this.thrownError),u.w.EMPTY):this.isStopped?(n.complete(),u.w.EMPTY):(this.observers.push(n),new a(this,n))},t.prototype.asObservable=function(){var n=new i.y;return n.source=this,n},t.create=function(n,t){return new f(n,t)},t}(i.y),f=function(n){function t(t,e){var o=n.call(this)||this;return o.destination=t,o.source=e,o}return o.ZT(t,n),t.prototype.next=function(n){var t=this.destination;t&&t.next&&t.next(n)},t.prototype.error=function(n){var t=this.destination;t&&t.error&&this.destination.error(n)},t.prototype.complete=function(){var n=this.destination;n&&n.complete&&this.destination.complete()},t.prototype.A=function(n){return this.source?this.source.subscribe(n):u.w.EMPTY},t}(d)},7191:function(n,t,e){e.d(t,{L:function(){return c}});var o=e(4401),i=e(555),r=e(2055),u=e(9640),s=e(3066),a=e(4505),l=e(9567),c=function(n){function t(e,o,i){var u=n.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=r.c;break;case 1:if(!e){u.destination=r.c;break}if("object"==typeof e){e instanceof t?(u.syncErrorThrowable=e.syncErrorThrowable,u.destination=e,e.add(u)):(u.syncErrorThrowable=!0,u.destination=new d(u,e));break}default:u.syncErrorThrowable=!0,u.destination=new d(u,e,o,i)}return u}return o.ZT(t,n),t.prototype[s.b]=function(){return this},t.create=function(n,e,o){var i=new t(n,e,o);return i.syncErrorThrowable=!1,i},t.prototype.next=function(n){this.isStopped||this._(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this.B(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.J())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},t.prototype._=function(n){this.destination.next(n)},t.prototype.B=function(n){this.destination.error(n),this.unsubscribe()},t.prototype.J=function(){this.destination.complete(),this.unsubscribe()},t.prototype.Y=function(){var n=this.$;return this.$=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.$=n,this},t}(u.w),d=function(n){function t(t,e,o,u){var s,a=n.call(this)||this;a.nn=t;var l=a;return(0,i.m)(e)?s=e:e&&(s=e.next,o=e.error,u=e.complete,e!==r.c&&(l=Object.create(e),(0,i.m)(l.unsubscribe)&&a.add(l.unsubscribe.bind(l)),l.unsubscribe=a.unsubscribe.bind(a))),a.tn=l,a._=s,a.B=o,a.J=u,a}return o.ZT(t,n),t.prototype.next=function(n){if(!this.isStopped&&this._){var t=this.nn;a.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._,n)&&this.unsubscribe():this.__tryOrUnsub(this._,n)}},t.prototype.error=function(n){if(!this.isStopped){var t=this.nn,e=a.v.useDeprecatedSynchronousErrorHandling;if(this.B)e&&t.syncErrorThrowable?(this.__tryOrSetError(t,this.B,n),this.unsubscribe()):(this.__tryOrUnsub(this.B,n),this.unsubscribe());else if(t.syncErrorThrowable)e?(t.syncErrorValue=n,t.syncErrorThrown=!0):(0,l.z)(n),this.unsubscribe();else{if(this.unsubscribe(),e)throw n;(0,l.z)(n)}}},t.prototype.complete=function(){var n=this;if(!this.isStopped){var t=this.nn;if(this.J){var e=function(){return n.J.call(n.tn)};a.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(n,t){try{n.call(this.tn,t)}catch(n){if(this.unsubscribe(),a.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}},t.prototype.__tryOrSetError=function(n,t,e){if(!a.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this.tn,e)}catch(t){return a.v.useDeprecatedSynchronousErrorHandling?(n.syncErrorValue=t,n.syncErrorThrown=!0,!0):((0,l.z)(t),!0)}return!1},t.prototype.en=function(){var n=this.nn;this.tn=null,this.nn=null,n.unsubscribe()},t}(c)},9640:function(n,t,e){e.d(t,{w:function(){return s}});var o=e(5638),i=e(4289),r=e(555),u=function(){function n(n){return Error.call(this),this.message=n?n.length+" errors occurred during unsubscription:\n"+n.map((function(n,t){return t+1+") "+n.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=n,this}return n.prototype=Object.create(Error.prototype),n}(),s=function(){function n(n){this.closed=!1,this.$=null,this.rn=null,n&&(this.un=!0,this.en=n)}var t;return n.prototype.unsubscribe=function(){var t;if(!this.closed){var e=this,s=e.$,l=e.un,c=e.en,d=e.rn;if(this.closed=!0,this.$=null,this.rn=null,s instanceof n)s.remove(this);else if(null!==s)for(var f=0;f<s.length;++f)s[f].remove(this);if((0,r.m)(c)){l&&(this.en=void 0);try{c.call(this)}catch(n){t=n instanceof u?a(n.errors):[n]}}if((0,o.k)(d)){f=-1;for(var v=d.length;++f<v;){var h=d[f];if((0,i.K)(h))try{h.unsubscribe()}catch(n){t=t||[],n instanceof u?t=t.concat(a(n.errors)):t.push(n)}}}if(t)throw new u(t)}},n.prototype.add=function(t){var e=t;if(!t)return n.EMPTY;switch(typeof t){case"function":e=new n(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof n)){var o=e;(e=new n).rn=[o]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=e.$;if(null===i)e.$=this;else if(i instanceof n){if(i===this)return e;e.$=[i,this]}else{if(-1!==i.indexOf(this))return e;i.push(this)}var r=this.rn;return null===r?this.rn=[e]:r.push(e),e},n.prototype.remove=function(n){var t=this.rn;if(t){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}},n.EMPTY=((t=new n).closed=!0,t),n}();function a(n){return n.reduce((function(n,t){return n.concat(t instanceof u?t.errors:t)}),[])}},4505:function(n,t,e){e.d(t,{v:function(){return i}});var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){o=n},get useDeprecatedSynchronousErrorHandling(){return o}}},3140:function(n,t,e){e.d(t,{L:function(){return o}});var o=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},3066:function(n,t,e){e.d(t,{b:function(){return o}});var o=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},765:function(n,t,e){e.d(t,{N:function(){return o}});var o=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}()},9567:function(n,t,e){function o(n){setTimeout((function(){throw n}),0)}e.d(t,{z:function(){return o}})},5638:function(n,t,e){e.d(t,{k:function(){return o}});var o=function(){return Array.isArray||function(n){return n&&"number"==typeof n.length}}()},555:function(n,t,e){function o(n){return"function"==typeof n}e.d(t,{m:function(){return o}})},4289:function(n,t,e){function o(n){return null!==n&&"object"==typeof n}e.d(t,{K:function(){return o}})},4401:function(n,t,e){e.d(t,{ZT:function(){return i}});var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])},o(n,t)};function i(n,t){function e(){this.constructor=n}o(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}},9029:function(n,t,e){e.d(t,{CR:function(){return s},Jh:function(){return r},XA:function(){return u},ev:function(){return a},mG:function(){return i},pi:function(){return o}});var o=function(){return o=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},o.apply(this,arguments)};function i(n,t,e,o){return new(e||(e=Promise))((function(i,r){function u(n){try{a(o.next(n))}catch(n){r(n)}}function s(n){try{a(o.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,s)}a((o=o.apply(n,t||[])).next())}))}function r(n,t){var e,o,i,r,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(a){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(u=0)),u;)try{if(e=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=t.call(n,u)}catch(n){s=[6,n],o=0}finally{e=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],o=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var o,i,r=e.call(n),u=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)u.push(o.value)}catch(n){i={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(i)throw i.error}}return u}function a(n,t,e){if(e||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return n.concat(o||Array.prototype.slice.call(t))}Object.create,Object.create},7866:function(n,t,e){var o;e.d(t,{O:function(){return o}}),function(n){n.blurFocus="blurFocus",n.boot="boot",n.completeCreateNew="completeCreateNew",n.continueAccessibilityLoop="continueAccessibilityLoop",n.createNew="createNew",n.dispose="dispose",n.grabFocus="grabFocus",n.moveToFolder="moveToFolder",n.popState="popState",n.sendChannelId="sendChannelId",n.sendConvId="sendConvId",n.teamsUsersReply="teamsUsersReply",n.teamsUserMentionReply="teamsUserMentionReply",n.backButtonPressed="backButtonPressed",n.getClientUrl="getClientUrl",n.getWebUrl="getWebUrl",n.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",n.rename="rename",n.completeSharedFilePicker="completeSharedFilePicker",n.sendAccessToken="sendAccessToken",n.sendAuthToken="sendAuthToken",n.sendCustomAuthConfig="sendCustomAuthConfig",n.sendEmbeddedViewUrl="sendEmbeddedViewUrl",n.sendFrameTrustResult="sendFrameTrustResult",n.sendHWRTelemetry="sendHWRTelemetry",n.sendSessionInfo="sendSessionInfo",n.sendUserAccessAndPermissions="sendUserAccessAndPermissions",n.sendWopiInfo="sendWopiInfo",n.sendDavUrl="sendDavUrl",n.switchMode="switchMode",n.signalShared="signalShared",n.postWacToken="postWacToken"}(o||(o={}))},3270:function(n,t,e){var o;e.d(t,{L8:function(){return d}}),function(n){n[n.Trace=0]="Trace",n[n.Assert=1]="Assert"}(o||(o={}));var i,r,u=e(4320),s=e(397),a=function(){function n(n){var t=this;this.sn=3e4,this.an=30,this.ln=0,this.cn=[],this.dn=(0,s.Ks)(),this.fn=[],this.vn="",this.hn=0,this.flushOnClose=function(){t.pn(!1,!1)},this.flush=function(){t.mn()},this.flushAndSetNewEndpoint=function(n,e){var o,i=t.wn(n);i.localeCompare(null!==(o=t.gn)&&void 0!==o?o:"",void 0,{sensitivity:"accent"})&&(t.fn.push((function(){t.gn=i,e&&e()})),t.pn(!0,!0))},this.wn=function(n){return n+"?usid="+t.vn+"&officeserverversion="+function(){try{return"20240319.8"}catch(n){return"###VERSION###"}}()},this.mn=function(){window.setTimeout((function(){return t.pn(!0,!0)}),0)},this.pn=function(n,e){var o,i,r,u,a,l,c,d=(0,s.u3)();window.clearTimeout(t.Sn),t.gn&&(t.cn.length>0&&(t.ln+=1,function(n,t,e){if(t){var o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,n)}catch(n){}!function(n,t,e){var o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,e),o.send(n))}(n,t,e)}}((o=t.cn.splice(0,n?t.an:t.cn.length),i=t.vn,r=t.ln,u=t.dn,a=[],l=o.map((function(n){return function(n,t,e){var o={};if(o.G=n.tag,o.T=n.timestamp-t,o.M=n.message,o.C=n.category,n.correlationId){var i=e.findIndex((function(t){return t===n.correlationId}));i<0&&(i=e.push(n.correlationId)-1),o.I=i}var r=1e3*n.type+n.level;return o.D=r,o}(n,u,a)})),c=function(n,t,e,o,i){var r={};return r.T=n,r.L=t,r.S=e,r.I=o,i&&i.length>0&&(r.W=i),r.V=1,r}(u,l,i,r,a),JSON.stringify(c)),t.gn,e),t.dn=(0,s.Ks)()),0===t.cn.length&&t.fn.length>0&&(t.fn.forEach((function(n){"requestIdleCallback"in window?window.requestIdleCallback(n):window.setTimeout(n,0)})),t.fn=[]),n&&(t.Sn=window.setTimeout((function(){t.mn()}),t.cn.length>t.an||t.fn.length>0?1e3:t.sn)),t.hn+=(0,s.u3)()-d)},n&&this.configure(n)}return n.prototype.getTimeSpentLogging=function(){return this.hn},n.prototype.addLoggingTime=function(n){this.hn+=n},n.prototype.configure=function(n){var t=this,e=(0,s.u3)();if(n.uploadCadenceInMs&&(this.sn=n.uploadCadenceInMs),n.uploadTriggerSize&&(this.an=n.uploadTriggerSize),n.sessionId&&(this.vn=n.sessionId),n.remoteUlsEndpoint){if(!n.sessionId&&this.gn)throw new Error("Remote ULS endpoint is already set");this.gn=this.wn(n.remoteUlsEndpoint),this.dn=(0,s.Ks)(),window.setTimeout((function(){return t.pn(!0,!0)}),0)}this.hn+=(0,s.u3)()-e},n.prototype.handleTrace=function(n){var t=(0,s.u3)();n.message.length>3072&&(n.message=n.message.substring(0,3059)+"... [Trimmed]"),this.cn.push(n),(this.cn.length>this.an||n.level===u.G.Error)&&this.mn(),this.hn+=(0,s.u3)()-t},n.prototype.getUserSessionId=function(){return this.vn},n}(),l=[];!function(n){n.bn="BootstrapperMaxUlsHeartbeatTime",n.Hn="BootstrapperNoCompleteWarning1Time",n.Cn="BootstrapperNoCompleteWarning2Time",n.In="RemoteUlsETag",n.An="RemoteUlsSuppressions",n.Un="BootstrapperSettingsFetchPeriod",n.yn="timestamp",n.Tn="BootstrapperUlsHeartbeatIntervalMs",n.Fn="BootstrapperUlsHeartBeatIsEnabled",n.Nn="BootstrapperUlsUploadCadenceMs",n.En="WordConsumptionViewToEditRedirectIsEnabled",n.kn="RequestedCallThrottlingDefaultToViewMinimumValue",n.Pn="BulsEndpointUrl",n.Rn="EnableCommonHostDiagnosticsParams",n.Dn="EnableICNForWord",n.On="EnableModernEmbedViewForPowerPoint",n.Wn="EnableModernEmbedViewInOneUpForPowerPoint",n.jn="EnableModernReadingViewForPowerPoint",n._n="EnableDefaultToModernForPowerPoint",n.Mn="ShouldLogJsApiKpisForWord",n.xn="WordSwitchToViewInTeamsJsapiV1Enabled",n.Ln="EnableWordSessionRefreshTelemetry",n.Kn="PowerPointUseEssDCHint",n.Gn="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",n.Vn="ModernReadingViewBootstrapperFeatureGatesForPowerPoint"}(r||(r={}));var c=6e4;function d(n){var t=new a(n);function e(n,e,i,r){var u=(0,s.u3)();if(!function(n){return 1===l[n]}(n)){var a={timestamp:(0,s.Ks)(),category:e,tag:n,level:i,type:o.Trace,message:r,correlationId:""};t.addLoggingTime((0,s.u3)()-u),t.handleTrace(a)}}return{ULS:{sendTraceTag:function(n,t,o,i){e(n,t,o,i)},shipAssertTag:function(n,t,o,i){o&&e(n,t,u.G.Error,i)},debugAssertTag:function(n,t,e,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(n){t.configure(n)},settingsChangeHandler:function(n){var e,o;e=n.Jn.getValue(r.An,""),o=n.Jn.getValue(r.In,""),i&&o===i||(l=[],i=o,e&&e.split(",").forEach((function(n){var t=parseInt(n,10);t&&(l[t]=1)}))),t.configure({uploadCadenceInMs:n.Jn.getValue(r.Nn,c)});var u=n.Jn.getValue(r.Pn,"").toString();""!==u&&t.flushAndSetNewEndpoint(u)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(n,e){t.flushAndSetNewEndpoint(n,e)}}}},9644:function(n,t,e){e.d(t,{n:function(){return u}});var o=e(9029);function i(n){if(!n)return"";var t=Object.getOwnPropertyNames(n),e=Object.getOwnPropertyNames(Object.getPrototypeOf(n));return JSON.stringify(n,(0,o.ev)((0,o.ev)([],t,!0),e,!0))}var r=e(397);function u(){var n=new Uint8Array(31),t=function(n){var t={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){t.crypto=!0;try{return e.getRandomValues(n),t}catch(n){t.exceptions.push("crypto: ".concat(i(n)))}}t.perfNow=r.Xm;for(var o=0;o<n.length;o+=1){try{if(r.Xm){var u=Math.floor(100*window.performance.now())%10;(u<0||u>9)&&(u=0);for(var s=0;s<u;s+=1)Math.random()}}catch(n){t.exceptions.push("Math.random: ".concat(i(n)))}n[o]=Math.floor(16*Math.random())}return t}(n),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=15&n[e];return e+=1,("x"===t?o:3&o|8).toString(16)})),t]}},397:function(n,t,e){e.d(t,{Ks:function(){return u},Xm:function(){return i},u3:function(){return r}});var o,i=function(){try{var n=window.performance;return n&&n.now&&n.now()!==1/0}catch(n){return!1}}();function r(){return i?window.performance.now():Date.now()}function u(){if(!o){var n=window.performance;o=i&&n.timing&&n.timing.navigationStart?function(){return Math.round(n.now()+n.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return o()}},6012:function(n,t,e){e.d(t,{o:function(){return o}});var o,i=e(1709),r=e(9029),u=function(){function n(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return n.prototype.isEventBlocked=function(n){var t=this.blockedEvents.get(n);return!!t&&(Date.now()>=t?(this.unblockEvent(n),!1):(this.aggregateEventCount(n),!0))},n.prototype.blockEvent=function(n,t){var e=Date.now()+t;this.blockedEvents.set(n,e),this.updateEventHitCount(n,0),this.eventDurations.delete(n),this.eventDurationsTotal.delete(n)},n.prototype.unblockEvent=function(n){this.blockedEvents.delete(n)},n.prototype.getEventHitCount=function(n){return this.eventHitCounts.get(n)},n.prototype.updateEventHitCount=function(n,t){this.eventHitCounts.set(n,t)},n.prototype.aggregateEventCount=function(n){var t=this.getEventHitCount(n);"number"==typeof t&&this.updateEventHitCount(n,++t)},n.prototype.getEventDurations=function(n){return this.eventDurations.get(n)},n.prototype.aggregateEventDuration=function(n,t){var e,o=(null!==(e=this.getEventHitCount(n))&&void 0!==e?e:0)+1,i=this.eventDurationsTotal.get(n),u=this.eventDurations.get(n);if(void 0!==u){var s=(0,r.ev)([],u,!0);u[0]>t&&(s[0]=t),u[1]<t&&(s[1]=t);var a=void 0;void 0!==i&&i.length<10?(i.push(t),a=i.reduce((function(n,t){return n+t}),0)/o):(a=u[2]+(t-u[2])/o,this.eventDurationsTotal.delete(n)),s[2]=a,this.eventDurations.set(n,s)}else this.eventDurations.set(n,[t,t,t]),this.eventDurationsTotal.set(n,[t])},n}(),s=function(){function n(n,t,e,o,i){this.healthLogger=n,this.featureConfig=t,this.kpiUsageEventBlocker=e,this.kpiFailureEventBlocker=o,this.kpiSuccessEventBlocker=i}return n.prototype.logKpiUsage=function(t,e,o,i){var r=this.getKpiKey(t+n.USAGE_KPI,null==o?void 0:o.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(o),this.recordKpiUsage(t,e,o,r),0!==i){var u=null!=i?i:3e5;this.kpiUsageEventBlocker.blockEvent(r,u)}return!0},n.prototype.logKpiFailure=function(t,e,o,i,r){var u,s,a,l=this.getKpiKey(t+n.FAILURE_KPI+e,null===(u=null==o?void 0:o.additionalValues)||void 0===u?void 0:u.extendedProperties);if("number"==typeof(null===(s=null==o?void 0:o.additionalValues)||void 0===s?void 0:s.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(l,o.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(l))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(t,e,o,l),i&&this.recordQosError(null!==(a=i.errorNameOverride)&&void 0!==a?a:e,i.name,i),0!==r){var c=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(l,c)}return!0},n.prototype.logKpiSuccess=function(t,e,o){var i,r,u=this.getKpiKey(t+n.SUCCESS_KPI,null===(i=null==e?void 0:e.additionalValues)||void 0===i?void 0:i.extendedProperties);if("number"==typeof(null===(r=null==e?void 0:e.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(u,e.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(t,e,u),0!==o){var s=null!=o?o:3e5;this.kpiSuccessEventBlocker.blockEvent(u,s)}return!0},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(t){var e,i=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==t?void 0:t.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(i,o.FailureBased,t);var u=null!==(e=this.featureConfig.vetoPillar)&&void 0!==e?e:this.featureConfig.areaName;u&&n.QOS_PILLARS_LIST.includes(u)&&this.healthLogger.addQosPillar(u),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},n.prototype.recordKpiUsage=function(n,t,e,o){void 0===e&&(e={});var i=e||{},r=i.extendedProperties,u=i.isForAlertableKpi,s=this.createExtendedPropertiesWithMoreFields(r,o);u?this.healthLogger.recordKpiUsageForAlertableKpi(n,this.featureConfig.crewAlias,s):this.healthLogger.recordKpiUsage(n,t,this.featureConfig.crewAlias,s)},n.prototype.getKpiKey=function(n,t){var e=this.getKpiAreaName(t),o=this.getKpiFeatureName(t),i=this.getKpiPivot(t);return"".concat(e,".").concat(o,".").concat(null!=n?n:"").concat(i&&0===i.length?"."+i:"")},n.prototype.getKpiAreaName=function(t){var e,o,i;return null!==(i=null!==(o=null!==(e=null==t?void 0:t.get(n.AREA_NAME_COLUMN_KEY))&&void 0!==e?e:this.featureConfig.areaName)&&void 0!==o?o:this.featureConfig.vetoPillar)&&void 0!==i?i:""},n.prototype.getKpiFeatureName=function(t){var e,o;return null!==(o=null!==(e=null==t?void 0:t.get(n.FEATURE_NAME_COLUMN_KEY))&&void 0!==e?e:this.featureConfig.featureName)&&void 0!==o?o:""},n.prototype.getKpiPivot=function(t){var e=null==t?void 0:t.get(n.PIVOT_TYPE_COLUMN_KEY),o=null==t?void 0:t.get(n.PIVOT_VALUE_COLUMN_KEY);return e&&0!==e.length&&o&&0!==o.length?"".concat(e,"=").concat(o):""},n.prototype.recordKpiFailure=function(n,t,e,o){void 0===e&&(e={});var i=e||{},r=i.isIntentional,u=i.isInternal,s=i.additionalValues,a=i.hasImpliedUsage,l=this.createAdditionalValuesWithMoreFields(s,o);!1===a?this.healthLogger.recordKpiFailure(n,t,r,u,l):this.healthLogger.recordKpiImpliedFailure(n,t,r,u,this.featureConfig.crewAlias,l)},n.prototype.recordKpiSuccess=function(n,t,e){void 0===t&&(t={});var o=t||{},i=o.additionalValues,r=o.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(i,e);!1===r?this.healthLogger.recordKpiSuccess(n,u):this.healthLogger.recordKpiImpliedSuccess(n,this.featureConfig.crewAlias,u)},n.prototype.recordQosError=function(n,t,e){void 0===e&&(e={});var o=e.isIntentional,i=e.isInternal,r=e.alertOnPillar,u=e.isSessionEndingError,s=e.additionalValues,a=this.createAdditionalValuesWithMoreFields(s);this.healthLogger.recordQosError(n,[t],o,i,r,u,a)},n.prototype.createExtendedPropertiesWithMoreFields=function(t,e){var o=new Map(t||new Map);if(o.get(n.FEATURE_NAME_COLUMN_KEY)||o.set(n.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(t)),o.set(n.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(o)),o.has(n.SKIP_ARIA_COLUMN_KEY)||o.has("skipAria")||o.set(n.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&e){var i=this.getEventBlocker(e);if(i){var r=i.getEventHitCount(e);if(r){o.set(n.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var u=i.getEventDurations(e);r>1&&u&&o.set(n.AGGREGATED_DURATION_COLUMN_KEY,u.map((function(n){return Math.round(100*n)/100})).toString())}}}return o},n.prototype.createAdditionalValuesWithMoreFields=function(n,t){var e={};return(e=(0,r.pi)({},n)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==n?void 0:n.extendedProperties,t),e},n.prototype.getEventBlocker=function(t){return t.endsWith(n.USAGE_KPI)?this.kpiUsageEventBlocker:t.includes(n.FAILURE_KPI)?this.kpiFailureEventBlocker:t.endsWith(n.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},n.FEATURE_NAME_COLUMN_KEY="FeatureName",n.AREA_NAME_COLUMN_KEY="AreaName",n.AGGREGATED_COUNT_COLUMN_KEY="AggCount",n.AGGREGATED_DURATION_COLUMN_KEY="AggMs",n.SKIP_ARIA_COLUMN_KEY="SkipAria",n.PIVOT_TYPE_COLUMN_KEY="PivotType",n.PIVOT_VALUE_COLUMN_KEY="PivotValue",n.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],n.USAGE_KPI=".Usage",n.SUCCESS_KPI=".Success",n.FAILURE_KPI=".Failure.",n}(),a=function(){function n(t,e,i,u,a){var l,c,d,f=this;this.healthLogger=t,this.featureConfig=e,this.kpiUsageEventBlocker=i,this.kpiFailureEventBlocker=u,this.kpiSuccessEventBlocker=a,this.featureUsageAndHealthLogger=new s(this.healthLogger,this.featureConfig,null!==(l=this.kpiUsageEventBlocker)&&void 0!==l?l:n.kpiUsageBlocker,null!==(c=this.kpiSuccessEventBlocker)&&void 0!==c?c:n.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:n.kpiSuccessBlocker),this.executeCallbackWithLogging=function(n,t){var e,i,u,s=function(n){return"VetoFailureLoggingParams".includes(n)};(null==t?void 0:t.kpiUsageLoggingParams)?(i="Usage",u=null==t?void 0:t.kpiUsageLoggingParams):(null==t?void 0:t.kpiSuccessLoggingParams)?(i="UsageWithSuccess",u=null==t?void 0:t.kpiSuccessLoggingParams):(null==t?void 0:t.kpiFailureLoggingParams)?(i="UsageWithFailure",u=null==t?void 0:t.kpiFailureLoggingParams):(i="UsageWithVetoFailure",u=null==t?void 0:t.vetoFailureLoggingParams);var a=null==u?void 0:u.usageName,l=null==u?void 0:u.usageKpiType;f.logKpiUsage({kpiName:a,kpiType:null!=l?l:o.FailureBased});try{null==n||n(),"UsageWithSuccess"===i&&"KpiSuccessLoggingParams".includes(u)&&f.logKpiSuccess({kpiName:a,optionalProperties:u.successOptionalProperties})}catch(n){if("UsageWithFailure"===i&&"KpiFailureLoggingParams".includes(u)||"UsageWithVetoFailure"===i&&s(u)){var c=void 0;s(u)&&(c=(0,r.pi)({name:null!==(e=u.vetoName)&&void 0!==e?e:""},u.vetoOptionalProperties)),f.logKpiFailure({kpiName:u.usageName,errorName:u.failureErrorName,optionalProperties:u.failureOptionalProperties,optionalVeto:c})}throw n}}}return n.getInstance=function(t,e,o,i,r){return new n(t,e,o,i,r)},n.prototype.logKpiUsage=function(n){var t;return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(n.kpiName,null!==(t=n.kpiType)&&void 0!==t?t:o.FailureBased,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiFailure=function(n){return!!(n&&n.kpiName&&n.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(n.kpiName,n.errorName,n.optionalProperties,n.optionalVeto,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiSuccess=function(n){return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(n.kpiName,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(n){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n)},n.kpiUsageBlocker=new u,n.kpiFailureBlocker=new u,n.kpiSuccessBlocker=new u,n}(),l=function(){function n(){}return n.prototype.getHealthInstance=function(n){if(n)return i.S9.getInstance().initialize(n),i.S9.getInstance()},n.prototype.getExtendedHealthInstance=function(n,t){if(n&&t)return a.getInstance(n,t)},n}();!function(n){n[n.FailureBased=0]="FailureBased",n[n.SuccessBased=1]="SuccessBased"}(o||(o={})),new l},1709:function(n,t,e){e.d(t,{S9:function(){return v}});var o,i=e(9029);function r(n){if(n){var t={};return n.forEach((function(n,e){e&&(t[e]=n)})),t}}function u(n,t){var e=[],o=new Set;return n.concat(t).forEach((function(n){return o.add(n)})),o.forEach((function(n){return e.push(n)})),e}!function(n){n[n.Failure=0]="Failure",n[n.ImpliedUsageFailure=1]="ImpliedUsageFailure",n[n.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",n[n.Success=3]="Success",n[n.Usage=4]="Usage"}(o||(o={}));var s,a,l,c,d,f=e(6012);!function(n){n[n.BSqmError=0]="BSqmError",n[n.Kpi=1]="Kpi",n[n.QosError=2]="QosError",n[n.QosPillar=3]="QosPillar",n[n.DiagnosticLog=4]="DiagnosticLog",n[n.OfflineWorkerInit=5]="OfflineWorkerInit",n[n.OfflineWorkerFlush=6]="OfflineWorkerFlush",n[n.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(s||(s={})),function(n){n.HealthDimensions="d",n.PartCDimensions="a",n.BSqmErrors="b",n.QosErrors="e",n.Heartbeat="h",n.QosPillars="q",n.Kpis="k",n.DiagnosticLogs="l",n.ClientSendTime="t"}(a||(a={})),function(n){n[n.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",n[n.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",n[n.InvalidWorkerUrl=2]="InvalidWorkerUrl",n[n.InstallingOfflineWorker=3]="InstallingOfflineWorker",n[n.OfflineWorkerMessage=4]="OfflineWorkerMessage",n[n.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",n[n.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",n[n.InitializedHealth=7]="InitializedHealth",n[n.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",n[n.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",n[n.InstalledOfflineWorker=10]="InstalledOfflineWorker",n[n.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",n[n.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",n[n.FailedToProcessMessage=13]="FailedToProcessMessage",n[n.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",n[n.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",n[n.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent"}(l||(l={})),function(n){n[n.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",n[n.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",n[n.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",n[n.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",n[n.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(c||(c={})),function(n){n[n.SendSucceeded=0]="SendSucceeded",n[n.SendFailed=1]="SendFailed",n[n.DidNotAttempt=2]="DidNotAttempt"}(d||(d={}));var v=function(){function n(){var n=this;this.zn={},this.qn={},this.Qn=[],this.Xn={},this.Zn=0,this.Yn={$n:3e5,nt:!1,tt:!1,et:!1,ot:3e4,it:25,rt:"",ut:864e5,st:"",lt:"",ct:3,ft:3,vt:15e3,ht:new Set},this.wt=!1,this.gt=-1,this.St=!1,this.bt=0,this.Ht=!0,this.Ct=function(){return!1},this.It={},this.At=[],this.Ut=0,this.yt=0,this.Tt=void 0,this.Ft=[],this.Nt=[],this.Et=[],this.kt=[],this.Pt=0,this.Rt=0,this.Dt=0,this.Ot=[],this.Wt=!1,this.jt=0,this._t=!1,this.Mt=function(){n.Pt&&(window.clearTimeout(n.Pt),n.Pt=0)},this.Bt=function(){n.At=[],n.Ft=[],n.Nt=[],n.Tt=void 0,n.Et=[],n.kt=[],n.Ut=0,n.yt=0},this.xt=function(){try{if(n.Ut<=0)return;var t=n.Lt();n.Kt(t,n.Zn,n.Yn.ft),n.Bt()}catch(n){}},this.Lt=function(){return{d:n.Xn,a:n.Gt(),b:n.At,e:n.Nt,h:n.Tt,q:n.Et,k:n.Ft,l:n.kt,type:"h_v2"}},this.Gt=function(){return n.Yn.et&&(n.At&&n.At.length>0||n.Nt&&n.Nt.length>0)&&Object.keys(n.qn).length>0?(0,i.pi)((0,i.pi)({},n.zn),n.qn):n.zn},this.Vt=function(t,e,o,i){var r;if(void 0===i&&(i=!1),e&&!n.Yn.ht.has(o))if(n.Ht){switch(t){case s.BSqmError:n.At.push(e);break;case s.Kpi:n.Ft.push(e);break;case s.QosError:n.Nt.push(e);break;case s.QosPillar:-1===n.Et.map((function(n){return n.n})).indexOf(e.n)&&n.Et.push(e);break;case s.DiagnosticLog:n.kt.push(e)}if(n.Ut+=1,t!==s.DiagnosticLog&&t!==s.QosPillar&&(n.yt+=1),n.Ct()&&!i)return void n.xt();n.Ut>=n.Yn.it&&(n.Mt(),n.Jt())}else e.o=(new Date).toJSON(),null===(r=n.zt)||void 0===r||r.postMessage({t,k:"".concat(n.Xn.w,".").concat(n.Zn),m:n.Xn,c:n.Gt(),v:e})},this.qt=function(){n.Mt(),n.Pt=window.setTimeout((function(){n.Jt()}),n.Yn.ot)},this.Jt=function(t){void 0===t&&(t=!1),t&&n.yt<=0||(n.xt(),n.qt())},this.Qt=function(){if(n.Ot||n.It){n.Tt&&-1!==n.gt||(n.gt=(n.gt+1)%1e3),n.Tt||(n.Ut+=1);var t={p:n.Tt?u(n.Tt.p,n.Ot):n.Ot,k:n.Tt?u(n.Tt.k,n.Qn):n.Qn,i:n.Yn.$n,o:n.gt};n.Tt=t}},this.Xt=function(t,e,o,i,u,a,l,c,d,f){if(t&&(!e||n.It[t])){e||n.Zt(t,c,d,f);var v=n.It[t],h={n:v.k,e:o,t:v.t,a:v.a,f:v.o,d:null==i?void 0:i.durationMs,p:r(null==i?void 0:i.extendedProperties)};if(u){var p={n:u,x:l,z:a};h.k=p}n.Vt(s.Kpi,h,t)}},this.Yt=function(){var t,e,o,i,r,u,s,a,l,c,d,f,v,h,p,m,w,g,S,b,H,C,I,A,U,y,T,F,N,E,k,P,R,D,O,W,j,_=n.Yn.Xn;_&&(n.Xn={a:null!==(t=_.application)&&void 0!==t?t:void 0,b:null!==(e=_.applicationLcid)&&void 0!==e?e:void 0,c:null!==(o=_.applicationMode)&&void 0!==o?o:void 0,d:null!==(i=_.applicationModeExtended)&&void 0!==i?i:void 0,e:null!==(r=_.arrVersion)&&void 0!==r?r:void 0,f:null!==(u=_.browser)&&void 0!==u?u:void 0,g:null!==(s=_.browserLcid)&&void 0!==s?s:void 0,h:null!==(a=_.browserMajorVersion)&&void 0!==a?a:void 0,i:null!==(l=_.browserVersion)&&void 0!==l?l:void 0,j:null!==(c=_.clientVersion)&&void 0!==c?c:void 0,k:null!==(d=_.datacenter)&&void 0!==d?d:void 0,l:null!==(f=_.dataCulture)&&void 0!==f?f:void 0,m:null!==(v=_.flightsImpressionId)&&void 0!==v?v:void 0,n:null!==(h=_.host)&&void 0!==h?h:void 0,o:null!==(p=_.isAnonymousUser)&&void 0!==p?p:void 0,p:null!==(m=_.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(w=_.isEduUser)&&void 0!==w?w:void 0,r:null!==(g=_.isSynthetic)&&void 0!==g?g:void 0,s:null!==(S=_.loggableUserId)&&void 0!==S?S:void 0,t:null!==(b=_.loggableUserIdSpace)&&void 0!==b?b:void 0,u:null!==(H=_.ring)&&void 0!==H?H:void 0,v:null!==(C=_.serverDocId)&&void 0!==C?C:void 0,w:null!==(I=_.session_id)&&void 0!==I?I:void 0,x:null!==(A=_.sessionOrigin)&&void 0!==A?A:void 0,y:null!==(U=_.tenantId)&&void 0!==U?U:void 0,z:null!==(y=_.uiHost)&&void 0!==y?y:void 0,aa:null!==(T=_.wfeVersion)&&void 0!==T?T:void 0,ab:null!==(F=_.fileExtension)&&void 0!==F?F:void 0,ac:null!==(N=_.uiHostIntegrationType)&&void 0!==N?N:void 0,ad:null!==(E=_.osVersion)&&void 0!==E?E:void 0,af:null!==(k=_.networkDownlink)&&void 0!==k?k:void 0,ag:null!==(P=_.networkDownlinkMax)&&void 0!==P?P:void 0,ah:null!==(R=_.networkEffectiveType)&&void 0!==R?R:void 0,ai:null!==(D=_.networkRTT)&&void 0!==D?D:void 0,aj:null!==(O=_.networkSaveData)&&void 0!==O?O:void 0,ak:null!==(W=_.networkType)&&void 0!==W?W:void 0,al:null!==(j=_.userLicenseType)&&void 0!==j?j:void 0})},this.$t=function(){n.Qt(),n.bt=window.setTimeout((function(){n.$t()}),n.Yn.$n)},this.ne=function(){n.Ot&&n.Ot.forEach((function(t){t&&n.te(t,!0)}))},this.te=function(t,e){var o={};o.n=t,n.Vt(s.QosPillar,o,t,e)},this.ee=function(){n.Ot&&(n.Rt=Date.now(),n.ne()),n.oe()},this.oe=function(t){void 0===t&&(t=n.Yn.ut),n.Dt=window.setTimeout((function(){n.ee()}),t)},this.ie=function(){n.wt||(n.wt=!0,n.St=!0,n.$t())},this.re=function(){0!==n.Dt&&(window.clearTimeout(n.Dt),n.Dt=0)},this.ue=function(){if(n.Yn.nt&&n.Yn.tt&&n.Yn.lt&&""!==n.Yn.lt&&n.Yn.rt&&""!==n.Yn.rt)try{if("undefined"==typeof Worker)return void n.se(l.WorkerApiIsNotAvailable);if(!n.Yn.rt)return void n.se(l.InvalidWorkerUrl);n.se(l.InstallingOfflineWorker);var t=new Blob(["try{importScripts('".concat(encodeURI(n.Yn.rt),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});n.zt=new Worker(URL.createObjectURL(t)),n.zt.onmessage=function(t){try{var e=t.data;n.se(e.i,e.r)}catch(t){n.se(l.FailedToProcessMessageFromOfflineWorker,t.toString())}},n.zt.postMessage({t:s.OfflineWorkerInit,v:n.Yn.lt}),n.zt.postMessage({t:s.OfflineWorkerFlush})}catch(t){n.se(l.FailedToInstallOfflineWorker,t.toString())}},this.ae=function(t,e){var o;if(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)try{return null===(o=n.zt)||void 0===o||o.postMessage({t:s.OfflineWorkerFailedUpload,k:"".concat(t.d.w,".").concat(e),v:t}),d.SendSucceeded}catch(t){var i=n.le(t);return n.se(l.FailedToSendEventToWorker,i),d.SendFailed}return d.DidNotAttempt},this.Zt=function(t,e,o,i){t&&void 0!==e&&(n.It[t]||(n.It[t]={k:t,t:e,a:!0===o,o:null!=i?i:void 0},o&&(n.Qn.push(t),n.Qt())))},this.ce=function(t){n.gt=-1,t?(n.Rt=Date.now(),n.oe(),n.ie()):n.Qt()},this.de=function(t){return!!n._t||(n.se(l.AttemptToUseFunctionalityBeforeIitialization,null==t?void 0:t.toString()),!1)},this.Kt=function(t,e,o){if(t){var r=n.Yn.st;if(n.Wt&&(o<=0||!n.Ht)&&n.ae(t,e)!==d.SendFailed)return;if(!(o<=0)){var u=n.fe(t,!1);if(null!==u){if(n.Ct())try{if(void 0!==navigator.sendBeacon){if(u.length>=65536&&n.Yn.et){var s=(0,i.pi)((0,i.pi)({},t),{a:n.zn}),a=n.fe(s,!0);if(null===a)return;navigator.sendBeacon(r,a)}else navigator.sendBeacon(r,u);return}}catch(n){}var l=new XMLHttpRequest;l.open("POST",r,!0),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?n.Wt||(n.Wt=!0):n.jt<n.Yn.ct?(n.jt+=1,window.setTimeout((function(){n.jt-=1,n.Kt(t,e,o-1)}),n.Yn.vt)):n.Wt&&n.ae(t,e))},l.send(u)}}}},this.se=function(t,e){var o={i:t,r:e};n.Vt(s.DiagnosticLog,o,t.toString())},this.le=function(n){var t=void 0;return"string"==typeof n?t=n:n instanceof Error&&(t=n.name+" "+n.message,n.stack&&(t+=" "+n.stack)),t},this.fe=function(t,e){try{return i=t,JSON.stringify(i)}catch(t){var o=n.le(t);return o="ModifiedPayload: "+e+" | "+o,n.se(l.FailedToJsonStringifyEvent,o),null}var i}}return n.getInstance=function(){return n.ve||(n.ve=new n),this.ve},n.prototype.initialize=function(n){if(n)try{return this.Yn=function(n){var t,e,o,i,r,u,s,a,l,c,d,f,v,h,p;return{Xn:null!==(t=n.dimensions)&&void 0!==t?t:void 0,$n:null!==(e=n.heartbeatIntervalMs)&&void 0!==e?e:3e5,nt:null!==(o=n.isHealthEnabled)&&void 0!==o&&o,tt:null!==(i=n.isOfflineEnabled)&&void 0!==i&&i,et:null!==(r=n.isErrorPartCEnabled)&&void 0!==r&&r,ot:null!==(u=n.loggerMaxIntervalMs)&&void 0!==u?u:3e4,it:null!==(s=n.loggerMaxQueueSize)&&void 0!==s?s:25,rt:null!==(a=n.offlineWorkerUrl)&&void 0!==a?a:"",lt:null!==(l=n.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==l?l:"",ut:null!==(c=n.recordPillarToWarmPipelineIntervalMs)&&void 0!==c?c:864e5,st:null!==(d=n.remoteTelemetryUrl)&&void 0!==d?d:"",ct:null!==(f=n.maxConcurrentRetries)&&void 0!==f?f:3,ft:null!==(v=n.retryMaxAttempts)&&void 0!==v?v:3,vt:null!==(h=n.retryDelayMs)&&void 0!==h?h:15e3,ht:null!==(p=n.disabledHealthEvents)&&void 0!==p?p:new Set}}(n),this.Yt(),this.qt(),this.ue(),this._t=!0,void this.se(l.InitializedHealth)}catch(n){}this._t=!1},n.prototype.addOrUpdatePartCDimension=function(n,t){this.de(c.AttemptedToAddOrUpdatePartCDimension)&&n&&(this.zn.hasOwnProperty(n)&&this.zn[n]===t||(this.Jt(!0),this.zn[n]=t,this.Zn+=1,this.Qt(),this.ne()))},n.prototype.addOrUpdateErrorPartCDimension=function(n,t){this.Yn.et&&n&&(this.qn[n]=t)},n.prototype.addQosPillar=function(n){if(n){var t=0===this.Ot.length;-1===this.Ot.indexOf(n)&&(this.Ot.push(n),this.te(n,!1),this.ce(t))}},n.prototype.recordBsqmQosError=function(n,t,e){if(this.de(c.AttemptedToRecordBSqmQosError)&&(this.he(!1),this.ne(),n)){var o={b:n,v:t,d:null==e?void 0:e.durationMs,p:r(null==e?void 0:e.extendedProperties),s:this.Ot,i:null==e?void 0:e.inStaging};this.Vt(s.BSqmError,o,n),this.shutdown(!0)}},n.prototype.recordKpiFailure=function(n,t,e,i,r){this.Xt(n,!0,o.Failure,r,t,i,e)},n.prototype.recordKpiImpliedFailure=function(n,t,e,i,r,u){this.Xt(n,!1,o.ImpliedUsageFailure,u,t,i,e,f.o.FailureBased,!1,r)},n.prototype.recordKpiImpliedSuccess=function(n,t,e){this.Xt(n,!1,o.ImpliedUsageSuccess,e,void 0,void 0,void 0,f.o.FailureBased,!1,t)},n.prototype.recordKpiSuccess=function(n,t){this.Xt(n,!0,o.Success,t)},n.prototype.recordKpiUsage=function(n,t,e,i){this.Xt(n,!1,o.Usage,{extendedProperties:i},void 0,void 0,void 0,t,!1,e)},n.prototype.recordKpiUsageForAlertableKpi=function(n,t,e){if(n){var i=!0,r=this.It[n];r&&(i=r.t===f.o.FailureBased),this.Xt(n,!1,o.Usage,{extendedProperties:e},void 0,void 0,void 0,f.o.FailureBased,!0,t),i&&this.ie()}},n.prototype.recordQosError=function(n,t,e,o,i,u,a){if((!u||this.de(c.AttemptedToRecordSessionEndingQosError))&&n&&t){var l={n,x:e,z:o,l:i,v:t,e:u,d:null==a?void 0:a.durationMs,p:r(null==a?void 0:a.extendedProperties),s:this.Ot,i:null==a?void 0:a.inStaging};this.Vt(s.QosError,l,n),u&&(this.he(!1),this.ne(),this.shutdown(!0))}},n.prototype.removeQosPillar=function(n){if(n){var t=this.Ot.indexOf(n);t>-1&&(this.Ot.splice(t,1),this.ce(!1)),0===this.Ot.length&&this.re()}},n.prototype.resumeAllHealthTimers=function(){if(this.wt&&!this.St&&this.$t(),0===this.Dt&&0!==this.Rt){var n=Date.now()-this.Rt;n>=this.Yn.ut||n<=0?this.ee():this.oe(this.Yn.ut-n)}},n.prototype.setHandlerForIsAppShuttingDown=function(n){n&&(this.Ct=n)},n.prototype.setIsAppOnline=function(n){var t;this.de(c.AttemptedToSetAppOnlineStatus)&&(!this.Ht&&n&&(null===(t=this.zt)||void 0===t||t.postMessage({t:s.OfflineWorkerFlush,v:this.Ct()})),this.Ht=n)},n.prototype.shutdown=function(n){var t;void 0===n&&(n=!1),this.Yn.nt&&(this.Mt(),this.he(!1),this.Ct=function(){return!0},this.xt(),(!n||n&&this.Ht)&&(null===(t=this.zt)||void 0===t||t.terminate()))},n.prototype.stopAllHealthTimers=function(){this.he(!0)},n.prototype.he=function(n){this.St=!1,this.gt=-1,0!==this.bt&&(window.clearTimeout(this.bt),this.bt=0),this.re(),n&&this.xt()},n.prototype.updatePartADimensions=function(n){var t=this;if(n&&this.de(c.AttemptedToUpdatePartADimensions)){var e=!1;Object.keys(n).forEach((function(o){void 0!==n[o]&&null!==n[o]&&""!==n[o]&&t.Yn.Xn[o]!==n[o]&&(t.Yn.Xn[o]=n[o],e=!0)})),e&&(this.Jt(),this.Yt(),this.Zn+=1,this.Qt(),this.ne())}},n.prototype.flushAndSetNewEndpoint=function(n,t){var e;n.localeCompare(null!==(e=this.Yn.st)&&void 0!==e?e:"",void 0,{sensitivity:"accent"})&&(this.Jt(!1),this.Yn.st=n,t&&t())},n}()},6823:function(n,t,e){var o;e.d(t,{W:function(){return o}}),function(n){n[n.pe=0]="msoulscat_ES_EWAJS",n[n.me=1]="msoulscat_ES_EWAJSGrid",n[n.we=6]="msoulscat_ES_EWAJSChart",n[n.Se=202]="msoulscat_MSOSP_FileMenuCommands",n[n.be=220]="msoulscat_MSOSP_AddInCommands",n[n.He=225]="msoulscat_MSOSP_OTelJS",n[n.Ce=227]="msoulscat_MSOSP_OTelJSInWebWoker",n[n.Ie=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",n[n.Ae=301]="msoulscat_Wac_WordViewer",n[n.Ue=306]="msoulscat_Wac_BrowserGeneral",n[n.ye=320]="msoulscat_Wac_TaskPane",n[n.Te=339]="msoulscat_Wac_OneNoteGeneral",n[n.Fe=340]="msoulscat_Wac_Ribbon",n[n.Ne=356]="msoulscat_Wac_WacFeedback",n[n.Ee=379]="msoulscat_Wac_WopiPendingApplication",n[n.ke=383]="msoulscat_Wac_Telemetry",n[n.Pe=391]="msoulscat_Wac_WacCatchUpActivities",n[n.Re=394]="msoulscat_Wac_Dictation",n[n.De=395]="msoulscat_Wac_OneNoteSync",n[n.Oe=700]="msoulscat_Wac_VisioApp",n[n.We=1601]="msoulscat_OneNoteOnline_EditableCache",n[n.je=800]="msoulscat_Wac_PptAnimation",n[n._e=833]="msoulscat_Wac_PptLive",n[n.Me=834]="msoulscat_Wac_PptMWeb",n[n.Be=835]="msoulscat_Wac_PptGc2General",n[n.xe=836]="msoulscat_Wac_PptGc2GraphicHost",n[n.Le=837]="msoulscat_Wac_PptGc2Operation",n[n.Ke=844]="msoulscat_Wac_PptDataSync",n[n.Ge=848]="msoulscat_Wac_PptFluidRuntime",n[n.Ve=815]="msoulscat_Wac_PptShape",n[n.Je=817]="msoulscat_Wac_PptSession",n[n.ze=830]="msoulscat_Wac_PptSlideshow",n[n.qe=822]="msoulscat_Wac_PptView",n[n.Qe=846]="msoulscat_Wac_PptVideos",n[n.Xe=1303]="msoulscat_Uci_Insights",n[n.Ze=2300]="msoulscat_Wac_VersionHistory",n[n.Ye=302]="msoulscat_Wac_WordPresence",n[n.$e=3e3]="msoulscat_Wac_OAuth",n[n.no=3005]="msoulscat_Wac_WordVersionHistory",n[n.eo=3006]="msoulscat_Wac_LivePersonaCard",n[n.oo=3012]="msoulscat_Wac_CatchUpFlyout",n[n.io=3016]="msoulscat_Wac_WordDesigner",n[n.ro=3021]="msoulscat_Wac_ModernFontPicker",n[n.uo=3027]="msoulscat_Wac_UnifiedUiHost",n[n.so=3033]="msoulscat_Wac_EquationTools",n[n.ao=1401]="msoulscat_Osf_Latency",n[n.lo=1402]="msoulscat_Osf_Notification",n[n.co=1403]="msoulscat_Osf_Runtime",n[n.do=3041]="msoulscat_Wac_AiMaker",n[n.fo=3043]="msoulscat_Wac_AiRewrite",n[n.vo=3044]="msoulscat_Wac_AiInsert",n[n.ho=3047]="msoulscat_Wac_AiSummarize",n[n.po=3048]="msoulscat_Wac_CopilotCompose",n[n.mo=3049]="msoulscat_Wac_Skittles"}(o||(o={}))},4320:function(n,t,e){var o;e.d(t,{G:function(){return o}}),function(n){n[n.Error=10]="Error",n[n.Warning=15]="Warning",n[n.Important=20]="Important",n[n.Info=50]="Info",n[n.Verbose=100]="Verbose",n[n.Spam=200]="Spam"}(o||(o={}))},2757:function(n,t,e){e.d(t,{dL:function(){return b},nb:function(){return S},xG:function(){return H}});var o=e(9029),i=e(6823),r=e(4320),u=e(1541),s=e(1480),a=e(4813),l=e(9323),c=e(4855),d=e(8594),f=e(3755),v=e(9823),h=e(7493),p=e(8604),m=e(8805),w=e(8692),g=e(9048),S=!1;function b(){S=!1}function H(n,t,e,b,H,C,I,A){var U=this,y=n.loadFunctionSubject,T=n.documentBootInfo,F=n.correlationId,N=n.wopiFetchData,E=void 0===N?{wopiHostData:void 0,fetchDiagnostics:void 0}:N,k=T.fileType,P=T.wdOrigin,R=T.puid,D=T.uiCulture,O=T.dataCulture,W=T.clickTime,j=T.rebootOverrideData,_=E.wopiHostData,M=E.fetchDiagnostics,B=null==e?void 0:e.logger,x=null==e?void 0:e.health;if(!(_&&_.wac&&_.wac.bootstrapperUrl&&_.wac.applicationUrl)){var L=!!_,K=!!(null==_?void 0:_.wac),G=new Map([["WopiHostDataPresent","".concat(L)],["WopiWacDataPresent","".concat(K)]]),V=JSON.stringify(Array.from(G.entries())),J={wacErrorName:c.AU.wo,qosErrorName:c.DG.QosError_VroomWopiFailure,errorMessage:V};return null==B||B.ULS.sendTraceTag(554964098,i.W.uo,r.G.Info,"".concat(c.AU.wo,": Failed to get wopi data for the item, ").concat(V)),void(b&&b(J))}var z=A||_.wac.bootstrapperUrl,q=_.wac.applicationUrl;_.wac.userId&&(null==x||x.updatePartADimensions({loggableUserId:_.wac.userId}));var Q=new Promise((function(n,t){setTimeout((function(){return t("jsApi timed out after 60 seconds")}),6e4)})),X=new Promise((function(n,A){return(0,o.mG)(U,void 0,void 0,(function(){var U;return(0,o.Jh)(this,(function(N){return y.subscribe((function(){return n("jsApi successfully loaded")})),U=function(n,m){var b,A,U=(0,g.e8)(_,q,null!==(b=null==t?void 0:t.uiHostName)&&void 0!==b?b:"UUIH",T,null==t?void 0:t.uiEmbed),N=(0,w.ss)(U,B);(0,g.ZR)(k,null==t?void 0:t.featureGates,B)?(null==x||x.addOrUpdatePartCDimension("JsApiVersion","V2"),A=function(w){var b=w.container,A=w.flushTime;return new a.y((function(a){var w,y,E,k,R,D,x,L,K,G,V,J=(0,d.Z)(T,z,t,e,_),q=f.r.isCreateNewFlowExecuting&&f.r.application?f.r.application:n.createApplication(J),Q={hostSessionId:F},X=f.r.isCreateNewFlowExecuting&&f.r.session?f.r.session:q.createSession(Q);C&&C(q,_,T,X),(0,v.vJ)("UseNewEuplReporting",null==t?void 0:t.featureGates)&&T.fileType!==u.T.Excel||!H||H();var Z={appUrl:U,file:(0,o.pi)({name:_.fileName,getUrl:(null===(k=_.wac)||void 0===k?void 0:k.fileGetUrl)||_.downloadUrl,size:_.fileSize,eTag:_.eTag},T.docId&&{uniqueId:T.docId}),customFontCatalogUrl:_.wac.customFontCatalogUrl,contentBundle:{majorVersion:_.bundleVersion?Number(_.bundleVersion):0,url:null!==(R=_.bundleUrl)&&void 0!==R?R:"",staleness:_.bundleStaleness||0},newFileTemplate:T.newFileTemplate,container:b,wopi:{source:_.wac.wopiSrc,accessToken:_.wac.accessToken,expiry:parseInt(_.wac.accessTokenExpiry,10),wacToken:null==e?void 0:e.wacToken},bootParams:{readOnly:_.readOnly,irmEnabled:_.irmEnabled,supportsDecryptedContentDownload:_.protectionEnabled,viewOnly:_.blocksDownload,disableChat:!0,openViewByDefault:"view"===T.intent,dataLanguage:O},diagnostics:(null===(D=null==e?void 0:e.bootDiagnostics)||void 0===D?void 0:D.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,g.xL)(null===(x=null==e?void 0:e.bootDiagnostics)||void 0===x?void 0:x.legacyPerformanceData.host,null===(L=null==e?void 0:e.bootDiagnostics)||void 0===L?void 0:L.legacyPerformanceData.owlFrame)),(0,g.YV)(W,A,P,M,m.performance,e,null==t?void 0:t.featureGates)),{legacyPerformanceData:null===(K=null==e?void 0:e.bootDiagnostics)||void 0===K?void 0:K.legacyPerformanceData}):(0,g.ge)(W,A,P,M,m.performance,e,null==t?void 0:t.featureGates),sessionContext:N||(0,g.l_)(),preseededSession:{key:_.preSeededSessionKey,id:_.preSeededWacSessionId},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},T.templateId&&(w={},w.wdTpl=T.templateId,w)),j&&j.lcid&&(y={},y.wdlcid=j.lcid,y)||T.uiCulture&&(E={},E.wdlcid=T.uiCulture,E)),(0,g.q6)(T.wdValue)),hostGeneratedSessionId:null==e?void 0:e.sessionId,meeting:null==e?void 0:e.meeting,rebootOverride:j,throttling:{protection:null===(G=_.wac)||void 0===G?void 0:G.clientThrottlingProtection,request:null===(V=_.wac)||void 0===V?void 0:V.requestedCallThrottling}};(0,s.l5)(h.r_.OwlWacBootStart),(0,v.vJ)(v.Fh.FeatureGate_OwlPostWacTokenForTeamsHosts,null==t?void 0:t.featureGates)&&(S=!!Z.wopi.wacToken)&&(null==B||B.ULS.sendTraceTag(507347489,i.W.uo,r.G.Important,"WAC token has been fetched before calling jsapi boot")),(f.r.isCreateNewFlowExecuting?f.r.completeCreateNewPromise:X.boot(Z,I)).then((function(n){var t;if("success"===n.completion)a.next({wopiHostData:_,officeApplication:q,bootedDocumentInfo:new l.X(T),officeDocumentSession:X,wacBootDiagnostics:null===(t=null==X?void 0:X.diagnostics)||void 0===t?void 0:t.appInitDiagnostics}),a.complete();else if("cancelled"===n.completion)null==B||B.ULS.sendTraceTag(509646293,i.W.uo,r.G.Info,"User cancelled document session boot");else{var e=n.completion,o=void 0;if("timeout"===n.completion)o=c.AU.So;else switch(n.errorSource&&"string"==typeof n.errorSource?n.errorSource.toLowerCase():void 0){case"app":o=c.AU.bo;break;case"jsapi":o=c.AU.Ho;break;default:o=c.AU.Co}var u={wacErrorName:o,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorMessage:e,error:n.error,documentLoadedWithTabSwitch:!!n.documentLoadedWithTabSwitch},s=(0,p.x)(u),d=JSON.stringify(Array.from(s.entries()));null==B||B.ULS.sendTraceTag(575419404,i.W.uo,r.G.Error,d),a.error(u)}})).catch((function(n){return null==B?void 0:B.ULS.sendTraceTag(512337547,i.W.uo,r.G.Error,"officeDocumentSession.boot threw error: ".concat(n))}))}))}):(null==x||x.addOrUpdatePartCDimension("JsApiVersion","V1"),A=function(u){var d=u.container,f=u.flushTime;return new a.y((function(u){var a=(0,g.N6)(_?_.wac.userId:R,F,D,O,t,e,(0,g.q6)(T.wdValue),N),h=(0,g.EN)(T,_),w=(0,g.ge)(W,f,P,M,m.performance,e,null==t?void 0:t.featureGates),b=null==t?void 0:t.uiHostName,C=(0,g.v1)((0,o.pi)((0,o.pi)({},_.wac),{wacToken:null==e?void 0:e.wacToken})),I=(0,g.UI)(d,m,C,a,h,w,(function(n,t){u.next({wopiHostData:_,officeApplication:n,bootedDocumentInfo:new l.X(T),wopiPendingApp:U,wacBootDiagnostics:t}),u.complete()}),(function(n){var t=n.errorObject.message,e={wacErrorName:c.AU.Io,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorName:n.errorType,errorMessage:t,error:n},o=(0,p.x)(e),s=JSON.stringify(Array.from(o.entries()));null==B||B.ULS.sendTraceTag(575419405,i.W.uo,r.G.Error,s),u.error(e)}),b,T,_,null==t?void 0:t.showCloseButton,null==t?void 0:t.supportsShare,null==t?void 0:t.openInBrowserEnabled,null==t?void 0:t.ellipsisDownloadACopyButtonEnabled,null==t?void 0:t.copyLinkEnabled,null==t?void 0:t.uiEmbed,null==t?void 0:t.supportsHostUiControls,null==t?void 0:t.conversationButtonEnabled,null==e?void 0:e.additionalApplicationParameters),A=(0,s.a)();null==B||B.ULS.sendTraceTag(576578583,i.W.uo,r.G.Info,"BootStrapFile: About to call InitializeWopiPending"),(0,v.vJ)(v.Fh.FeatureGate_OwlPostWacTokenForTeamsHosts,null==t?void 0:t.featureGates)&&(S=!!C.WacToken)&&(null==B||B.ULS.sendTraceTag(507347488,i.W.uo,r.G.Important,"WAC token has been fetched before calling jsapi initializeWopiPending"));var U=n.Application.InitializeWopiPending(I,void 0,null==e?void 0:e.sessionId),y=(0,s.a)()-A;null==B||B.ULS.sendTraceTag(570775769,i.W.uo,r.G.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!U,"][TimeElapsed: ").concat(y,"]"));var E=(0,s.a)();if(U){H&&H(),U.Complete(C);var k=(0,s.a)(),j=k-E,x=k-A;null==B||B.ULS.sendTraceTag(570775770,i.W.uo,r.G.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(j,"][TimeElapsedSinceInitializeWopiPending: ").concat(x,"]"))}else{var L={wacErrorName:c.AU.Ao,qosErrorName:c.DG.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"},K=(0,p.x)(L),G=JSON.stringify(Array.from(K.entries()));u.error(L),null==B||B.ULS.sendTraceTag(575419406,i.W.uo,r.G.Error,G)}}))}),y.next(A),y.complete()},f.r.isTwoStepCreateNew&&f.r.bootstrapperLoadPromise?f.r.bootstrapperLoadPromise.then((function(n){n?U(f.r.bootstrapper,f.r.bootstrapperInfo):null==B||B.ULS.sendTraceTag(507778322,i.W.uo,r.G.Warning,"Office bootstrapper failed to load for 2-step create new, check previous logs for more details")})).catch((function(n){return null==B?void 0:B.ULS.sendTraceTag(507778321,i.W.uo,r.G.Error,"Encountered error loading Office bootstrapper for 2-step create new: ".concat(n))})):(0,m.g)(z,_.wac.applicationUrl,k,!0,null==e?void 0:e.wiseEnvironment,B).then((function(n){var t=(0,o.CR)((0,m.n)(k),2),e=t[0],u=t[1];if(!u&&e)U(e,n);else{var s=null!=u?u:"Error message undefined. BootStrapped not loaded: ".concat(!e);null==B||B.ULS.sendTraceTag(575419403,i.W.uo,r.G.Error,s);var a={wacErrorName:c.AU.Uo,qosErrorName:c.DG.QosError_OfficeBootstrapperNotLoaded,errorMessage:s,error:u,inStaging:!1};b&&b(a)}})).catch((function(n){A(n)})),[2]}))}))}));Promise.race([Q,X]).catch((function(n){var t=(null!=n?n:"Failed to load the document")+", bootstrapperUrl: ".concat(z.replace(/^https?:\/\//,"")),e={wacErrorName:c.AU.Ao,qosErrorName:c.DG.QosError_FailedToLoadDocument,errorMessage:t,error:n,inStaging:!1};null==B||B.ULS.sendTraceTag(575419407,i.W.uo,r.G.Error,"".concat(c.AU.Ao,": ").concat(t)),b&&b(e)}))}},3077:function(n,t,e){e.d(t,{o:function(){return s}});var o=e(6823),i=e(4320),r=e(8692),u=e(1480);function s(n,t,e,a,l,c,d){void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===c&&(c=1),void 0===d&&(d=!1);var f=(0,u.a)();return(0,u.l5)("wopiDataStartTime"),t(n,a,l,e).then((function(t){var s,a,l,c;if(!t){var d="Graph call failed";return null==e||e.ULS.sendTraceTag(553726284,o.W.uo,i.G.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var v={docUrl:null!==(s=t.webDavUrl)&&void 0!==s?s:n.docUrl,driveId:null!==(l=null===(a=null==t?void 0:t.parentReference)||void 0===a?void 0:a.driveId)&&void 0!==l?l:n.driveId,docId:null!==(c=null==t?void 0:t.id)&&void 0!==c?c:n.docId,fileName:t.name};null==e||e.ULS.sendTraceTag(553726285,o.W.uo,i.G.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!v,"]"));var h=(0,r.YI)(t,e);null==e||e.ULS.sendTraceTag(553726287,o.W.uo,i.G.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!h,"]"));var p={startTime:f,endTime:(0,u.a)()};return(0,u.l5)("wopiDataEndTime"),{documentIdentifier:v,wopiHostData:h,fetchDiagnostics:p}})).catch((function(r){var u;return null==e||e.ULS.sendTraceTag(520729472,o.W.uo,i.G.Warning,"GetWopiData: General getWopiData error. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),c>0&&(null==r?void 0:r.retry)?(null==e||e.ULS.sendTraceTag(544306772,o.W.uo,i.G.Error,"GetWopiData: Retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]")),new Promise((function(n){var t=function(n){if(0===n)throw new Error("Retry count should not be 0");return 1===n?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(c);setTimeout(n,t),null==e||e.ULS.sendTraceTag(508035599,o.W.uo,i.G.Warning,"GetWopiData: Retrying getWopiData with ".concat(c," retries left. Delaying retry for ").concat(t,"ms."))})).then((function(){return s(n,t,e,a,l,c-1)})).catch((function(n){return null==e||e.ULS.sendTraceTag(508035598,o.W.uo,i.G.Error,"GetWopiData: Failed to delay retry getWopiData. [Error: ".concat(n.message,"]")),Promise.reject(n)}))):c>0&&d&&"accessDenied"===(null==r?void 0:r.errorCode)?new Promise((function(n){setTimeout(n,3e3),null==e||e.ULS.sendTraceTag(523269073,o.W.uo,i.G.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(r),"][FailureReason: ").concat(null==r?void 0:r.failure,"]"))})).then((function(){return s(n,t,e,a,l,0)})):(null==e||e.ULS.sendTraceTag(544306773,o.W.uo,i.G.Error,"GetWopiData: Not retrying getWopiData. [Error: ".concat(JSON.stringify(r),"][ShouldRetry: ").concat(c>0,"][FailureReason: ").concat(null!==(u=null==r?void 0:r.failure)&&void 0!==u?u:null==r?void 0:r.message,"]")),Promise.reject(r))}))}},8805:function(n,t,e){e.d(t,{n:function(){return d},g:function(){return c}});var o,i=e(9029),r=e(6823),u=e(4320),s=e(1480),a=e(1541);function l(n,t,e,i){if(null==o||o.delete(e),i&&"PRODUCTION"===i){var r=new URL(n);return r.hostname="res-1.cdn.office.net",c(r.toString(),t,e,!1,i)}return c(n,t,e,!1,i)}function c(n,t,e,c,f,v){return void 0===c&&(c=!0),(0,i.mG)(this,void 0,void 0,(function(){var h,p,m=this;return(0,i.Jh)(this,(function(w){return o||(o=new Map),(h=o.get(e))?[2,h]:(p=new Promise((function(o,h){return(0,i.mG)(m,void 0,void 0,(function(){var p,m,w,g,S,b=this;return(0,i.Jh)(this,(function(H){switch(H.label){case 0:return p=(0,s.a)(),(m=document.getElementById("".concat(e,"_bootstrapper")))?(w=(0,i.CR)(d(e),2),g=w[0],!w[1]&&g?[3,2]:[4,new Promise((function(n,t){m.onload=function(){n()},m.onerror=function(){t("JSAPI script failed to load in parallel with OWL")}})).catch((function(){null==v||v.ULS.sendTraceTag(507531682,r.W.uo,u.G.Error,"JSAPI failed to load ".concat(a.T[e]," bootstrapper in parallel with OWL")),h("JSAPI script failed to load in parallel with OWL")}))]):[3,3];case 1:H.sent(),H.label=2;case 2:return S=(0,s.a)(),null==v||v.ULS.sendTraceTag(507531681,r.W.uo,u.G.Important,"JSAPI script successfully loaded for ".concat(a.T[e]," with OWL")),[2,o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:p,endTime:S}})];case 3:return function(n,t,e,o,i,r,u){if(void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),!document)return null;if(i){var s=document.getElementById(i);if(null!=s)return t&&t(),s}var a=document.createElement("script");if(a.src=n,i&&(a.id=i),t&&(a.onload=t),e&&(a.onerror=function(){var n;u&&(null===(n=a.parentNode)||void 0===n||n.removeChild(a)),e()}),r&&(a.crossOrigin="anonymous"),o){var l=document.getElementsByTagName("script")[0];if(l&&l.parentNode)return l.parentNode.insertBefore(a,l)}document.body.appendChild(a)}(n,(function(){var i=(0,s.a)();null==v||v.ULS.sendTraceTag(507834582,r.W.uo,u.G.Important,"JSAPI fetch succeeded for ".concat(a.T[e]," bootstrapper. OnRetry: false")),o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:p,endTime:i}})}),(function(){return(0,i.mG)(b,void 0,void 0,(function(){var d;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(!c)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l(n,t,e,f)];case 2:return i.sent(),d=(0,s.a)(),null==v||v.ULS.sendTraceTag(507834581,r.W.uo,u.G.Important,"JSAPI fetch succeeded for ".concat(a.T[e]," bootstrapper. OnRetry: true")),o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:p,endTime:d}}),[3,4];case 3:return i.sent(),null==v||v.ULS.sendTraceTag(507834580,r.W.uo,u.G.Error,"JSAPI fetch failed for ".concat(a.T[e]," bootstrapper. OnRetry: true")),h("Load bootstrapper script failed"),[3,4];case 4:return[3,6];case 5:null==v||v.ULS.sendTraceTag(507834579,r.W.uo,u.G.Error,"JSAPI fetch failed for ".concat(a.T[e]," bootstrapper. OnRetry: false")),h("Load bootstrapper script failed"),i.label=6;case 6:return[2]}}))}))}),!1,"".concat(a.T[e],"_bootstrapper"),!1,c),[2]}}))}))})),o.set(e,p),[2,p])}))}))}function d(n){var t=window.Microsoft;if(void 0===t)return[void 0,"Microsoft is undefined"];var e=t.Office,o=a.T[n];return e&&e[o]?[e[o],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(o)]}},8174:function(n,t,e){e.d(t,{Zl:function(){return A},Tq:function(){return U}});var o=e(9029),i=e(7866),r=e(4401),u=e(857),s=e(9640),a=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return r.ZT(t,n),t.prototype.A=function(t){return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),s.w.EMPTY):n.prototype.A.call(this,t)},t.prototype.next=function(n){this.hasCompleted||(this.value=n,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||n.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&n.prototype.next.call(this,this.value),n.prototype.complete.call(this)},t}(u.xQ),l=e(4813),c=e(4855),d=e(3755),f=e(5702),v=e(6823),h=e(4320),p=e(6411),m=e(5189),w=e(9823);function g(n,t,e,o,i,r){if(e){var u=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,i);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBBrowserULSRouting,u,e),!u)){var o=S(n),i=(0,p.fy)(t,o.dataBoundary);e.flushAndSetNewEndpoint(i,(function(){null==e||e.ULS.sendTraceTag(509612803,v.W.uo,h.G.Info,"Updated ULS endpoint. Environment: ".concat(t,", DataBoundary: ").concat(o.dataBoundary,", Region: ").concat(o.region))}))}})).catch((function(n){null==e||e.ULS.sendTraceTag(509875042,v.W.uo,h.G.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(n.message))}))}if(o){var s=(0,w.vJ)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,i);n.then((function(n){if(n&&((0,w.dt)(w.Fh.FeatureGate_DisableEUDBHealthTelemetryRouting,s,e),!s)){var i=S(n),u=(0,p.S$)(t,r,i.dataBoundary);o.flushAndSetNewEndpoint(u,(function(){null==e||e.ULS.sendTraceTag(509612802,v.W.uo,h.G.Info,"Updated Health endpoint. Environment: ".concat(t,", DataBoundary: ").concat(i.dataBoundary,", Region: ").concat(i.region))}))}})).catch((function(n){null==e||e.ULS.sendTraceTag(509875041,v.W.uo,h.G.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(n.message))}))}}function S(n){var t,e=(t=n.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i))&&t[1]?t[1]:"public";return{region:e,dataBoundary:(0,m.g)(e)}}var b,H=e(2757),C=e(3077),I=e(8692);function A(n){return b?"".concat(n,".").concat(b.size):n}function U(n,t,e,r,u,s,v,h,p,m,w,S){if(void 0===v&&(v=!1),b||(b=new Map),!n.isNewFile||!n.createNewInfo&&!n.isTwoStepCreateNew){var U=(0,I.q_)(n);if(!U)return{correlationId:t,bootstrapperObservable:("Not enough document information was provided",new l.y((function(n){return n.error("Not enough document information was provided")}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var y=b.get(U);if(y)return y}return function(n,t,e,r,u,s,l,v,h,p,m,w){var S,b;void 0===l&&(l=!1);var U=A(t),y=null==u?void 0:u.logger,T=new a,F=null!=w?w:H.xG;if(!d.r.isTwoStepCreateNew||!d.r.hostSessionId||!(null==u?void 0:u.createNewParams)){var N=(0,C.o)(n,e,y,l,!(!n.isNewFile&&!n.templateId),1,!!(null==u?void 0:u.meeting));N.then((function(t){var e;F({documentBootInfo:(0,o.pi)((0,o.pi)({},n),t.documentIdentifier),correlationId:U,loadFunctionSubject:T,wopiFetchData:t},r,u,s,v,h,p,null===(e=null==m?void 0:m.get(n.fileType))||void 0===e?void 0:e.jsApiUrl)})).catch((function(t){if(d.r.isTwoStepCreateNew&&d.r.session&&d.r.session.run(i.O.completeCreateNew,{state:"failure",reason:"wopiFetchFailed"},p),s){var e=JSON.stringify(t),o={wacErrorName:c.AU.yo,qosErrorName:c.DG.QosError_VroomWopiFailure,errorMessage:e,error:t,httpErrorCode:t.status,networkError:(0,f.eE)(t)};s(o,n)}}));var E={correlationId:U,bootstrapperObservable:T.asObservable(),fileNamePromise:n.fileName?Promise.resolve(n.fileName):N.then((function(n){return n.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(n,t){N.then((function(t){var e,o;return n(null===(o=null===(e=null==t?void 0:t.wopiHostData)||void 0===e?void 0:e.wac)||void 0===o?void 0:o.applicationUrl)})).catch((function(n){t(n)}))}))};return u&&u.wiseEnvironment&&g(E.applicationUrlPromise,u.wiseEnvironment,y,u.health,null==r?void 0:r.featureGates,u.sessionId),E}F({documentBootInfo:n,correlationId:U,loadFunctionSubject:T,wopiFetchData:(0,I.PI)(u.createNewParams,n)},r,u,s,v,h,p,null===(S=null==m?void 0:m.get(n.fileType))||void 0===S?void 0:S.jsApiUrl);var k={correlationId:d.r.hostSessionId,bootstrapperObservable:T.asObservable(),fileNamePromise:Promise.resolve(n.fileName),applicationUrlPromise:Promise.resolve(null===(b=null==u?void 0:u.createNewParams)||void 0===b?void 0:b.appUrl)};return u&&u.wiseEnvironment&&g(k.applicationUrlPromise,u.wiseEnvironment,y,u.health,null==r?void 0:r.featureGates,u.sessionId),k}(n,t,e,r,u,s,v,h,p,m,w,S)}},8692:function(n,t,e){e.d(t,{PI:function(){return f},VN:function(){return d},YI:function(){return c},q_:function(){return l},ss:function(){return v}});var o=e(9029),i=e(6823),r=e(4320),u=e(1541),s=e(3755),a=e(9048);function l(n){return n.shareUrl?n.shareUrl:n.docId&&n.driveId?"".concat(n.driveId,"_").concat(n.docId):n.docUrl?n.docUrl:n.isNewFile&&n.fileName?"".concat(n.fileName,"_").concat(u.T[n.fileType]):n.baseUrl&&n.fileId?"".concat(n.baseUrl,"_").concat(n.fileId):void 0}function c(n,t){var e,u,s,a,l,c,d,f,v,h=!!(null==n?void 0:n.openWith),p=!!(null===(e=null==n?void 0:n.openWith)||void 0===e?void 0:e.wac);return null==t||t.ULS.sendTraceTag(553916429,i.W.uo,r.G.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(h,"][ValidWac: ").concat(p,"]")),{bundleStaleness:n.officeBundle?n.officeBundle.bundleStaleness:0,bundleUrl:n.officeBundle?n.officeBundle.url:"",bundleVersion:n.officeBundle?n.officeBundle.version:"",sharepointSiteUrl:n.sharepointIds?n.sharepointIds.siteUrl:"",downloadUrl:n["@content.downloadUrl"]||n["@microsoft.graph.downloadUrl"],eTag:n.eTag,fileName:n.name,fileSize:n.size,irmEnabled:(null===(u=n.file)||void 0===u?void 0:u.contentSensitivityLabelProtected)||(null===(s=n.file)||void 0===s?void 0:s.irmEffectivelyEnabled)||(null===(a=n.sensitivityLabel)||void 0===a?void 0:a.protectionEnabled)||(null===(l=n.file)||void 0===l?void 0:l.irmEnabled),protectionEnabled:(null===(c=n.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(d=n.file)||void 0===d?void 0:d.contentSensitivityLabelProtected),isNewFile:!1,readOnly:n.currentUserRole&&n.currentUserRole.readOnly,blocksDownload:n.currentUserRole&&n.currentUserRole.blocksDownload,wac:n.openWith.wac,sharePointInfo:(0,o.pi)({},n.sharepointIds),webUrl:n.webUrl,preSeededSessionKey:null===(f=null==n?void 0:n.wacSession)||void 0===f?void 0:f.preSeededSessionKey,preSeededWacSessionId:null===(v=null==n?void 0:n.wacSession)||void 0===v?void 0:v.preSeededWacSessionId,webDavUrl:n.webDavUrl}}function d(n,t,e,i,r){var u,l,c,d,f,h,p,m,w,g,S,b,H,C,I,A,U,y,T,F,N,E,k,P,R;if(!n.appUrl)throw new Error("appUrl must be provided in CreateNewParams");return{appUrl:(0,a.e8)(void 0,n.appUrl,(null==i?void 0:i.uiHostName)||"OWL-2-step-create-new",t,null==i?void 0:i.uiEmbed),file:(0,o.pi)({name:null===(c=n.file)||void 0===c?void 0:c.name,getUrl:null===(d=n.file)||void 0===d?void 0:d.getUrl,size:null===(f=n.file)||void 0===f?void 0:f.size,eTag:null===(h=n.file)||void 0===h?void 0:h.eTag},t.docId&&{uniqueId:t.docId}),customFontCatalogUrl:n.customFontCatalogUrl,contentBundle:{majorVersion:(null===(p=n.contentBundle)||void 0===p?void 0:p.majorVersion)?Number(null===(m=n.contentBundle)||void 0===m?void 0:m.majorVersion):0,url:null!==(g=null===(w=n.contentBundle)||void 0===w?void 0:w.url)&&void 0!==g?g:"",staleness:(null===(S=n.contentBundle)||void 0===S?void 0:S.staleness)||0},newFileTemplate:t.newFileTemplate,container:e,bootParams:{readOnly:null===(b=n.bootParams)||void 0===b?void 0:b.readOnly,irmEnabled:null===(H=n.bootParams)||void 0===H?void 0:H.irmEnabled,supportsDecryptedContentDownload:null===(C=n.bootParams)||void 0===C?void 0:C.supportsDecryptedContentDownload,viewOnly:null===(I=n.bootParams)||void 0===I?void 0:I.viewOnly,disableChat:!0,openViewByDefault:"view"===t.intent,dataLanguage:t.dataCulture},diagnostics:(null===(A=null==r?void 0:r.bootDiagnostics)||void 0===A?void 0:A.legacyPerformanceData)?(0,o.pi)((0,o.pi)((0,o.pi)({},(0,a.xL)(null===(U=null==r?void 0:r.bootDiagnostics)||void 0===U?void 0:U.legacyPerformanceData.host,null===(y=null==r?void 0:r.bootDiagnostics)||void 0===y?void 0:y.legacyPerformanceData.owlFrame)),(0,a.YV)(t.clickTime,0,t.wdOrigin,void 0,null===(T=s.r.bootstrapperInfo)||void 0===T?void 0:T.performance,r,null==i?void 0:i.featureGates)),{legacyPerformanceData:null===(F=null==r?void 0:r.bootDiagnostics)||void 0===F?void 0:F.legacyPerformanceData}):(0,a.ge)(t.clickTime,0,t.wdOrigin,void 0,null===(N=s.r.bootstrapperInfo)||void 0===N?void 0:N.performance,r,null==i?void 0:i.featureGates),sessionContext:v(n.appUrl)||(0,a.l_)(),preseededSession:{key:null===(E=n.preseededSession)||void 0===E?void 0:E.key,id:null===(k=n.preseededSession)||void 0===k?void 0:k.id},wdParams:(0,o.pi)((0,o.pi)((0,o.pi)({},t.templateId&&(u={},u.wdTpl=t.templateId,u)),t.uiCulture&&(l={},l.wdlcid=t.uiCulture,l)),(0,a.q6)(t.wdValue)),hostGeneratedSessionId:null==r?void 0:r.sessionId,meeting:null==r?void 0:r.meeting,throttling:{protection:null===(P=n.throttling)||void 0===P?void 0:P.protection,request:null===(R=n.throttling)||void 0===R?void 0:R.request}}}function f(n,t){var e,o,i,r,u,a,l,c,d,f,v,h;return{documentIdentifier:{docUrl:t.docUrl,driveId:t.driveId,docId:t.docId,fileName:null===(e=n.file)||void 0===e?void 0:e.name},wopiHostData:{bundleStaleness:null===(o=n.contentBundle)||void 0===o?void 0:o.staleness,bundleUrl:null===(i=n.contentBundle)||void 0===i?void 0:i.url,bundleVersion:null===(r=n.contentBundle)||void 0===r?void 0:r.majorVersion.toString(),downloadUrl:null===(u=n.file)||void 0===u?void 0:u.getUrl,eTag:null===(a=n.file)||void 0===a?void 0:a.eTag,fileName:null===(l=n.file)||void 0===l?void 0:l.name,fileSize:null===(c=n.file)||void 0===c?void 0:c.size,irmEnabled:null===(d=n.bootParams)||void 0===d?void 0:d.irmEnabled,protectionEnabled:null===(f=n.bootParams)||void 0===f?void 0:f.supportsDecryptedContentDownload,isNewFile:!!t.isNewFile,readOnly:!!(null===(v=n.bootParams)||void 0===v?void 0:v.readOnly),blocksDownload:!!(null===(h=n.bootParams)||void 0===h?void 0:h.viewOnly),sharePointInfo:{},wac:{bootstrapperUrl:s.r.bootstrapperUrl,applicationUrl:n.appUrl,userId:t.puid}},fetchDiagnostics:{}}}function v(n,t){var e;try{e=new URLSearchParams(new URL(n).search).get("sc")||void 0}catch(n){null==t||t.ULS.sendTraceTag(520135565,i.W.uo,r.G.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(n)))}return e}},9048:function(n,t,e){e.d(t,{EN:function(){return m},N2:function(){return v},N6:function(){return p},UI:function(){return T},YV:function(){return b},ZR:function(){return A},e8:function(){return U},fG:function(){return g},ge:function(){return S},l_:function(){return h},q6:function(){return y},t1:function(){return I},v1:function(){return w},xL:function(){return H}});var o=e(9029),i=e(6823),r=e(4320),u=e(1480),s=e(1541),a=e(4855),l=e(469),c=e(478),d=e(9823),f=e(374),v="officecom";function h(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function p(n,t,e,o,i,r,u,s){return{HostName:"office.com",HostSessionId:t,UserId:n,OwnerId:void 0,UiLocale:e,DataLocale:o,DisableChat:!0,CookieCompliant:!0,WdParams:u,DisableFocusOnBoot:!1,SessionContext:s||h(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==i?void 0:i.hideHeader,HideAppLauncherInHeader:null==i?void 0:i.hideAppLauncherInHeader,HideSearchInHeader:null==i?void 0:i.hideSearchInHeader,HideMeInHeader:null==i?void 0:i.hideMeInHeader,HideChatInHeader:null==i?void 0:i.hideChatInHeader,HideWorkflowInHeader:null==i?void 0:i.hideWorkflowInHeader,HideSettingsInHeader:null==i?void 0:i.hideSettingsInHeader,ShowAppIconInHeader:null==i?void 0:i.showAppIconInHeader,UseNeutralColorInHeader:null==i?void 0:i.useNeutralColorInHeader,SupportsDocReboot:null==i?void 0:i.supportsDocumentReboot,SupportsCreateNewDocument:null==i?void 0:i.supportsCreateNewDocument,SupportsAuthToken:null==i?void 0:i.supportsAuthToken,SupportsAtMentions:null==i?void 0:i.supportsAtMentions,SupportsMoveToFolder:null==i?void 0:i.supportsMoveToFolder,SupportsCommonFilePicker:null==i?void 0:i.supportsCommonFilePicker,SupportsDirectPrint:null==i?void 0:i.supportsDirectPrint,SupportsDirectDownload:null==i?void 0:i.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==i?void 0:i.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==i?void 0:i.supportsExcelExternalLinks,UiHostIntegrationType:null==i?void 0:i.uiHostIntegrationType,OpenLinksInNewWindow:null==i?void 0:i.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==i?void 0:i.supportsCustomAuthConfig,ContentAssemblyMode:null==i?void 0:i.contentAssemblyMode,SupportsRefreshAccessToken:null==i?void 0:i.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout}}function m(n,t){var e,i,r,u=n.docId,s=n.isNewFile,a=n.fileName,l=n.intent;return t?(0,o.pi)((0,o.pi)({FileName:t.fileName,FileGetUrl:(null===(e=t.wac)||void 0===e?void 0:e.fileGetUrl)||t.downloadUrl,CustomFontCatalogUrl:t.wac.customFontCatalogUrl,FileSize:t.fileSize,BundleInfo:{Url:t.bundleUrl,MajorVersion:t.bundleVersion,BundleStaleness:t.bundleStaleness},ReadOnly:t.readOnly,IrmEnabled:t.irmEnabled,ViewOnly:t.blocksDownload,ETag:t.eTag,ClientThrottlingProtection:null===(i=t.wac)||void 0===i?void 0:i.clientThrottlingProtection,RequestedCallThrottling:null===(r=t.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!s||t.isNewFile},u&&{DocUniqueId:u}),{OpenViewByDefault:"view"===l}):(0,o.pi)({FileName:a,IsNewFile:!0},u&&{DocUniqueId:u})}function w(n){return{WopiSrc:n.wopiSrc,AccessToken:n.accessToken,AccessTokenExpiry:new Date(parseInt(n.accessTokenExpiry,10)),WacToken:n.wacToken}}function g(n){switch((0,l.aE)(n)){case l.o4.OneDrive:return"OneDrive";case l.o4.SharePoint:return"SharePoint Online";default:return"Unknown"}}function S(n,t,e,i,r,u,s){void 0===i&&(i={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var a=window.performance.timing,l=window.performance.navigation,c=l.redirectCount||0,d=a.navigationStart||0,f=a.fetchStart||0,v=a.responseEnd||0,h=a.requestStart||0,p=a.responseStart||0,m=a.responseEnd||0,w=a.domComplete||0,g="UNKNOWN";switch(l.type){case 0:g="NAVIGATE";break;case 1:g="RELOAD";break;case 2:g="BACK_FORWARD";break;case 255:g="RESERVED"}return(0,o.pi)((0,o.pi)({},b(n,t,e,i,r,u,s)),{hostPageNavigationStartTime:d,hostPageFetchStartTime:f,hostPageFetchEndTime:v,hostPageRequestStartTime:h,hostPageResponseStartTime:p,hostPageResponseEndTime:m,hostPageDomCompleteTime:w,hostPageRedirectCount:c,hostPageNavigationType:g})}function b(n,t,e,s,l,d,v){void 0===s&&(s={startTime:0,endTime:0}),void 0===l&&(l={startTime:0,endTime:0});var h=l.startTime||0,p=l.endTime||0,m=(0,u.a)();(0,u.l5)("officeInitializationTime");var w,g,S=null==d?void 0:d.logger,b=(null==d?void 0:d.bootDiagnostics)||{},H=b.tabsCacheHit,C=b.packageEntryTime,I=b.isTestMode,A=b.ringId;n&&(w=m-n),C&&(g=m-C);var U=(0,o.pi)((0,o.pi)((0,o.pi)({},b),a.c),{bootStrapStartTime:(null==l?void 0:l.startTime)||0,bootStrapEndTime:(null==l?void 0:l.endTime)||0,wopiDataStartTime:(null==s?void 0:s.startTime)||0,wopiDataEndTime:(null==s?void 0:s.endTime)||0,isCookieBlocked:!c.X,createNewEndTime:b.createNewStartTime?(0,u.a)():void 0,owlFeatureGates:v?(0,f.d)(v):void 0});return a.c.accessTokenStartTime=void 0,a.c.accessTokenEndTime=void 0,a.c.driveItemStartTime=void 0,a.c.driveItemEndTime=void 0,a.c.driveItemFromWacStartTime=void 0,a.c.driveItemFromWacEndTime=void 0,a.c.spRequestGuid=void 0,a.c.createNewStartTime=void 0,a.c.createNewEndTime=void 0,a.c.loadManifestStartTime=void 0,a.c.loadManifestEndTime=void 0,a.c.getManifestFromRemoteTimeElapsed=void 0,a.c.loadManifestServerTimeElapsed=void 0,a.c.loadOwlStartTime=void 0,a.c.loadOwlEndTime=void 0,a.c.isVroom21=!1,null==S||S.ULS.sendTraceTag(556613895,i.W.uo,r.G.Info,"getDiagnostics: [SessionOrigin: ".concat(e,"][TabsCacheHit: ").concat(H,"][IsTestMode: ").concat(I,"][RingId: ").concat(A,"][TimeElapsedSinceUserClick:").concat(w,"][TimeElapsedSincePackageEntry: ").concat(g,"]")),{entryPoint:e,hostPageFirstFlushTime:t,userClickTime:n,officeBootstrapperStartTime:h,officeBootstrapperEndTime:p,officeInitializationTime:m,unifiedUiHostDiagnostics:U}}function H(n,t){var e="UNKNOWN";switch(null==n?void 0:n.navigation.type){case 0:e="NAVIGATE";break;case 1:e="RELOAD";break;case 2:e="BACK_FORWARD";break;case 255:e="RESERVED"}var o="UNKNOWN";switch(null==t?void 0:t.navigation.type){case 0:o="NAVIGATE";break;case 1:o="RELOAD";break;case 2:o="BACK_FORWARD";break;case 255:o="RESERVED"}return{hostPageNavigationStartTime:(null==n?void 0:n.timing.navigationStart)||0,hostPageFetchStartTime:(null==n?void 0:n.timing.fetchStart)||0,hostPageFetchEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageRequestStartTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageResponseStartTime:(null==n?void 0:n.timing.responseStart)||0,hostPageResponseEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageDomCompleteTime:(null==n?void 0:n.timing.domComplete)||0,hostPageRedirectCount:(null==n?void 0:n.navigation.redirectCount)||0,hostPageNavigationType:e,owlFramePageNavigationStartTime:(null==t?void 0:t.timing.navigationStart)||0,owlFramePageFetchStartTime:(null==t?void 0:t.timing.fetchStart)||0,owlFramePageFetchEndTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageRequestStartTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageResponseStartTime:(null==t?void 0:t.timing.responseStart)||0,owlFramePageResponseEndTime:(null==t?void 0:t.timing.responseEnd)||0,owlFramePageDomCompleteTime:(null==t?void 0:t.timing.domComplete)||0,owlFramePageRedirectCount:(null==t?void 0:t.navigation.redirectCount)||0,owlFramePageNavigationType:o}}var C=function(n){var t=new URL(n);return t.searchParams.delete("wopisrc"),t.href};function I(n){return function(t){var e=t;switch(t){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":e="unifiedUiHostInTeams"}if((null==n?void 0:n.experiments)&&e in(null==n?void 0:n.experiments))return function(n){switch(n){case 0:return!1;case 1:return!0;default:return}}(null==n?void 0:n.experiments[e])}}function A(n,t,e){switch(n){case s.T.Word:case s.T.PowerPoint:case s.T.Excel:case s.T.Visio:return!0;case s.T.OneNote:var o=(0,d.vJ)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,t);return(0,d.dt)(d.Fh.FeatureGate_OneNoteJsApiV2Gate,o,e),o;default:return!1}}function U(n,t,e,o,i){var r,u,s=n?(null===(r=n.wac)||void 0===r?void 0:r.applicationUrl)||(null===(u=n.wac)||void 0===u?void 0:u.editUrl):C(t);return s?function(n,t,e,o,i,r){var u="".concat(n,"&uih=").concat(t);return(null==r||r)&&(u="".concat(u,"&uiEmbed=1")),o&&(u="".concat(u,"&wdTpl=").concat(o)),i&&(u="".concat(u,"&wdlcid=").concat(i)),e&&(u="".concat(u,"&actNavId=").concat(e)),u}(s,e,o.navId,o.templateId,o.rebootOverrideData?o.rebootOverrideData.lcid:o.uiCulture,i):""}function y(n){var t;return n?((t={}).wd=encodeURIComponent(n),t):{}}function T(n,t,e,i,r,u,s,a,l,c,d,f,v,h,p,m,w,g,S,b){var H=t.applicationUrl,C=t.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===b&&(b={});var A={HostUIControls:g?[{id:"close",visibility:f?1:0},{id:"share",visibility:v?1:0},{id:"ellipsisOpenInBrowser",visibility:h?1:0},{id:"ellipsisDownload",visibility:p?1:0},{id:"copyLink",visibility:m?1:0},{id:"conversation",visibility:S?1:0}]:void 0,additionalApplicationParameters:b},y=U(d,H,l,c,w);return(0,o.pi)({BootstrapperUrl:C,Container:n,SessionInformation:i,ApplicationUrl:y,WopiPrecheckInfo:r,ApplicationCustomSettings:A,Diagnostics:u,FnOnInitializeSuccess:s,FnOnInitializeFailure:a,FnIsFeatureEnabled:I(),RebootOverrideData:c.rebootOverrideData},e?{WopiInfo:e}:{})}},1599:function(n,t,e){e.d(t,{X$:function(){return o},a6:function(){return s},gP:function(){return u},oZ:function(){return r},ok:function(){return a}});var o,i=e(9029),r=[];function u(){r=[]}function s(n){var t=this;return function(o){return(0,i.mG)(t,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(3648).then(e.bind(e,5655))];case 1:return[4,t.sent().wopiInfoFromUrlHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}function a(n){var t=this;return function(o){return(0,i.mG)(t,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(3648).then(e.bind(e,5655))];case 1:return[4,t.sent().davUrlFromIdsHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}!function(n){n[n.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",n[n.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(o||(o={}))},7541:function(n,t,e){e.d(t,{R:function(){return s}});var o=e(6823),i=e(4320),r=e(3242),u=e(7866);function s(n,t,e,s,a){if(s){var l=function(n){switch(n){case r.KX.PostMessage_RefreshSessionInfo:return u.O.sendSessionInfo;case r.KX.PostMessage_GrantPermissions:return u.O.sendUserAccessAndPermissions;case r.KX.PostMessage_SetAuthToken:return u.O.sendAuthToken;case r.KX.PostMessage_HostAccessibilityLoopComplete:return u.O.continueAccessibilityLoop;case r.KX.PostMessage_SetHostWopiInfoFromUrl:return u.O.sendWopiInfo;case r.KX.PostMessage_MoveToFolderCompleted:return u.O.moveToFolder;case r.KX.PostMessage_CompleteFilePicker:return u.O.completeSharedFilePicker;case r.KX.PostMessage_SendCustomAuthConfig:return u.O.sendCustomAuthConfig;case r.KX.PostMessage_SetDavUrlFromIds:return u.O.sendDavUrl;case r.KX.PostMessage_BlurFocus:return u.O.blurFocus;case r.KX.PostMessage_PopState:return u.O.popState;case r.KX.PostMessage_GrabFocus:return u.O.grabFocus;case r.KX.PostMessage_HostGetClientUrl:return u.O.getClientUrl;case r.KX.PostMessage_HostGetWebUrl:return u.O.getWebUrl;case r.KX.PostMessage_OwlFrameDiagnostics:return u.O.sendOwlFrameDiagnostics;case r.KX.PostMessage_HostBackButtonPressed:return u.O.backButtonPressed;case r.KX.PostMessage_HostSendChannelId:return u.O.sendChannelId;case r.KX.PostMessage_HostSendConversationId:return u.O.sendConvId;case r.KX.PostMessage_PostWacToken:return u.O.postWacToken;default:return}}(n);if(l){var c=l;s.run(c,t).catch((function(n){return null==a?void 0:a.ULS.sendTraceTag(512337544,o.W.uo,i.G.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(n))}))}}else e?e.then((function(e){e?function(n,t,e,r){var u,s=null;try{s=new URL(n)}catch(t){return void(null==r||r.ULS.sendTraceTag(541180047,o.W.uo,i.G.Warning,"Failed to send post message. could not create url from ".concat(n," with error: ").concat(t)))}var a=s.origin,l={MessageId:t,SendTime:(new Date).getTime(),Values:e},c=JSON.stringify(l),d=document.getElementById("WebApplicationFrame");d?null===(u=null==d?void 0:d.contentWindow)||void 0===u||u.postMessage(c,a):null==r||r.ULS.sendTraceTag(541180048,o.W.uo,i.G.Warning,"Failed to send post message. Could not find iframe")}(e,n,t,a):null==a||a.ULS.sendTraceTag(541180045,o.W.uo,i.G.Warning,"Failed to send post message. appUrl is null")})).catch((function(n){return null==a?void 0:a.ULS.sendTraceTag(512337543,o.W.uo,i.G.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(n))})):null==a||a.ULS.sendTraceTag(541180046,o.W.uo,i.G.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}},5189:function(n,t,e){var o;function i(n){var t=n.toUpperCase();return"CHC"===t||"DEC"===t||"EUC"===t||"EURPPC"===t||"FRC"===t||"SEC"===t||"NOC"===t?o.EuropeanUnion:o.RestOfWorld}e.d(t,{U:function(){return o},g:function(){return i}}),function(n){n[n.RestOfWorld=0]="RestOfWorld",n[n.EuropeanUnion=1]="EuropeanUnion"}(o||(o={}))},6411:function(n,t,e){e.d(t,{A8:function(){return s},S$:function(){return u},fy:function(){return r},w8:function(){return a}});var o=e(5189);function i(n,t){switch(n){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return t===o.U.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(n,t){return i(n,t)+"RemoteUls.ashx"}function u(n,t,e){var o=i(n,e)+"RemoteTelemetry.ashx";return t&&(o+="?usid="+t),o}function s(n){switch(n){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function a(){return"res.cdn.office.net/officehub"}},3242:function(n,t,e){var o,i,r,u,s,a;e.d(t,{Bn:function(){return s},Dm:function(){return i},E_:function(){return o},KX:function(){return u}}),function(n){n.Event_DocumentReboot="DocReboot",n.Event_SetOverlayContent="SetOverlayContent",n.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",n.Event_Unloaded="Unloaded",n.Event_MoveToFolder="MoveToFolder",n.Event_SharedFilePicker="FilePicker",n.Event_GetCustomAuthConfig="GetCustomAuthConfig",n.Event_GetDavUrlFromIds="DavUrlFromIds"}(o||(o={})),function(n){n.PostMessage_FileRenamed="File_Rename",n.PostMessage_Close="UI_Close",n.PostMessage_EditModeSwitch="UI_Edit",n.PostMessage_FileVersion="UI_FileVersions",n.PostMessage_SaveStatus="UI_SaveStatus",n.PostMessage_Share="UI_Sharing",n.PostMessage_Workflow="UI_Workflow",n.PostMessage_UserActivity="User_Activity",n.PostMessage_EditNotification="Edit_Notification",n.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",n.PostMessage_PostMessageDocReboot="App_DocReboot",n.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",n.PostMessage_AppCreateNewDocument="App_CreateNewDocument",n.PostMessage_GetAuthToken="App_GetAuthToken",n.PostMessage_NavigateBackToHost="NavigateBackToHost",n.PostMessage_SendConversationId="App_SendConversationId",n.PostMessage_CloseTeamsConversation="CloseTeamsConversation",n.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",n.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",n.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",n.PostMessage_LoadingStatus="App_LoadingStatus",n.PostMessage_ActionComplete="Wac_ActionComplete",n.PostMessage_OpenInBrowser="UI_OpenInBrowser",n.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",n.PostMessage_AppPushState="App_PushState",n.PostMessage_CAAEMessage="CAAEMessage",n.PostMessage_FileEmbed="UI_FileEmbed",n.PostMessage_AcquireOAuthTokenTeams="AcquireOAuthTokenTeams"}(i||(i={})),function(n){n.Nav="actnavid"}(r||(r={})),function(n){n.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",n.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",n.PostMessage_SetOverlayContent="SetOverlayContent",n.PostMessage_SetAuthToken="Host_SetAuthToken",n.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",n.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",n.PostMessage_HostGetClientUrl="Host_GetClientUrl",n.PostMessage_HostGetWebUrl="Host_GetWebUrl",n.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",n.PostMessage_CompleteFilePicker="Host_FilePicker",n.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",n.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",n.PostMessage_BlurFocus="Blur_Focus",n.PostMessage_PopState="App_PopState",n.PostMessage_GrabFocus="Grab_Focus",n.PostMessage_OwlFrameDiagnostics="OwlFrameDiagnostics",n.PostMessage_HostSendChannelId="Host_SendChannelId",n.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",n.PostMessage_HostSendConversationId="Host_SendConversationId",n.PostMessage_PostWacToken="Host_PostWacToken"}(u||(u={})),function(n){n.SameDocument="0",n.NewDocument="1"}(s||(s={})),function(n){n.AccessToken="AccessToken",n.FileGetUrl="FileGetUrl"}(a||(a={}))},9645:function(n,t,e){e.d(t,{G2:function(){return s},pb:function(){return l},vb:function(){return c},zP:function(){return a}});var o=e(9029),i=e(3270),r=e(1709),u=e(6411),s=function(){function n(n,t){var e;"string"==typeof n?this.sessionId=n:(e=(0,o.CR)(n,1),this.sessionId=e[0]),this.environment=t,this.logger=this.setUlsLogger(this.sessionId)}return n.prototype.setUlsLogger=function(n){var t=(0,u.fy)(this.environment);return(0,i.L8)({remoteUlsEndpoint:t,sessionId:n})},n}(),a=function(n,t,e,o,i,s,a,l,c,d,f,v){var h,p=(0,u.S$)(e,n),m={application:t.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:n,clientVersion:null!=o?o:"n/a",isSynthetic:s,applicationLcid:a,loggableUserId:l,tenantId:c,uiHost:d,uiHostIntegrationType:f,sessionOrigin:v};this.health=r.S9.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:p,dimensions:m}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",t.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",e.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(h=null==i?void 0:i.toString())&&void 0!==h?h:"n/a")};function l(){var n,t=null===(n=performance.getEntriesByType("navigation")[0])||void 0===n?void 0:n.toJSON();if(t)return{connectEnd:t.connectEnd,connectStart:t.connectStart,decodedBodySize:t.decodedBodySize,domainLookupEnd:t.domainLookupEnd,domainLookupStart:t.domainLookupStart,domComplete:t.domComplete,domContentLoadedEventEnd:t.domContentLoadedEventEnd,domContentLoadedEventStart:t.domContentLoadedEventStart,domInteractive:t.domInteractive,duration:t.duration,encodedBodySize:t.encodedBodySize,entryType:t.entryType,fetchStart:t.fetchStart,initiatorType:t.initiatorType,loadEventEnd:t.loadEventEnd,loadEventStart:t.loadEventStart,nextHopProtocol:t.nextHopProtocol,redirectCount:t.redirectCount,redirectEnd:t.redirectEnd,redirectStart:t.redirectStart,requestStart:t.requestStart,responseEnd:t.responseEnd,responseStart:t.responseStart,secureConnectionStart:t.secureConnectionStart,serverTiming:t.serverTiming,startTime:t.startTime,transferSize:t.transferSize,type:t.type,unloadEventEnd:t.unloadEventEnd,unloadEventStart:t.unloadEventStart,workerStart:t.workerStart}}function c(){var n=window.performance.timing,t=window.performance.navigation,e={};return n&&(e.timing={navigationStart:n.navigationStart,redirectStart:n.redirectStart,redirectEnd:n.redirectEnd,fetchStart:n.fetchStart,domainLookupStart:n.domainLookupStart,domainLookupEnd:n.domainLookupEnd,connectStart:n.connectStart,connectEnd:n.connectEnd,secureConnectionStart:n.secureConnectionStart,requestStart:n.requestStart,responseStart:n.responseStart,responseEnd:n.responseEnd,domLoading:n.domLoading,domInteractive:n.domInteractive,domContentLoadedEventStart:n.domContentLoadedEventStart,domContentLoadedEventEnd:n.domContentLoadedEventEnd,domComplete:n.domComplete,loadEventStart:n.loadEventStart,loadEventEnd:n.loadEventEnd}),t&&(e.navigation={type:t.type,redirectCount:t.redirectCount}),e}},4855:function(n,t,e){var o,i,r,u,s,a;e.d(t,{AU:function(){return s},DG:function(){return u},J4:function(){return l},NF:function(){return c},c:function(){return d},cS:function(){return r},yv:function(){return i}}),function(n){n.DriveId="drive",n.ItemId="item",n.DocUrl="file",n.ContentUri="contenturi",n.Nav="nav"}(o||(o={})),function(n){n.To="DavUrlFromIds",n.Fo="WopiAuthRefresh",n.No="WopiAuthFetch",n.Eo="WopiInfoFromUrl"}(i||(i={})),function(n){n.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",n.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",n.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",n.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",n.QosVeto_FilePickerFailed="FilePickerFailed",n.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",n.QosVeto_OwlFrameExperienceFailed="OwlFrameExperienceFailed"}(r||(r={})),function(n){n.QosError_VroomWopiFailure="VroomWopiFailure",n.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",n.QosError_EncounteredJsApiError="EncounteredJsApiError",n.QosError_FailedToLoadDocument="FailedToLoadDocument",n.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",n.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",n.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",n.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",n.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",n.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",n.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",n.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",n.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",n.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",n.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",n.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",n.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",n.QosError_FilePickerBootFailed="FilePickerBootFailed",n.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",n.QosError_SelectedItemNotReturned="SelectedItemNotReturned",n.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",n.QosError_UrlNotProvided="UrlNotProvided",n.QosError_CallbackNotDefined="CallbackNotDefined",n.QosError_OwlFrameCreationFailure="OwlFrameCreationFailure"}(u||(u={})),function(n){n.wo="Bootstrapfile_WacDocumentVroomError",n.yo="LoadDocument_WacDocumentVroomError",n.Uo="WacDocumentBootstrapperLoadError",n.Ao="WacInitializeWopiPendingError",n.ko="WacDocumentGenericBootError",n.Io="WacDocumentJsApiV1Error",n.Co="WacDocumentJsApiV2Error",n.bo="WacDocumentJsApiV2Error_App",n.Ho="WacDocumentJsApiV2Error_JsApi",n.So="WacDocumentJsApiV2Error_Timeout"}(s||(s={})),function(n){n.PermissionError="PermissionError",n.NotFound="NotFound",n.Throttling="Throttling",n.Offline="Offline",n.Other="Other"}(a||(a={}));var l,c,d={};!function(n){n.New="NEW",n.BackstageMru="BACKSTAGE-MRU",n.Reboot="REBOOT"}(l||(l={})),function(n){n.SharePointOnline="sharepoint",n.OneDriveConsumer="onedrive",n.Graph="graph"}(c||(c={}))},3755:function(n,t,e){e.d(t,{f:function(){return h},r:function(){return v}});var o=e(9029),i=e(6823),r=e(4320),u=e(9048),s=e(8174),a=e(8805),l=e(8692),c=e(7866),d=e(8594),f=e(4415),v=function(){function n(){}return Object.defineProperty(n,"isCreateNewFlowExecuting",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapper&&n.bootstrapperLoadPromise&&n.bootstrapperUrl&&n.bootstrapperInfo&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"isCreateNewFlowExecutingForJsApiBundledWithOwl",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapperUrl&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"completeCreateNewPromise",{get:function(){return n.Po},enumerable:!1,configurable:!0}),n.completeCreateNew=function(n){this.Ro.resolve&&this.Ro.resolve(n)},n.failCreateNew=function(n){this.Ro.reject&&this.Ro.reject(n)},n.isTwoStepCreateNew=!1,n.createNewFlowExecuting=!1,n.sessionPromise=new f.C,n.Ro={},n.Po=new Promise((function(t,e){n.Ro.resolve=t,n.Ro.reject=e})),n}();function h(n,t){var e,f,h,p;if(v.isTwoStepCreateNew=!!(n.documentBootInfo.isNewFile&&n.documentBootInfo.isTwoStepCreateNew&&n.sessionConfig.createNewParams&&n.sessionConfig.createNewParams.appUrl&&(0,u.ZR)(n.documentBootInfo.fileType,null===(e=n.uiHostConfig)||void 0===e?void 0:e.featureGates,t)&&(null===(f=n.initPackageParams)||void 0===f?void 0:f.jsApiUrlInfos)&&(null===(h=n.initPackageParams)||void 0===h?void 0:h.jsApiUrlInfos.get(n.documentBootInfo.fileType))),v.isTwoStepCreateNew){var m=n.initPackageParams.jsApiUrlInfos.get(n.documentBootInfo.fileType);m?(v.bootstrapperUrl=m.jsApiUrl,v.hostSessionId=(0,s.Zl)(n.sessionConfig.hostCorrelationId),v.bootstrapperLoadPromise=(0,a.g)(m.jsApiUrl,n.sessionConfig.createNewParams.appUrl,n.documentBootInfo.fileType,!0,n.sessionConfig.wiseEnvironment,t).then((function(e){var u=(0,o.CR)((0,a.n)(n.documentBootInfo.fileType),2),s=u[0],f=u[1];if(f||!s||!v.hostSessionId)return null==t||t.ULS.sendTraceTag(507778318,i.W.uo,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(f)),!1;v.bootstrapper=s,v.bootstrapperInfo=e,v.application=s.createApplication((0,d.Z)(n.documentBootInfo,v.bootstrapperInfo.bootstrapperUrl,n.uiHostConfig,n.sessionConfig)),v.session=v.application.createSession({hostSessionId:v.hostSessionId}),v.sessionPromise.resolve(v.session),v.createNewFlowExecuting=!0;var h=(0,l.VN)(n.sessionConfig.createNewParams,n.documentBootInfo,n.container,n.uiHostConfig,n.sessionConfig);return v.session.run(c.O.createNew,h).catch((function(n){null==t||t.ULS.sendTraceTag(507778317,i.W.uo,r.G.Warning,"Caught error running create new flow: ".concat(n)),v.createNewFlowExecuting=!1})),!0})).catch((function(e){return null==t||t.ULS.sendTraceTag(507778316,i.W.uo,r.G.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(e)),!1}))):null==t||t.ULS.sendTraceTag(507778319,i.W.uo,r.G.Warning,"jsapiBootstrapperUrl for ".concat(n.documentBootInfo.fileType," is undefined in ").concat(null===(p=n.uiHostConfig)||void 0===p?void 0:p.uiHostName))}}},5702:function(n,t,e){e.d(t,{SS:function(){return u},aj:function(){return s},eE:function(){return r}});var o=e(9029),i=e(4855);function r(n){return!(!n||!n.failure)&&"TypeError: Failed to fetch"===n.failure}function u(n){switch(n){case i.AU.wo:case i.AU.yo:return!1;default:return!0}}function s(n){var t=n.httpErrorCode,e=n.networkError,r=n.qosErrorName,u=n.errorMessage,s=n.error,c=n.documentLoadedWithTabSwitch,d=r===i.DG.QosError_EncounteredJsApiError&&"timeout"===u&&c;return e||d||[401,403,404,429].includes(t)||function(n){var t,e,i,r;if(!n)return!1;try{for(var u=[JSON.parse(n)];u.length>0;){var s=u.pop();if("string"==typeof s){if(a.has(s))return!0}else if("object"==typeof s&&null!==s)try{for(var c=(t=void 0,(0,o.XA)(Object.values(s))),d=c.next();!d.done;d=c.next()){var f=d.value;u.push(f)}}catch(n){t={error:n}}finally{try{d&&!d.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}}}catch(t){try{for(var v=(0,o.XA)(l),h=v.next();!h.done;h=v.next()){var p=h.value;if(-1!==n.indexOf(p))return!0}}catch(n){i={error:n}}finally{try{h&&!h.done&&(r=v.return)&&r.call(v)}finally{if(i)throw i.error}}}return!1}(JSON.stringify(s))}var a=new Set(["DocumentIsIRMProtected","5373959","5243086","5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]),l=Array.from(a)},9823:function(n,t,e){e.d(t,{Fh:function(){return o},dt:function(){return u},vJ:function(){return s}});var o,i=e(6823),r=e(4320);function u(n,t,e){null==e||e.ULS.sendTraceTag(521164238,i.W.uo,r.G.Info,"".concat(n,": ").concat(t?"Enabled":"Disabled"))}function s(n,t){if(!t)return!1;if(!t.has(n))return!1;var e=t.get(n);return null!=e&&"boolean"==typeof e&&e}!function(n){n.FeatureGate_EcsHootGate="EcsHootGate",n.FeatureGate_VisioJsApiV2Gate="VisioJsApiV2Gate",n.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",n.FeatureGate_HideCloseButtonGate="HideCloseButtonGate",n.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",n.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",n.FeatureGate_BlurAndGrabFocusForShareDialogGate="BlurAndGrabFocusForShareDialogGate",n.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",n.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",n.FeatureGate_DisableEUDBBrowserULSRouting="DisableEUDBBrowserULSRouting",n.FeatureGate_DisableEUDBHealthTelemetryRouting="DisableEUDBHealthTelemetryRouting",n.FeatureGate_ESSForXLGate="ESSForXL",n.FeatureGate_iOSNullCheckFeatureGate="iOSNullCheckFeatureGate",n.FeatureGate_Locale1JSGate="Locale1JSGate",n.FeatureGate_BypassOPTIONSCall="BypassOPTIONSCall",n.FeatureGate_EnableOwlFrameBoot="IsOwlIFrameBootEnabled",n.FeatureGate_EnableOwlFrameBootTreatment="IsOwlIFrameBootTreatment",n.FeatureGate_Vroom21ForWord="Vroom21ForWord",n.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",n.FeatureGate_ManifestCachingGate="ManifestCachingGate",n.FeatureGate_ManualRedirectOnTenantChangeGate="ManualRedirectOnTenantChangeGate",n.FeatureGate_PrefetchWacToken="PrefetchWacToken",n.FeatureGate_UseNewEuplReporting="UseNewEuplReporting",n.FeatureGate_PostWacTokenAsync="PostWacTokenAsync",n.FeatureGate_DeprecateAxios="DeprecateAxios",n.FeatureGate_UseRedirectUrlOnTenantChange="UseRedirectUrlOnTenantChange",n.FeatureGate_UseUnifiedBundling="UseUnifiedBundling",n.FeatureGate_OwlPostWacTokenForTeamsHosts="OwlPostWacTokenForTeamsHosts"}(o||(o={}))},2172:function(n,t,e){e.d(t,{T4:function(){return s},qj:function(){return u}});var o=e(9823),i=e(374),r=new RegExp("(^| )".concat("OwlFrameMode","=([^;]+)")),u=function(){function n(){}return Object.defineProperty(n,"isOwlFrame",{get:function(){return"boolean"==typeof n.Do?n.Do:"https:"===location.protocol&&location.origin.indexOf("common.online.office.com")>-1&&"/suite/WebLoader.aspx"===location.pathname},enumerable:!1,configurable:!0}),n.isOwlFrameBootEnabled=function(t,e){return void 0!==n.Oo?n.Oo:t?(n.Oo=!n.isOwlFrame&&(0,o.vJ)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,t),(0,o.dt)(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,n.Oo,e),n.Oo):(n.Oo=!1,n.Oo)},n.checkOwlFrameCookie=function(n,t){if(t&&"FASTFOOD"===n){var e=document.cookie.match(r);if(e){var i=e[2];"0"===i||"1"===i?(t.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),t.delete(o.Fh.FeatureGate_EnableOwlFrameBootTreatment)):"2"===i?(t.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),t.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0)):"3"===i&&(t.delete(o.Fh.FeatureGate_EnableOwlFrameBoot),t.set(o.Fh.FeatureGate_EnableOwlFrameBootTreatment,!0),t.set(o.Fh.FeatureGate_EcsHootGate,!0))}}},n}();function s(n,t,e,o,r,s){return"Boot Experiment Status: ".concat(u.isOwlFrameBootEnabled(e,s)?"TREATMENT":"CONTROL",", FileType: ").concat(n,", Environment: ").concat(t,", Feature Gates: ").concat(e?(0,i.d)(e):"{}",", UiHost: ").concat(o,", Integration Type: ").concat(r)}},478:function(n,t,e){e.d(t,{X:function(){return o}}),e(6823),e(4320);var o=function(){var n=void 0;try{n=window.localStorage}catch(n){}return n}()},8604:function(n,t,e){function o(n){return new Map([["ErrorName","".concat(n.wacErrorName)+(n.errorName?"_".concat(n.errorName):"")],["ErrorMessage",n.errorMessage?n.errorMessage:""],["HttpErrorCode","".concat(n.httpErrorCode)],["NetworkError","".concat(n.networkError)],["error",n.error?i(n.error):""],["DocumentLoadedWithTabSwitch","".concat(n.documentLoadedWithTabSwitch)]])}function i(n){if("string"==typeof n)try{return JSON.parse(n),n}catch(n){}return JSON.stringify(n,Object.getOwnPropertyNames(n))}e.d(t,{x:function(){return o}})},8594:function(n,t,e){e.d(t,{Z:function(){return i}});var o=e(9048);function i(n,t,e,i,r){var u,s,a,l,c,d,f,v,h,p,m,w;return{host:{storageHostName:(0,o.fG)(null!==(u=n.docUrl)&&void 0!==u?u:""),capabilities:{isFeatureEnabledCallback:(0,o.t1)(i),moveToFolder:null==e?void 0:e.supportsMoveToFolder,commonFilePicker:null==e?void 0:e.supportsCommonFilePicker,rebootDoc:null==e?void 0:e.supportsDocumentReboot,createNewDoc:null==e?void 0:e.supportsCreateNewDocument,authToken:null==e?void 0:e.supportsAuthToken,excelExternalLinks:null==e?void 0:e.supportsExcelExternalLinks,refreshAccessToken:null==e?void 0:e.supportsRefreshAccessToken,atMentions:null==e?void 0:e.supportsAtMentions,accessibilityLoop:null==e?void 0:e.supportsAccessibilityLoop,customAuthConfig:null==e?void 0:e.supportsCustomAuthConfig,directPrint:null===(s=null==e?void 0:e.supportsDirectPrint)||void 0===s||s,directDownload:null==e?void 0:e.supportsDirectDownload},uiHostName:(null==e?void 0:e.uiHostName)||o.N2,requireExplicitUnload:null==e?void 0:e.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==e?void 0:e.uiHostIntegrationType,uiHostScenarioType:null===(a=null==i?void 0:i.additionalApplicationParameters)||void 0===a?void 0:a.uiHostScenarioType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout,origin:null==i?void 0:i.origin},user:{id:r&&r.wac&&r.wac.userId||n.puid||"",isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:t,ui:{uiEmbed:null===(l=null==e?void 0:e.uiEmbed)||void 0===l||l,controls:(null==e?void 0:e.supportsHostUiControls)?[{id:"close",visibility:(null==e?void 0:e.showCloseButton)?1:0},{id:"share",visibility:(null==e?void 0:e.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==e?void 0:e.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==e?void 0:e.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==e?void 0:e.copyLinkEnabled)?1:0},{id:"conversation",visibility:(null==e?void 0:e.conversationButtonEnabled)?1:0}]:void 0,language:n.uiCulture,hideHeader:null==e?void 0:e.hideHeader,hideAppLauncherInHeader:null==e?void 0:e.hideAppLauncherInHeader,hideSearchInHeader:null==e?void 0:e.hideSearchInHeader,hideMeInHeader:null==e?void 0:e.hideMeInHeader,hideChatInHeader:null==e?void 0:e.hideChatInHeader,hideWorkflowInHeader:null==e?void 0:e.hideWorkflowInHeader,hideSettingsInHeader:null==e?void 0:e.hideSettingsInHeader,showAppIconInHeader:null==e?void 0:e.showAppIconInHeader,useNeutralColorInHeader:null==e?void 0:e.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==e?void 0:e.openLinksInNewWindow,contentAssemblyMode:null==e?void 0:e.contentAssemblyMode,showNotebookList:"1"===(null===(c=null==i?void 0:i.additionalApplicationParameters)||void 0===c?void 0:c.shownotebooklist),enableMobileViewer:"1"===(null===(d=null==i?void 0:i.additionalApplicationParameters)||void 0===d?void 0:d.wdMobileEmbedOneNoteViewer),mobileEmbedView:"1"===(null===(f=null==i?void 0:i.additionalApplicationParameters)||void 0===f?void 0:f.wdMobileEmbedOneNoteViewer),showBreadcrumbInMobileView:"1"===(null===(v=null==i?void 0:i.additionalApplicationParameters)||void 0===v?void 0:v.wdMobileEmbedOneNoteViewer),showInternalFeedback:"1"===(null===(h=null==i?void 0:i.additionalApplicationParameters)||void 0===h?void 0:h.wdNotesInternalFeedbackEnabled),embed:"1"===(null===(p=null==i?void 0:i.additionalApplicationParameters)||void 0===p?void 0:p.embed),embedded:"1"===(null===(m=null==i?void 0:i.additionalApplicationParameters)||void 0===m?void 0:m.embedded),hidesections:"1"===(null===(w=null==i?void 0:i.additionalApplicationParameters)||void 0===w?void 0:w.hidesections)}}}},7493:function(n,t,e){e.d(t,{OV:function(){return a},W8:function(){return s},r_:function(){return o},vY:function(){return u}});var o,i=e(9029),r=e(2172);function u(n){var t,e,i,u,s,a,l,c;void 0===n&&(n="");var d=r.qj.isOwlFrame?null===(i=null===(e=null===(t=null===window||void 0===window?void 0:window.performance)||void 0===t?void 0:t.getEntriesByName)||void 0===e?void 0:e.call(t,o.OwlFrameTimeOrigin)[0])||void 0===i?void 0:i.detail:null===(a=null===(s=null===(u=null===window||void 0===window?void 0:window.performance)||void 0===u?void 0:u.getEntriesByName)||void 0===s?void 0:s.call(u,o.OwlHostTimeOrigin)[0])||void 0===a?void 0:a.detail;return null===(c=null===(l=null===window||void 0===window?void 0:window.performance)||void 0===l?void 0:l.getEntriesByType)||void 0===c?void 0:c.call(l,"mark").filter((function(t){return t.name.startsWith(n)})).reduce((function(n,t){return t.name!==o.OwlFrameTimeOrigin&&t.name!==o.OwlHostTimeOrigin?n[t.name]=d+t.startTime:n[t.name]=d,n}),{})}function s(n,t){var e,r=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],u=(n[o.OwlBootAppMessageSend]||n[o.OwlBootAppWithCustomFunctionsMessageSend])-r,s=t[o.OwlBootAppMessageReceive]||t[o.OwlBootAppWithCustomFunctionsMessageReceive],a=t[o.OwlOnBootComplete];return{hostTime:u,frameTime:a-s,totalTime:a-r,owlPerformanceTimeline:(0,i.pi)((0,i.pi)((0,i.pi)({},n),t),((e={})[o.OwlStart]=r,e[o.OwlEnd]=a,e))}}function a(n){var t,e=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],r=n[o.OwlOnBootComplete];return{totalTime:r-e,owlPerformanceTimeline:(0,i.pi)((0,i.pi)({},n),((t={})[o.OwlStart]=e,t[o.OwlEnd]=r,t))}}!function(n){n.OwlBootAppMessageSend="owlBootAppMessageSend",n.OwlBootAppMessageReceive="owlBootAppMessageReceive",n.OwlLoadedMessageSend="owlLoadedMessageSend",n.OwlLoadedMessageReceive="owlLoadedMessageReceive",n.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",n.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",n.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",n.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",n.OwlStart="owlStart",n.OwlEnd="owlEnd",n.OwlHostTimeOrigin="owlHostTimeOrigin",n.OwlFrameTimeOrigin="owlFrameTimeOrigin",n.OwlWacBootStart="owlWacBootStart",n.OwlOnBootComplete="owlOnBootComplete"}(o||(o={}))},4415:function(n,t,e){e.d(t,{C:function(){return r}});var o=e(6823),i=e(4320),r=function(){function n(n){var t=this;this.resolve=function(){null==n||n.ULS.sendTraceTag(507586270,o.W.uo,i.G.Warning,"DeferredPromise.resolve() called before resolve function was set")},this.reject=function(t){return null==n?void 0:n.ULS.sendTraceTag(507586269,o.W.uo,i.G.Error,"DeferredPromise.reject() called before reject function was set. Error: ".concat(t))},this.Wo=new Promise((function(n,e){t.resolve=n,t.reject=e})),this.Wo.finally}return n.prototype.then=function(n,t){return this.Wo.then(n,t)},n.prototype.catch=function(n){return this.Wo.catch(n)},n.prototype.finally=function(n){return this.Wo.finally(n)},n}()},374:function(n,t,e){e.d(t,{d:function(){return i}});var o=e(9029);function i(n){var t,e,i={};try{for(var r=(0,o.XA)(n.entries()),u=r.next();!u.done;u=r.next()){var s=(0,o.CR)(u.value,2),a=s[0],l=s[1];i[String(a)]=l}}catch(n){t={error:n}}finally{try{u&&!u.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return JSON.stringify(i)}},469:function(n,t,e){e.d(t,{Th:function(){return m},Y$:function(){return h},aE:function(){return p},bM:function(){return c},gG:function(){return v},k$:function(){return f},o4:function(){return o},sj:function(){return d}});var o,i=e(9029),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,s=/http[s]?:\/\/d\.docs\.live\.net/,a="https://graph.microsoft.com",l=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function c(n){if(!n)return"";try{return decodeURIComponent(n)}catch(n){return""}}function d(n){return n?n.substring(0,n.lastIndexOf("/")):""}function f(n){if(n&&n.length){var t=n.match(l);if(t)return{href:n,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}}function v(n){if(n&&n.length){if(n.match(u)||n.match(s))return"OneDrive";if(n.match(r))return"SharePoint";if(n.startsWith(a))return"Graph"}}function h(n,t,e){var o=n,r="",u=!0;for(var s in t&&(o=(0,i.pi)((0,i.pi)({},t),o)),o){var a,l=o[s];if(!e||"object"!=typeof l&&l||"object"==typeof l&&l&&l.uriValue||"number"==typeof l||"boolean"==typeof l)u?u=!1:r+="&",a="object"==typeof l&&l&&l.uriValue?l.uriValue:encodeURIComponent("".concat(l)),r+="".concat(s,"=").concat(a)}return r}function p(n){if(n&&n.length){if(n.match(u)||n.match(s))return o.OneDrive;if(n.match(r))return o.SharePoint}}function m(n,t){var e=n.toLowerCase(),o=function(n){var t=f(n);return t&&t.hostname||""}(t),i=function(n){var t=n.toLowerCase();return!t||t.startsWith("http:")||t.startsWith("https:")||t.startsWith("mailto:")||t.startsWith("sip:")||t.startsWith("tel:")||t.startsWith("im:")?t:"https://"+t}(o),r=d(t);return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"/"===e.charAt(0)?"".concat(i).concat(e):"".concat(r,"/").concat(e)}!function(n){n.OneDrive="Documents",n.SharePoint="Sites"}(o||(o={}))},1541:function(n,t,e){var o;e.d(t,{T:function(){return o}}),function(n){n.Excel="Excel",n.None="None",n.OneNote="OneNote",n.PowerPoint="PowerPoint",n.Visio="Visio",n.Word="Word"}(o||(o={}))},1480:function(n,t,e){function o(n){window.performance&&window.performance.mark&&(Array.isArray(n)?n.forEach((function(n){window.performance.mark(n)})):window.performance.mark(n))}function i(){var n,t,e;return(null===(t=null===(n=window.performance)||void 0===n?void 0:n.now)||void 0===t?void 0:t.call(n))+(null===(e=window.performance)||void 0===e?void 0:e.timeOrigin)||Date.now()}function r(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(n){}return Date.now()}e.d(t,{a:function(){return i},eR:function(){return r},l5:function(){return o}})}},r={};function u(n){var t=r[n];if(void 0!==t)return t.exports;var e=r[n]={id:n,exports:{}};return i[n](e,e.exports,u),e.exports}u.m=i,u.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(t,{a:t}),t},t=Object.getPrototypeOf?function(n){return Object.getPrototypeOf(n)}:function(n){return n.__proto__},u.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);u.r(i);var r={};n=n||[null,t({}),t([]),t(t)];for(var s=2&o&&e;"object"==typeof s&&!~n.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(n){r[n]=function(){return e[n]}}));return r.default=function(){return e},u.d(i,r),i},u.d=function(n,t){for(var e in t)u.o(t,e)&&!u.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},u.f={},u.e=function(n){return Promise.all(Object.keys(u.f).reduce((function(t,e){return u.f[e](n,t),t}),[]))},u.u=function(n){return"owl."+{36:"hi-in-owl-strings-json",98:"sd-arab-pk-owl-strings-json",399:"lb-lu-owl-strings-json",666:"sr-cyrl-ba-owl-strings-json",712:"ga-ie-owl-strings-json",856:"gd-gb-owl-strings-json",921:"zh-tw-owl-strings-json",1e3:"el-gr-owl-strings-json",1029:"sl-si-owl-strings-json",1102:"ms-my-owl-strings-json",1105:"ca-es-owl-strings-json",1133:"be-by-owl-strings-json",1350:"bn-in-owl-strings-json",1406:"ca-es-valencia-owl-strings-json",1489:"et-ee-owl-strings-json",1532:"uk-ua-owl-strings-json",1608:"nl-nl-owl-strings-json",1635:"es-mx-owl-strings-json",1771:"ne-np-owl-strings-json",1791:"ar-sa-owl-strings-json",1825:"kk-kz-owl-strings-json",1993:"kok-in-owl-strings-json",2046:"ta-in-owl-strings-json",2129:"quz-pe-owl-strings-json",2281:"ur-pk-owl-strings-json",2289:"ha-latn-ng-owl-strings-json",2394:"te-in-owl-strings-json",2772:"ro-ro-owl-strings-json",2792:"pt-br-owl-strings-json",2811:"km-kh-owl-strings-json",2855:"pa-in-owl-strings-json",2902:"lt-lt-owl-strings-json",3041:"fr-fr-owl-strings-json",3075:"en-gb-owl-strings-json",3102:"cy-gb-owl-strings-json",3247:"da-dk-owl-strings-json",3268:"id-id-owl-strings-json",3395:"tt-ru-owl-strings-json",3622:"lo-la-owl-strings-json",3648:"handlers",3787:"qps-ploc-owl-strings-json",3872:"ky-kg-owl-strings-json",4051:"fi-fi-owl-strings-json",4144:"ja-jp-owl-strings-json",4335:"it-it-owl-strings-json",4525:"kn-in-owl-strings-json",4628:"mk-mk-owl-strings-json",4654:"fr-ca-owl-strings-json",4809:"tk-tm-owl-strings-json",5167:"af-za-owl-strings-json",5383:"as-in-owl-strings-json",5467:"nn-no-owl-strings-json",5760:"fa-ir-owl-strings-json",5848:"mi-nz-owl-strings-json",5874:"am-et-owl-strings-json",6099:"si-lk-owl-strings-json",6233:"vi-vn-owl-strings-json",6251:"sq-al-owl-strings-json",6338:"bn-bd-owl-strings-json",6664:"cs-cz-owl-strings-json",6727:"hr-hr-owl-strings-json",6774:"nb-no-owl-strings-json",6795:"hy-am-owl-strings-json",6798:"bs-latn-ba-owl-strings-json",6832:"tr-tr-owl-strings-json",6974:"pl-pl-owl-strings-json",7e3:"sw-ke-owl-strings-json",7027:"chr-cher-us-owl-strings-json",7332:"or-in-owl-strings-json",7335:"mt-mt-owl-strings-json",7447:"zh-cn-owl-strings-json",7610:"ml-in-owl-strings-json",7681:"ka-ge-owl-strings-json",7805:"az-latn-az-owl-strings-json",7986:"sv-se-owl-strings-json",8102:"es-es-owl-strings-json",8217:"gl-es-owl-strings-json",8225:"bg-bg-owl-strings-json",8253:"hu-hu-owl-strings-json",8294:"prs-af-owl-strings-json",8342:"ko-kr-owl-strings-json",8361:"fil-ph-owl-strings-json",8438:"en-us-owl-strings-json",8507:"ru-ru-owl-strings-json",8530:"sr-latn-rs-owl-strings-json",8660:"gu-in-owl-strings-json",8692:"ug-cn-owl-strings-json",8793:"pt-pt-owl-strings-json",8904:"eu-es-owl-strings-json",9054:"lv-lv-owl-strings-json",9173:"th-th-owl-strings-json",9264:"mr-in-owl-strings-json",9275:"de-de-owl-strings-json",9355:"qps-plocm-owl-strings-json",9545:"he-il-owl-strings-json",9660:"mn-mn-owl-strings-json",9729:"sr-cyrl-rs-owl-strings-json",9743:"sk-sk-owl-strings-json",9754:"is-is-owl-strings-json",9779:"uz-latn-uz-owl-strings-json",9894:"qps-ploca-owl-strings-json"}[n]+"."+{36:"08015b9d7f44c1be93fc",98:"d0b93bea6a8eb17fbd8b",399:"d212938cacf4f576c30f",666:"cb4dbd481a4cbb987514",712:"44bb4588b563a46c1eda",856:"1503371adb35fd81b50c",921:"67a09fd49c5b99d67dfd",1e3:"6e83c2551d69d4d08c0b",1029:"86433ec45bdaf889e19e",1102:"be1c5c1a4adefb27f10d",1105:"8b39233745df58383158",1133:"428efd42b709ef29c676",1350:"e2fc5c021337dbfdb099",1406:"a4850d2c3155701d2034",1489:"c3c364f9de413bf12c6f",1532:"47449b80079f0b4404eb",1608:"4134a840fd435fd34e02",1635:"d262eaed8ac980ce7434",1771:"793fa1b22ec0ad76d915",1791:"c02f202fc344d20f31c5",1825:"6169dfcc9f17040ab4f2",1993:"bee7e57e4e45096691b9",2046:"1543fb82b2c5fc1e8011",2129:"e9d8fea6379518c2f0a4",2281:"923f4280168eb2602550",2289:"4242de05354517bcf62a",2394:"bc6e2550ae04e7977b79",2772:"f3a0162eced55cf4f89b",2792:"dfde60888bb68e420067",2811:"0f2ba27f011079e78e7f",2855:"8489e05ee25e3441aade",2902:"4a1cd4284ad29c27a092",3041:"33d6454d96402c1f9813",3075:"9c61073d8fb53737ea7f",3102:"2b6c402d6bf619fa61cb",3247:"2cb48e460c2344218cc9",3268:"37ae6f1e73d51ba44230",3395:"a90ec0965f1e008a73c6",3622:"fdbe5579bb07d819ac15",3648:"1346ad65df8b879e6574",3787:"582722f8917ba2b78ef9",3872:"71a658b43a2593fd0ecf",4051:"430b237acfd06f0747e9",4144:"0c26c67b68418b37db31",4335:"d49e799346a931037751",4525:"ebd08896ddcc5bad6411",4628:"7737188a1bb62a0275b0",4654:"6362e6e34af21d5bd113",4809:"bd187472756827a87c16",5167:"e6a7c5d8c8088009060b",5383:"2308c97046b2063f82e0",5467:"a3a1f888855abfc0c2a0",5760:"0cb2c123d32008c09131",5848:"9545fad683f1074f8604",5874:"e8b3f13180fb1b31d1be",6099:"80acc693991e953851b2",6233:"b69a4cac13ee0576ecf1",6251:"1a4ff5e48af69f848b98",6338:"3c29c3612a3175383492",6664:"67dd01e5ac16f9d18cd2",6727:"65dbebd7b04b318a1f1d",6774:"b0011ca7e6cecab630e2",6795:"6b57fb8c6dd6a77fbc08",6798:"ff9fd6787aa68a0e89ed",6832:"bcc9f8ef2080be8d16c8",6974:"40dae672e0c157fd3d6d",7e3:"bfa049a6f97e0e3ae034",7027:"0d119198d7ea531d0d58",7332:"fc41f3cdfb2a6a28217e",7335:"3bbb362f9a55a60601e6",7447:"b96634c440cddb51190e",7610:"2994eea54657f0493099",7681:"645ccfc5c76f930a67f3",7805:"18462b30bfac58b71c95",7986:"d5fae7f0076ed073adb5",8102:"73129d2f67f14c335f85",8217:"4e75c299f19ab8c32a44",8225:"0abff3acc5812b257c95",8253:"6137dbd913df212f0976",8294:"0ab112e12780893b836d",8342:"332cde542bac01e533af",8361:"e3c33d8e93482ac985cd",8438:"461814452c05e3c97926",8507:"440d5eb78bafca0b6481",8530:"735336668185330e7bf5",8660:"529714e39354eeb1a297",8692:"71650365ba8b969d2c6a",8793:"733447c36e36b1eca85d",8904:"f792f9cfcb0d9a267db0",9054:"b9a2be87b92f217c6cc6",9173:"25fa950b93edbe0d7f4e",9264:"904dc006039c6313e064",9275:"d40783546a3e580c6e44",9355:"9e1089daf90ce15ea94e",9545:"4b454b29d3e0e5ae1a42",9660:"102fe2e09c7ce1512dfa",9729:"5d8e21b3bb672ed0cb57",9743:"a49bd6ec8428a6d440fa",9754:"a3e0fb99f67e0dbf3867",9779:"438f85ccddd0158e4777",9894:"f05387399bca7bb09148"}[n]+".js"},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),u.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e={},o="Microsoft.Office.OWL:",u.l=function(n,t,i,r){if(e[n])e[n].push(t);else{var s,a;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==o+i){s=d;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,u.nc&&s.setAttribute("nonce",u.nc),s.setAttribute("data-webpack",o+i),s.src=n,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),s.integrity=u.sriHashes[r],s.crossOrigin="anonymous"),e[n]=[t];var f=function(t,o){s.onerror=s.onload=null,clearTimeout(v);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(n){return n(o)})),t)return t(o)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),a&&document.head.appendChild(s)}},u.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},function(){var n;u.g.importScripts&&(n=u.g.location+"");var t=u.g.document;if(!n&&t&&(t.currentScript&&(n=t.currentScript.src),!n)){var e=t.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&!n;)n=e[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=n}(),u.sriHashes={36:"sha384-AkpUJvJCOd2vByq1HU40gFA0BTEc06bh28PhZH9rDQ2UILdLNbDafnUnoHLPRfZq",98:"sha384-qYGotODNWImNHfo9DDU7Tz9OKfJajxPD/bwDD1I1snWUkYRnb8o1XfxQ2B77wHE3",399:"sha384-DiKOhlWh67ZoiG25qEzF+T1GurQwAJxvuw5vZ0vG6Wy5XTO7K1RNFJocc3HXAblt",666:"sha384-SmqMUavtZfgeh/bxZDZHaKq1Y5gkO26spXR+oUTRPPkowwHmhR0WrSWQrP0zLnCp",712:"sha384-N9InZN4WuJbU+ekpiPr7jWwse7IPf2uB7U+vYPDg2AK6/SdlDBAfidqDKH1if/e/",856:"sha384-PtMvQVdsR3mp26Gu/+N+Xfa69knjeGGeMau4S/JRZVbNOZ2pQf6XLrYI54TpV/zm",921:"sha384-6K1hINAK34TjCD3om3QtEZoOLTLalwKf+FacHI4N3YlVpJS8pla7o+fkrKitLjy+",1e3:"sha384-XOOWDEaJiPXZS6GHG9+AQWas7vPas2bx2IUWCy3+XpC5u9HkTkjTtDaGqgGMzbwD",1029:"sha384-IEWalH+pfv99rBO3EotMMYG/2eGsn99ZvBjOQKQ5Zi6cslsov+M7+P2Pdkcvb8B5",1102:"sha384-bxUri3l0J3FWcUZtG5p7xS2LfpJ0mzidHrLz0hhkjPyDSGSa4vBq4whCkofj+8nZ",1105:"sha384-vn3wXMlwh62KyUGLQ4G2FYKUevCTlkaxbcJfJmyfmQ6jTn6OvWYZIBMda2g7wXZW",1133:"sha384-cuMKZKzg4aJ4/TEI3uE4N6hqcXNz32lUfCS6PXdMuqEr/9rpSmWNXl8WZVt89zb2",1350:"sha384-siBOb8w8EhzMsXw139h5HBgI1/nnrjDKEMUWOJMJeE1qd7M699aMG1g7e6Zqrt5E",1406:"sha384-jSPtO42PS1E7m6aMMYNYd0nwLDjEJ9U54CKiwpQYyKjbNJ+10YJJXBXDTBCS9cqZ",1489:"sha384-XqT+dd3TYb3EMC6TTdjZxWcjw561M0DqzBnmY0oi39AP0qNwVx0qHa+H1w7pM0+9",1532:"sha384-y/01sCtAMLMvlePN1brHCobKnOIxQndIGC23W+CVudcNRLMRkPRbIiNunF4djhci",1608:"sha384-I8RbPhWQbU/7jxAmDHjEJGps8DxfIzGt2PsJ389zCggOiQbGqblFYfMj8hvfEvXc",1635:"sha384-4yDVKeKcoWXiCdYs5UJviNjpOeYtAOj9GhlxIdSo90HEUaDq7oWlphRDd07VdJvX",1771:"sha384-Gg9CM3A4Hl+00IrBN4ZqQOeZkqIJtokrMnooaeVnPfDn9/qHJJMbne6gykFFNcPM",1791:"sha384-9H1GI0OHpso5MoaxcaO+/MmRlgGAkyAP1JEf/4mRAq63Ut4Mzo4pbvILt+vTJqwY",1825:"sha384-faAlBNbif7V0FVsQmoKUxOdjCLbxOK6lafuEBD2sEdKISuPLLJGFjv2PHxRKO/Bv",1993:"sha384-BXEnIp3URoWcIA2GVBss9h/FzOYaKxRH+0CpUERoPetmPNyputEe8w3AgNcjGc3J",2046:"sha384-zi7whRpqgEPKBzC5A9gp46qPTot1Ynms6ecmTXBh0QvFvVv+RpaGp8/PQ+ssXc0r",2129:"sha384-MkIjYR7v2d6s1Lzs5yknQS1X0Jixq2MCBvEr+O+ALnjyucDZk+Ek8cEZpPodtAF6",2281:"sha384-nw0KNs+kgcuLG/c89iTaOVt+2mKV1k+OooELGGQdKH766LgZBwtfWWIet8kH/e4I",2289:"sha384-oms2kO1HePM+PTLM7iHvMpO1EJLmEqGl6M9yjfaVmFiqjRMHmQv9SrtFTOSgQTvM",2394:"sha384-E5YtPTv2qhQO8HAjBjmWAcMEgojSppyR0JsYACFK4YO8Tya1OHmfQeSRAJraEmWJ",2772:"sha384-ZAcvPolsywRK5RZ1VIZ4KqHETc2HzPqxLA/tYzD7PUoHMDm+iBAnqN2C5A12b3v/",2792:"sha384-DKDKCJKrdS5dxDkQ0r5JEot0p4k+Jn21xZHo03gpP4MEbhweIhtjSytFG89Rr4fX",2811:"sha384-r8qFT6VKXeF7c3fuVrwZhIV1qmPJxeF9q2h5hgwL/G7v1+vhjYvra9hbPfQ7+l1Y",2855:"sha384-l7pZXGvwO2TNfnev65v5yqeYvVe/zMLp3lY3zGH8uLjFrf7qE8OHnUoST39V6Bql",2902:"sha384-L5G7jtQzxG2PgheSCLu8mgGipQ1QdEO2Ise+5qxltyMk6NB8/P3Y5j4pf9y2y+AL",3041:"sha384-Umqw59aC8s81wZUmjhuRZeE1pTgS2eR4u1PGFN3IvkdcXFo0mJ2xkRPn910y00iJ",3075:"sha384-ZoPOG6QDh3vwGWurHX/4QvBYAtNm2O3vYf58W+cT25H0/mPkSC5+7xLTAFxYNUza",3102:"sha384-bhIxGbPfYPS7H/lzrQ3f8ncM/Yc0Y70y4Vb4PmmdH9mrWCGsPBpejmgmlfYUlGVK",3247:"sha384-NsXLvIZ7w6xtpXCriCnA4km8HHQ4RmHdkT+WBnypDy7GIEFxyfa/NxLs0jj+9urM",3268:"sha384-M2i9oTbHxUAtIiWpwRdTe3izVyAR8nX6j/7uZqDlRiCuFmkQC4L4DwWx54z1n5EU",3395:"sha384-6ZuoXQ+XqFCbGwtDcLMmdjPVYuL5OXb6H4KEKp1SomwZIrsE7v/HacdzFHnWKvci",3622:"sha384-dn2N1P+4rEbfrRNeiAqOB3SJKOH/nWh39z/6CAgSi78pMhJDS+hHpV4y88njNqez",3648:"sha384-95LoWfp2WdEUUyf5UkYt/0Iq7M9d49wzhUvfaoS0dA+Yuu/e11mX35eGnQFj3w6G",3787:"sha384-86C9OcOE3ivI633lPY2jhvRmv7RaMWHCRRUtH4VTRvQ21mx5sa4/BEM3n+P1f4Qi",3872:"sha384-l9rsphJxfyFGPJNFbG/vXRE64MIXpwF7FWKNM3UZVEb/jipob+PPuoojShW1s4Q0",4051:"sha384-T7WWzdKMteSaIYLDxJt2VpAxLbgY1dP65Gc5KQuFdWKqVY0U1UPafy9T1DddhAsC",4144:"sha384-MTEV5C/OrcjKB104BMyDPCwS5QwmPaRNCKhosQRTUx1U8RmTufXLWxOSE0jxFwza",4335:"sha384-w5JfAWzJwfzkqZrP8vyuhF53YuQylvpVvPWnN6Nc9HzwFPQ3A+7mpCSRDyQm7ni8",4525:"sha384-4KAVvUDjNf2E2oD1rgXSEEYMzJ7bFud9drRXyNT7zJMNXtH0p3/mbQGh+R6G3hus",4628:"sha384-UmfyeuXGVv8yQ/XNnuQwO88gHbh7ax6XZ8JPrNoF6F7xhwkSDD1gm+SEePN97NZk",4654:"sha384-RQ2Alp663KSWN8eyWiFBHvsO6PGKOvJKWlelLwYriYpViSG7ZZattmRNcSJaGAjg",4809:"sha384-mEIEdX4/W84kO66eCieg/SBL+AGE31BkIwxy0AE3lZV8wbPpohR8z24iaz0D6x2b",5167:"sha384-7/4xK8Ipib+nnezLLBed2XVanMESFIt5akGEdty+8KyG2DNGKjDkCC+tj3AIIAns",5383:"sha384-6PhEEaAG5Jfrx3KC/nizXLQFlbE+e3uas6rZnrvlRvTM7XTBYVRWNIe5UdYof1eP",5467:"sha384-0HsKhiwCWTG1f1uRs7yT24XIQMZnPyxju4Oisqxl2sCh65HDh8rOAd31H3u7elLc",5760:"sha384-xBtP6jk0qR3LPxz2lIwa/zmm9iWqyjAiHwONDTJY/y3nDseSVtj1ucI0WxDWkQa1",5848:"sha384-OKHGyx1twxV1A7isNehnXID5TjLMUwSwQ7xDQjQ1uruVFkffBUVCylrrENZhQOpt",5874:"sha384-SVOz9rljFWq66ZqnBTOJzJeO181+dGMt98KwS+kxlswwnXVHrSKZyFQX37/kqK8x",6099:"sha384-JLdXOmALO6VWnrVTqNYtq8G0yD8k0wo8f7aOKkv1uWB+/oWg1WcVCYvkG8uqCAtN",6233:"sha384-cmPoRK9m2BBlb1rp/3chkvuXjJtyRdjHqilK0ZYfGbBFdG2f+ORcRxCrGV64zdup",6251:"sha384-aYF9uX0KzSl7cgZ5F8voZYYIONiDFJnTLMPlgO+WvvQNDFl+GppdlJuNJjyQ652p",6338:"sha384-VyobKxh6ii2+5h2as1+Zw6xLFCO+Na5r6FIk46xgq+ZgainFxiZG6mBtu4a5V0x0",6664:"sha384-c+U3e+FSn5Vfx2EQSLH8Ddovq857rJwW/4fJdPdupQIRQdPDEoTUED/fgCss1bXi",6727:"sha384-5bVHw+dM3esMCfS6U6idBSucAeVqoBgGVQx2eGJ2HNd1jPFK4wLAC6RjginCMqdq",6774:"sha384-B4NCNrfOrwZXOHMifS8YaREheH6e7OD9VhDl/UrUaR67LWk7sRbL+n+rAvFqTbnS",6795:"sha384-39ZCsRJwiZbAQ9VdCVcXXiRlfgN0mQcFJ8oqcW6dMox1R20LTM9z+iTgeSrAnxGv",6798:"sha384-o88JAnCoMMqJDoITSwt5rZspnWXc8piCev0VDWvCo5Be6IyHY7cqqN0QQyOHB8Hs",6832:"sha384-/dVahuZ5II582hH/ii6RvsV/MxQ/0mJk/Oi5eUMC+aSPhjcQO/mZGnnM78bznScs",6974:"sha384-yL3XfpS9rykRwsJypeXGKG0K8YH8WEWpffSUYs2COF9b9RDnoj8t1zCwXXsvInTe",7e3:"sha384-b+JHbzGrb2P/AQhP667o8rCExPcXJ50oJyiWLKC4HTYYnLyT4odRLMUWEAira5Bw",7027:"sha384-RvqGitxinuXyguMpnskdqNbL1u8SmeqXzHY3uyVWSLt3DQKDIPsh3Nvj8kCqMYcH",7332:"sha384-sgYYCKtcMSKaWCfpw2Preu+kxOhIuR0BRMTib71D1zLoyPYncTDp+fbVbxjgbrHO",7335:"sha384-9r1AgOXdHEkW8cMSJMcL8C9n74mO0dipLI3rRBHW9jaZFxlPS92Ede3Xgz8uuM5a",7447:"sha384-TegfJc/cTV1fM3lhiIX501cO1XcFmT8b9u2MjxREcfPZeTrqdEn9Xfptfr8IOqdu",7610:"sha384-ow9Qp+hQng3sD6awqFsJTlwtfOHo4/vz/9qiyE+lp6QyhVxoOGwjjYp8bCMbth52",7681:"sha384-H2mDdteN0+uS9RlNx8ckfV/RfxR1/y6bR72DHxEq5lje46tAnFlz8im1/tW/6poF",7805:"sha384-JX9xoy39V5HXC2jp1mc6wv2aUnni5uCmSUX1YW5K0+jCohW6nBZ2z22as6HzNeZ5",7986:"sha384-O6xBy9Gp/Dt0BydUR1W9F8+JIlqaIleIzwpeOLJrwBWeig/iobo9NZXigFQHIGSV",8102:"sha384-ggsg/idEvhegx0lXDzYwvvAJMlTUqKNr4tFBV+1ukTpdjQKjyRM/t/JiKyjx6Imw",8217:"sha384-mprAq7iizmv4bC74jqkR+42wNAja83SyZixuCXjHTDz+0jjuDLkmsHZmUdd23puV",8225:"sha384-ya7K7g7pIbCgcjSxLA+FOzc22mWfDbXafJRmzNKeBjAsile/ocBG0L0FWrQJfI3g",8253:"sha384-fogANTUdq79m5FtzmWGE3QylRZpZ+B2HzvTdy/wDLuSWX6K4EAtFq328blmZveeq",8294:"sha384-Ynup7uXCGgFWy36hFBbD60ArtuTqyZ/qaS9+NzgrEe3mnUrTtWSuoKmmwO5RtR7I",8342:"sha384-5cSRatX2EiNqlNiTgApcAewlCjAV0NIqTbacdhT6r5FjUFbmenXHmSxUzVWq0Coe",8361:"sha384-+AcBxJzSrpxcqqLpU7st5n/gqGViA2/X98wH9JmQYP9G/wW0ucP3i/6pXZtlCTfz",8438:"sha384-Z4qT4hMNKkObzLXqtNf8W/e2NBLxku8ynDqGLEI1ocW/TjudP0YKBShCp/cxpesj",8507:"sha384-3bxyyutB7DmVfznIA/2erllnPVf4J8Q0KTXKJXl48j8+glmB/s65R2x/wj9ouMhC",8530:"sha384-3gwsr/vYJMlMc9B5C6CbnYs423WprRmVbVqzEVg+z5FbukeBxKzccptEYg9H8D2e",8660:"sha384-KJW9pXyUVPBwGKNc1/XnZeunDCUs7lMirk0ijwPqxUGY6IMnyqus4+jz9urxRQeR",8692:"sha384-50tyC1o9j5mheCVK39YoRrohcHEHx2ckPxZ5YMwhVC2cz+6Dvg4K3Rk087jdPNQc",8793:"sha384-pgCDeWpiUdXQW5L9srxjv7pz0SXdpMLm7asyX1aO0MI2CZLC00xQKRhSbbOVJyiY",8904:"sha384-XAeGQ3n113BiJLqVSCHsU8s00cdFCm2pEJls9BOV4Sl5CcMYtQ3yfuAns+85S+oE",9054:"sha384-HEUb+Y4EZab8JY88WcgE+uf6Z50Ik5ttJJ89jiFGV28E1vL55xpwAEX8KHqU4KjK",9173:"sha384-QKp39RjM51kEJiQrPczbBzTHbiRvi8w1Q2vcgC4m5zFqEqKGDRQncg2M7k6mzjFq",9264:"sha384-HZh8doWPeDvoahT7ESilejLEqPQ9GeiupkLA0hdmFghlNN3YmSKPXiGBxCNKDB+1",9275:"sha384-0WqIYX7kofzdZz65mtgk/jBhwiHJx/8XVQXpZyD7F2jrHhmziy5l/LrS8+7L/V/V",9355:"sha384-HOa3k+prwS9oODIforoUinZgRZNGCX1OgF09WHGQ0Nd36Je3LR+0FRzM6rIx+oY6",9545:"sha384-V4GNWh9Meu94G7OGu7GNu5SdetB2t+hntzHLezzl7jns4qZ3iZXKspCBp2hRZqn3",9660:"sha384-DuU4GTc4fDwcYWCG64FtYh31sIeYb4Toy29PSF+QY66UdlSDEuIJvD0FelucPFzJ",9729:"sha384-vU+837Ecq9pCTqTQmik9CXTT9w6FWnR1e4HUbDn6OlhTNtO7koKyLhXcl9YWijb7",9743:"sha384-ppf9z/DUa7o3Cze1DpM7vxcbiqfNEh29ZFnHgHchMTW5dcsOCwfWPVloNIsR7XhU",9754:"sha384-8SsnWHyFPk9cgJE7vyScRM9dnL7/UGOLheTOnzrXmSiPUwsSm8DsBMEErVfGrrcv",9779:"sha384-tdAzkkRHlHHIJ+cg3WKELQVWQU9/KXCcVVZNfqsSOGWvy+7BTYAmauVdyL8rOQmc",9894:"sha384-/vP3HEdgcHjD7saE2UYcZlT/WgcwxHR7gOh68OG3TAvGQ+ts6VQu3HEWsFSGun6r"},function(){if(void 0!==u){var n=u.u,t=u.e,e={},o={};u.u=function(t){return n(t)+(e.hasOwnProperty(t)?"?"+e[t]:"")},u.e=function(i){return t(i).catch((function(t){var r=o.hasOwnProperty(i)?o[i]:5;if(r<1){var s=n(i);throw t.message="Loading chunk "+i+" failed after 5 retries.\n("+s+")",t.request=s,t}return new Promise((function(n){var t=5-r+1;setTimeout((function(){var s="cache-bust=true&retry-attempt="+t;e[i]=s,o[i]=r-1,n(u.e(i))}),0)}))}))}}}(),function(){var n={768:0};u.f.j=function(t,e){var o=u.o(n,t)?n[t]:void 0;if(0!==o)if(o)e.push(o[2]);else{var i=new Promise((function(e,i){o=n[t]=[e,i]}));e.push(o[2]=i);var r=u.p+u.u(t),s=new Error;u.l(r,(function(e){if(u.o(n,t)&&(0!==(o=n[t])&&(n[t]=void 0),o)){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",s.name="ChunkLoadError",s.type=i,s.request=r,o[1](s)}}),"chunk-"+t,t)}};var t=function(t,e){var o,i,r=e[0],s=e[1],a=e[2],l=0;if(r.some((function(t){return 0!==n[t]}))){for(o in s)u.o(s,o)&&(u.m[o]=s[o]);a&&a(u)}for(t&&t(e);l<r.length;l++)i=r[l],u.o(n,i)&&n[i]&&n[i][0](),n[i]=0},e=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}(),u.nc=void 0;var s={};!function(){u.r(s),u.d(s,{bootDocumentWithCustomFunctions:function(){return ct},completeCreateNew:function(){return lt},initPackage:function(){return st}});var n,t,e=u(9029),o=u(6823),i=u(4320),r=u(9644),a=u(1480),l=u(7493),c=u(2172);(t=n||(n={}))[t.Success=0]="Success",t[t.Error=1]="Error",t[t.Timeout=2]="Timeout";var d,f,v,h,p,m,w,g,S="OwlFrame";(g=h||(h={})).FrameLoaded="Frame_FrameLoaded",g.GetAuthToken="Frame_GetAuthToken",g.BootComplete="Frame_BootComplete",g.SuccessNotification="Frame_OnSuccessNotification",g.BootFailure="Frame_BootFailure",g.ReturnFocus="Frame_ReturnFocus",g.AcquireOAuthTokenTeams="Frame_AcquireOAuthTokenTeams",g.ConversationClose="Frame_ConversationClose",g.NavigateBack="Frame_BackButtonPressed",g.OpenPageLevelConversation="Frame_OpenPageLevelConversation",g.DocumentClose="Frame_DocumentClose",g.OpenInMobileApp="Frame_OpenInMobileApp",g.FetchItemFromNetwork="Frame_FetchItemFromNetwork",g.FetchAccessToken="Frame_FetchAccessToken",g.OpenShareControl="Frame_OpenShareControl",g.CreateDocument="Frame_CreateDocument",g.SetTitle="Frame_SetTitle",g.UserActivity="Frame_UserActivity",g.CAAEMessage="Frame_CAAEMessage",g.UserAccess="Frame_UserAccess",g.MoveToFolder="Frame_MoveToFolder",g.SharedFilePicker="Frame_SharedFilePicker",g.Rename="Frame_Rename",g.FrameChange="Frame_FrameChange",g.InvokeSessionRefreshInfoPopupBlockedDialog="Frame_InvokeSessionRefreshInfoPopupBlockedDialog",g.FileEmbed="Frame_FileEmbed",g.EndSessionResponse="Frame_EndSessionResponse",g.EndSessionObservable="Frame_EndSessionObservable",g.TelemetryData="Frame_TelemetryData",(w=p||(p={})).BootApplication="Host_BootApplication",w.GetAuthTokenResponse="Host_GetAuthTokenResponse",w.EndSession="Host_EndSession",w.HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",w.GetClientUrl="Host_GetClientUrl",w.GetWebUrl="Host_GetWebUrl",w.BackButtonPressed="Host_BackButtonPressed",w.SendConversationId="Host_SendConversationId",w.PostWacToken="Host_PostWacToken",w.FetchItemFromNetworkResponse="Host_FetchItemFromNetworkResponse",w.FetchAccessTokenResponse="Host_FetchAccessTokenResponse",w.OpenShareControlResponse="Host_OpenShareControlResponse",w.CreateDocumentResponse="Host_CreateDocumentResponse",w.SessionRefreshInfoDialogHandleRefresh="Host_SessionRefreshInfoDialogHandleRefresh",w.SessionRefreshInfoDialogHandleCancel="Host_SessionRefreshInfoDialogHandleCancel",w.SessionRefreshInfoDialogOnDismiss="Host_SessionRefreshInfoDialogOnDismiss",w.SharingLinkTokenProvider="Host_SharingLinkTokenProvider",w.TelemetryData="Host_TelemetryData",function(n){n.Item="item",n.Response="response",n.Result="result",n.Token="token",n.URL="url"}(m||(m={}));var b=u(8692),H=u(478),C=function(){function n(n){var t=this;this.jo=!1,this._o="",this.Mo=[],this.Bo=function(n){t.jo||(t.jo=!0,t._o=n?"timeout":"cancelled",t.Mo.map((function(n){return n()})),t.Mo=[])},this.xo=n,window.setTimeout((function(){return t.Bo(!0)}),n)}return Object.defineProperty(n.prototype,"isCancelled",{get:function(){return this.jo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeoutInMs",{get:function(){return this.xo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"reason",{get:function(){return this._o},enumerable:!1,configurable:!0}),n.prototype.cancel=function(){this.Bo(!1)},n.prototype.subscribe=function(n){this.jo?n():this.Mo.push(n)},n}();function I(n){return new C(n)}var A=u(3270),U=u(7866),y=u(6012),T=u(1541),F=u(9323),N=u(857),E=u(4813),k=u(5638),P=u(555),R=u(4401),D=u(7191);function O(n,t){return function(e){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new W(n,t))}}var W=function(){function n(n,t){this.project=n,this.thisArg=t}return n.prototype.call=function(n,t){return t.subscribe(new j(n,this.project,this.thisArg))},n}(),j=function(n){function t(t,e,o){var i=n.call(this,t)||this;return i.project=e,i.count=0,i.thisArg=o||i,i}return R.ZT(t,n),t.prototype._=function(n){var t;try{t=this.project.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)},t}(D.L);function _(n,t,e,o){return(0,P.m)(e)&&(o=e,e=void 0),o?_(n,t,e).pipe(O((function(n){return(0,k.k)(n)?o.apply(void 0,n):o(n)}))):new E.y((function(o){M(n,t,(function(n){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(n)}),o,e)}))}function M(n,t,e,o,i){var r;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){var u=n;n.addEventListener(t,e,i),r=function(){return u.removeEventListener(t,e,i)}}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){var s=n;n.on(t,e),r=function(){return s.off(t,e)}}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){var a=n;n.addListener(t,e),r=function(){return a.removeListener(t,e)}}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(var l=0,c=n.length;l<c;l++)M(n[l],t,e,o,i)}o.add(r)}var B=u(9567);function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var L=x(),K=u(3140);var G=u(4289),V=function(n){if(n&&"function"==typeof n[K.L])return i=n,function(n){var t=i[K.L]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(n)};if((t=n)&&"number"==typeof t.length&&"function"!=typeof t)return o=n,function(n){for(var t=0,e=o.length;t<e&&!n.closed;t++)n.next(o[t]);n.complete()};var t;if(function(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}(n))return function(n){return function(t){return n.then((function(n){t.closed||(t.next(n),t.complete())}),(function(n){return t.error(n)})).then(null,B.z),t}}(n);if(n&&"function"==typeof n[L])return e=n,function(n){for(var t=e[L]();;){var o=void 0;try{o=t.next()}catch(t){return n.error(t),n}if(o.done){n.complete();break}if(n.next(o.value),n.closed)break}return"function"==typeof t.return&&n.add((function(){t.return&&t.return()})),n};var e,o,i,r=(0,G.K)(n)?"an invalid object":"'"+n+"'";throw new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};u(9640);var J=function(n){function t(t){var e=n.call(this)||this;return e.parent=t,e}return R.ZT(t,n),t.prototype._=function(n){this.parent.notifyNext(n)},t.prototype.B=function(n){this.parent.notifyError(n),this.unsubscribe()},t.prototype.J=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(D.L),z=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return R.ZT(t,n),t.prototype.notifyNext=function(n){this.destination.next(n)},t.prototype.notifyError=function(n){this.destination.error(n)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(D.L);function q(n,t,e){return void 0===e&&(e=Number.POSITIVE_INFINITY),"function"==typeof t?function(o){return o.pipe(q((function(e,o){return(i=n(e,o),i instanceof E.y?i:new E.y(V(i))).pipe(O((function(n,i){return t(e,n,o,i)})));var i}),e))}:("number"==typeof t&&(e=t),function(t){return t.lift(new Q(n,e))})}var Q=function(){function n(n,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=n,this.concurrent=t}return n.prototype.call=function(n,t){return t.subscribe(new X(n,this.project,this.concurrent))},n}(),X=function(n){function t(t,e,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var i=n.call(this,t)||this;return i.project=e,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return R.ZT(t,n),t.prototype._=function(n){this.active<this.concurrent?this.Lo(n):this.buffer.push(n)},t.prototype.Lo=function(n){var t,e=this.index++;try{t=this.project(n,e)}catch(n){return void this.destination.error(n)}this.active++,this.Ko(t)},t.prototype.Ko=function(n){var t=new J(this),e=this.destination;e.add(t);var o=function(n,t){if(!t.closed){if(n instanceof E.y)return n.subscribe(t);var e;try{e=V(n)(t)}catch(n){t.error(n)}return e}}(n,t);o!==t&&e.add(o)},t.prototype.J=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(n){this.destination.next(n)},t.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this._(n.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(z),Z=function(){function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n}(),Y=function(){function n(n){if(this.total=n,this.total<0)throw new Z}return n.prototype.call=function(n,t){return t.subscribe(new $(n,this.total))},n}(),$=function(n){function t(t,e){var o=n.call(this,t)||this;return o.total=e,o.count=0,o}return R.ZT(t,n),t.prototype._=function(n){var t=this.total,e=++this.count;e<=t&&(this.destination.next(n),e===t&&(this.destination.complete(),this.unsubscribe()))},t}(D.L);function nn(n,t){return function(e){return e.lift(new en(n,t))}}var tn,en=function(){function n(n,t){this.predicate=n,this.thisArg=t}return n.prototype.call=function(n,t){return t.subscribe(new on(n,this.predicate,this.thisArg))},n}(),on=function(n){function t(t,e,o){var i=n.call(this,t)||this;return i.predicate=e,i.thisArg=o,i.count=0,i}return R.ZT(t,n),t.prototype._=function(n){var t;try{t=this.predicate.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(n)},t}(D.L),rn=u(9048),un=u(8174),sn=u(2757),an=u(1599),ln=u(7541),cn=u(3242),dn=u(4855);!function(n){n.AccessibilityLoopCompleted="AccessibilityLoopCompleted",n.ActionCompleted="ActionCompleted",n.BrowserEvent="BrowserEvent",n.CAAEMessage="CAAEMessage",n.Close="Close",n.InitEnd="InitEnd",n.Conversation="Conversation",n.CopyAndEdit="CopyAndEdit",n.CreateNewDocument="CreateNewDocument",n.Download="Download",n.Edit="Edit",n.Error="Error",n.FileEmbed="FileEmbed",n.FileProperties="FileProperties",n.FileRenamed="FileRenamed",n.FileVersions="FileVersions",n.FrameStateChanged="FrameStateChanged",n.FrameTrust="FrameTrust",n.GetAccessToken="GetAccessToken",n.GetAuthToken="GetAuthToken",n.GetCustomAuthConfig="GetCustomAuthConfig",n.GetWopiInfoFromUrl="GetWopiInfoFromUrl",n.GetDavUrlFromIds="GetDavUrlFromIds",n.ModeSwitched="ModeSwitched",n.MoveToFolder="MoveToFolder",n.OpenInMobileApp="OpenInMobileApp",n.OpenInBrowser="OpenInBrowser",n.OpenInClient="OpenInClient",n.PageChanged="PageChanged",n.PushState="PushState",n.Reboot="Reboot",n.RedeemForCommenting="RedeemForCommenting",n.RefreshSessionInfo="RefreshSessionInfo",n.ReplyWithChanges="ReplyWithChanges",n.ReportAbuse="ReportAbuse",n.SharedFilePicker="SharedFilePicker",n.SaveStatus="SaveStatus",n.Share="Share",n.ShareForm="ShareForm",n.SignIn="SignIn",n.SplashScreenShown="SplashScreenShown",n.UserAccessAndPermissions="UserAccessAndPermissions",n.UserActivity="UserActivity",n.UserEditActivity="UserEditActivity",n.Workflow="Workflow",n.ZoomChanged="ZoomChanged",n.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",n.LoadingStatus="LoadingStatus",n.SwitchNotebook="SwitchNotebook",n.FailedBootCheckFileInfo="FailedBootCheckFileInfo",n.GetTeamsUsers="GetTeamsUsers",n.SendTeamsUserMention="SendTeamsUserMention",n.NavigateBackToHost="NavigateBackToHost",n.GetClientUrlComplete="GetClientUrlComplete",n.GetWebUrlComplete="GetWebUrlComplete",n.CopyLinkComplete="CopyLinkComplete",n.SendConversationId="SendConversationId",n.CloseTeamsConversation="CloseTeamsConversation",n.PageLoaded="PageLoaded",n.FrameChanged="FrameChanged"}(tn||(tn={}));var fn,vn,hn,pn=u(4415),mn=u(9823),wn=u(3755),gn="https://wise-m.public.cdn.office.net/wise-m/owl",Sn="https://wise.public.cdn.office.net/wise/owl",bn=new Set,Hn=[10,100],Cn=[1,10,50,100],In=2e3;function An(n,t,e){fn=e,vn=n,Un(t,"MSIT",Hn,0),Un(t,"PRODUCTION",Cn,3e4)}function Un(n,t,o,i){var r=this,u=i;o.forEach((function(o){return(0,e.mG)(r,void 0,void 0,(function(){var i=this;return(0,e.Jh)(this,(function(r){return setTimeout((function(){return(0,e.mG)(i,void 0,void 0,(function(){return(0,e.Jh)(this,(function(e){switch(e.label){case 0:return[4,yn(n,t,o,1)];case 1:return e.sent(),[2]}}))}))}),u+=In),[2]}))}))}))}function yn(n,t,r,u){return void 0===u&&(u=0),(0,e.mG)(this,void 0,void 0,(function(){var s,a=this;return(0,e.Jh)(this,(function(l){switch(l.label){case 0:return s=0,[4,fetch("".concat(gn,"/5mttl/").concat(t.toLowerCase(),"/").concat(r,"/manifest.json"),{cache:"no-cache"}).then((function(e){return null==fn||fn.ULS.sendTraceTag(507326861,o.W.uo,i.G.Info,"Fetching manifest from CDN was successful for ".concat(n," in ").concat(t," with exposure ").concat(r," with remaining retry count ").concat(u,".")),e.text()})).then((function(l){return(0,e.mG)(a,void 0,void 0,(function(){var a,c=this;return(0,e.Jh)(this,(function(d){if(null==fn||fn.ULS.sendTraceTag(507326860,o.W.uo,i.G.Info,"Parsing manifest from CDN was successful for ".concat(n," in ").concat(t," with exposure ").concat(r," with remaining retry count ").concat(u,".")),l.includes("<Code>BlobNotFound</Code>")&&u>0)setTimeout((function(){return(0,e.mG)(c,void 0,void 0,(function(){return(0,e.Jh)(this,(function(e){switch(e.label){case 0:return[4,yn(n,t,r,u-1)];case 1:return e.sent(),[2]}}))}))}),500);else{if(!(a=JSON.parse(l)).clientVersion)return null==fn||fn.ULS.sendTraceTag(507326859,o.W.uo,i.G.Warning,"Manifest from CDN does not have clientVersion for ".concat(n," in ").concat(t," with exposure ").concat(r,". Manifest: ").concat(a)),[2];if(!a.files)return null==fn||fn.ULS.sendTraceTag(507326858,o.W.uo,i.G.Warning,"Manifest from CDN does not have files for ".concat(n," in ").concat(t," with exposure ").concat(r,". Manifest: ").concat(a)),[2];bn.has(a.clientVersion)||(bn.add(a.clientVersion),Object.keys(a.files).filter((function(t){return t.includes(n.toLowerCase()+".boot.js")||t.includes(n.toLowerCase()+"-boot.js")||t.includes("owl."+n.toLowerCase()+".js")||t.includes("owl.js")||t.includes("owl."+n.toLowerCase()+".slim.js")||t.includes("owl.slim.js")})).forEach((function(n){var t=a.files[n];if(t&&2===t.length){var e=function(n,t,e){var r=document.createElement("link");return r.rel="prefetch",r.href=n,r.integrity=t,r.as="script",r.crossOrigin="anonymous",r.id=e,r.onerror=function(){null==fn||fn.ULS.sendTraceTag(507326856,o.W.uo,i.G.Warning,"Failed to prefetch ".concat(e," from ").concat(n)),r.remove()},r}("".concat(Sn,"/").concat(t[0]),t[1],n);!function(n,t,e){setTimeout((function(){n.appendChild(t)}),e)}(vn,e,s+=In)}})))}return[2]}))}))})).catch((function(e){null==fn||fn.ULS.sendTraceTag(507326857,o.W.uo,i.G.Warning,"Fetching manifest from CDN failed for ".concat(n," in ").concat(t," with exposure ").concat(r," with remaining retry count ").concat(u,". Error: ").concat(e))}))];case 1:return l.sent(),[2]}}))}))}!function(n){n[n.Completed=0]="Completed",n[n.Unloaded=1]="Unloaded",n[n.Timeout=2]="Timeout"}(hn||(hn={}));var Tn="officeapps.live.com",Fn="PostWacToken",Nn="owlfc",En=2e3,kn=9e3,Pn=9500,Rn=6e5,Dn=15e4,On=[],Wn=new pn.C,jn={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1},_n={};function Mn(n){var t,r,s,v,h,p=this,m=(null===(t=n.sessionConfig.bootDiagnostics)||void 0===t?void 0:t.hostPageFirstFlushTime)||(0,a.a)(),w=n.documentBootInfo,g=n.fetchItemFromNetwork,b=n.fetchAccessToken,H=n.sessionConfig,C=n.container,E=n.setTitle,k=n.onBootComplete,P=n.onBootFailure,R=n.onReturnFocus,D=n.onConversationClose,W=n.onNavigateBack,j=n.onOpenPageLevelConversation,M=n.onDocumentClose,B=n.onSuccessNotification,x=n.onDismissHostSpinner,L=n.uiHostConfig,K=n.createDocument,G=n.openShareControl,V=n.onOpenInMobileApp,J=n.sharingLinkTokenProvider,z=n.onUserActivity,Q=n.onCAAEMessage,X=n.onAcquireOAuthTokenTeams,Z=n.onUserAccess,$=n.onMoveToFolder,en=n.onSharedFilePicker,on=n.onRename,fn=n.initPackageParams,vn=n.onFrameChange,gn=n.invokeSessionRefreshInfoPopupBlockedDialog,Sn=n.onFileEmbed,bn=n.bootstrapFile,Hn=null==L?void 0:L.supportsExplicitUnload;H.logger||(H.logger=(0,A.L8)());var Cn=H.hostCorrelationId,In=H.isMsa,Un=H.tenantId,yn=H.shareApiEndpoint,Dn=H.organizationName,Mn=H.logger,Bn=H.hostClientType,Ln=H.channelId,Kn=H.health,Gn=(0,rn.ZR)(w.fileType,null==L?void 0:L.featureGates,Mn);null==Mn||Mn.ULS.sendTraceTag(576578584,o.W.uo,i.G.Info,"Lean Ui Host: bootApp");var Vn,Jn=I(Rn),zn=[],qn=function(n){return new Promise((function(t){Gn&&!Jn&&t("No active session to close. Return from here."),On&&On.forEach((function(n){clearInterval(n),clearTimeout(n)}));var r=function(n){null==Mn||Mn.ULS.sendTraceTag(575411776,o.W.uo,i.G.Info,"Dispose the WAC frame. And reboot: ".concat(n?"true":"false")),dt.next(n),dt.complete(),function(){f&&f.dispose(),d&&d.dispose(),window.performance&&window.performance.getEntriesByType&&window.performance.clearMarks&&window.performance.getEntriesByType("mark").filter((function(n){return n.name.startsWith("owl")})).forEach((function(n){return window.performance.clearMarks(n.name)}));var n=document.getElementById(S);n&&n.remove()}(),t("WAC frame disposed")},u=function(){w.fileType===T.T.Excel&&(0,an.gP)(),null==st||st.unsubscribe(),null==at||at.unsubscribe()};if(!Zn)return null==Mn||Mn.ULS.sendTraceTag(529093076,o.W.uo,i.G.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void r(n);if(Gn){null==Zn||Zn.removeEventListener(Vn),null==Jn||Jn.cancel();var s=function(n){if(n===T.T.OneNote)return I(kn)}(w.fileType);null==Zn||Zn.dispose(s).catch((function(n){null==Mn||Mn.ULS.sendTraceTag(527257879,o.W.uo,i.G.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(ot,", Error: ").concat(n))})).finally((function(){u(),r(n)})),null==s||s.cancel()}else if(zn.forEach((function(n){var t=(0,e.CR)(n,2),o=t[0],i=t[1];Zn.RemoveEventHandler(o,i)})),null==Zn||Zn.Dispose(Hn,function(n){if(n===T.T.OneNote)return kn}(w.fileType)),u(),Hn){Zn.RegisterEventHandler(cn.E_.Event_Unloaded,(function(){null==Mn||Mn.ULS.sendTraceTag(575411777,o.W.uo,i.G.Info,"Receive Unloaded Event from WAC"),ot=!0,clearTimeout(a),r(n)}));var a=window.setTimeout((function(){null==Mn||Mn.ULS.sendTraceTag(575411778,o.W.uo,i.G.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat(ot)),ot||r(n)}),w.fileType===T.T.OneNote?Pn:En)}else null==Mn||Mn.ULS.sendTraceTag(575271647,o.W.uo,i.G.Info,"No Explicit Unload. Tear down the WAC frame to end session."),r(n)}))},Qn=function(n,t,r){var s,a,l,c,d=Promise.resolve(null===(s=null==n?void 0:n.wac)||void 0===s?void 0:s.applicationUrl),f=function(){return t.asObservable().pipe((function(n){return n.lift(new Y(1))})).toPromise()},v=null!==(a=null==L?void 0:L.sessionOriginPrefix)&&void 0!==a?a:"TEAMS.UNIFIEDUIHOST.",h=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().documentRebootHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,health:Kn,getWdOrigin:function(n){return"".concat(v).concat(n)},reboot:function(n,t){qn({documentBootInfo:n,navigationRequired:!t}).catch((function(){null==Mn||Mn.ULS.sendTraceTag(512296464,o.W.uo,i.G.Error,"endSession: endSession error in DocumentReboot")}))}}),p=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().renameHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({bootedDocumentInfo:t,getCurrentDocumentInfo:f,hostRenameCallback:on,health:Kn}),m=function(n){var t=this,o=(0,e.pi)((0,e.pi)({},n),{popupMetadata:{retry:0,dialogInvoked:!1,popupOpen:!1}});return function(n){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().sessionRefreshInfoHandler(o,n)];case 2:return t.sent(),[2]}}))}))}}({hostUrl:null==H?void 0:H.hostUrl,supportsRefreshTokenReauthPopUp:null==L?void 0:L.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:f,documentBootInfo:w,fetchItemFromNetwork:g,officeDocumentSession:r,appUrlPromise:d,invokePopupBlockedDialog:gn,logger:Mn,health:Kn}),S=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().shareHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,sharePointInfo:n.sharePointInfo,shareApiEndPointBase:yn,fetchAccessToken:b,openShareControl:G,correlationId:$n,isMsa:In,tenantId:Un,organizationName:Dn,onOpen:function(){(0,ln.R)(cn.KX.PostMessage_BlurFocus,void 0,et,it,Mn)},onClose:function(){(0,ln.R)(cn.KX.PostMessage_GrabFocus,void 0,et,it,Mn)},health:Kn,featureGates:null==L?void 0:L.featureGates,logger:Mn}),I=null!=Z?Z:function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().userAccessHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,shareHandler:S,officeDocumentSession:r,appUrlPromise:d,logger:Mn,health:Kn}),A=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().userActivityHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:f,onUserActivity:z,health:Kn}),U=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().createNewHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,createDocument:K,getWdOrigin:function(n){return"".concat(v).concat(n)},reboot:function(n,t){qn({documentBootInfo:n,navigationRequired:!t}).catch((function(n){var t=(0,mn.vJ)(mn.Fh.FeatureGate_CommandingAshaVetoes,null==L?void 0:L.featureGates);(0,mn.dt)(mn.Fh.FeatureGate_CommandingAshaVetoes,t,Mn),t&&(null==Kn||Kn.recordQosError(dn.DG.QosError_CreateNewHandlerEndSessionFailure,[dn.cS.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",dn.DG.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat($n)],["Reason",n]])})),null==Mn||Mn.ULS.sendTraceTag(512296463,o.W.uo,i.G.Error,"endSession: endSession error in DocumentCreate")}))},logger:Mn,health:Kn,correlationId:$n}),y=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().getAuthTokenHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,fetchAccessToken:b,officeDocumentSession:r,appUrlPromise:d,logger:Mn,health:Kn}),T=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().sendConversationIdHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onOpenPageLevelConversation:j,hostSendConversationId:ft,health:Kn}),F=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().closeTeamsConversationHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:f,onConversationClose:D,health:Kn}),N=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().navigateBackToHostHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:f,onNavigateBack:W,health:Kn}),E=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().accessibilityLoopCompleteHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onReturnFocus:R,health:Kn}),k=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().getClientUrlCompleteHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,hostClientType:Bn,logger:Mn,openInMobileAppCallback:V,health:Kn}),P=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().loadingStatusHandler(n)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,channelId:Ln,officeDocumentSession:r,appUrlPromise:d,health:Kn}),O=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().getWebUrlCompleteHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,hostClientType:Bn,logger:Mn,health:Kn}),_=(0,an.a6)({getCurrentDocumentInfo:f,fetchItemFromNetwork:g,officeDocumentSession:r,appUrlPromise:d,logger:Mn,health:Kn}),B=(0,an.ok)({getCurrentDocumentInfo:f,fetchItemFromNetwork:g,officeDocumentSession:r,appUrlPromise:d,logger:Mn,health:Kn}),x=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().actionCompleteHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Mn,webUrl:null!==(l=n.webUrl)&&void 0!==l?l:"",health:Kn}),q=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().openInBrowserHandler(n),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Mn,webUrl:null!==(c=n.webUrl)&&void 0!==c?c:"",health:Kn,correlationId:$n}),nn=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().openInMobileAppHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Mn,openInMobileAppCallback:V,health:Kn,correlationId:$n}),tn={appUrlPromise:d,container:C,fetchAccessToken:b,fetchItemFromNetwork:g,getCurrentDocumentInfo:f,host:null==L?void 0:L.uiHostName,health:Kn,logger:Mn,officeDocumentSession:r,wopiHostData:n,sessionConfig:H,uiHostConfig:L,initPackageParams:fn},rn=null!=$?$:function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().moveToFolderFilePickerHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}(tn),un=null!=en?en:function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().commonPickerHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}(tn),sn=function(n){var t=this;return function(){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return[4,t.sent().getCustomAuthConfigHandler(n)];case 2:return t.sent(),[2]}}))}))}}({customAuthConfigValue:null==H?void 0:H.customAuthConfigValue,getCurrentDocumentInfo:f,officeDocumentSession:r,appUrlPromise:d,logger:Mn,health:Kn}),hn=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().pushStateHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,supportsPopAndPushState:null==L?void 0:L.supportsPopAndPushState,logger:Mn,sharingLinkTokenProvider:J,health:Kn}),pn=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().caaeMessageHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onCAAEMessage:Q,health:Kn}),wn=function(n){var t=this,o=n.onAcquireOAuthTokenTeams;return function(n){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){return o?(o(n.AuthUrl),[2]):[2]}))}))}}({getCurrentDocumentInfo:f,onAcquireOAuthTokenTeams:X,health:Kn}),bn=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().popStateCallback(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,appUrlPromise:d,logger:Mn,officeDocumentSession:r,health:Kn});!function(n){var t=n.onPopState;n.supportsPopAndPushState&&window.addEventListener("popstate",t)}({getCurrentDocumentInfo:f,onPopState:bn,supportsPopAndPushState:null==L?void 0:L.supportsPopAndPushState,health:Kn});var Hn=function(n){var t=this;return function(o){return(0,e.mG)(t,void 0,void 0,(function(){return(0,e.Jh)(this,(function(t){switch(t.label){case 0:return[4,u.e(3648).then(u.bind(u,5655))];case 1:return t.sent().frameChangedHandler(n,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onFrameChange:vn,health:Kn});return{documentRebootHandler:h,renameHandler:p,sessionRefreshInfoHandler:m,shareHandler:S,userAccessHandler:I,userActivityHandler:A,createNewHandler:U,getAuthTokenHandler:y,sendConversationIdHandler:T,closeTeamsConversationHandler:F,navigateBackToHostHandler:N,accessibilityLoopCompleteHandler:E,getClientUrlCompleteHandler:k,getWebUrlCompleteHandler:O,loadingStatusHandler:P,wopiInfoFromUrlHandler:_,davUrlFromIdsHandler:B,onCloseHandler:function(){null==Mn||Mn.ULS.sendTraceTag(575545427,o.W.uo,i.G.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(M?"true":"false")),M&&M()},actionCompleteHandler:x,openInBrowserHandler:q,openInMobileAppHandler:nn,moveToFolderPickerHandler:rn,commonFilePickerHandler:un,getCustomAuthConfigHandler:sn,pushStateHandler:hn,caaeMessageHandler:pn,frameChangedHandler:Hn,fileEmbedHandler:function(){Sn&&Sn()},dismissSplashScreenHandler:function(){var n=document.getElementById("splashscreen-container");n&&(n.style.display="none")},acquireOAuthTokenTeamsHandler:wn}},Xn=(null==fn?void 0:fn.jsApiUrlInfos)?null==fn?void 0:fn.jsApiUrlInfos:new Map;0===Xn.size&&Xn.set(T.T.Word,{jsApiUrl:null===(r=null==fn?void 0:fn.wordBootstrapperUrlInfo)||void 0===r?void 0:r.url,jsApiSri:null===(s=null==fn?void 0:fn.wordBootstrapperUrlInfo)||void 0===s?void 0:s.sri,jsApiBackupUrl:null===(v=null==fn?void 0:fn.wordBootstrapperUrlInfo)||void 0===v?void 0:v.url,PreloadedInBootStrapper:null===(h=null==fn?void 0:fn.wordBootstrapperUrlInfo)||void 0===h?void 0:h.wordJsApiPreloadedInBootStrapper});var Zn,Yn=(0,un.Tq)(w,Cn,g,L,H,P,!1,B,(function(n,t,e,o){Zn=n;var i=new F.X(e),r=Qn(t,i,o),u=r.documentRebootHandler,s=r.renameHandler,a=r.sessionRefreshInfoHandler,l=r.shareHandler,c=r.userAccessHandler,d=r.userActivityHandler,f=r.createNewHandler,v=r.getAuthTokenHandler,h=r.sendConversationIdHandler,p=r.closeTeamsConversationHandler,m=r.navigateBackToHostHandler,w=r.accessibilityLoopCompleteHandler,g=r.getClientUrlCompleteHandler,S=r.getWebUrlCompleteHandler,b=r.loadingStatusHandler,H=r.wopiInfoFromUrlHandler,C=r.davUrlFromIdsHandler,I=r.onCloseHandler,A=r.actionCompleteHandler,U=r.openInBrowserHandler,y=r.openInMobileAppHandler,T=r.moveToFolderPickerHandler,N=r.commonFilePickerHandler,E=r.getCustomAuthConfigHandler,k=r.pushStateHandler,P=r.caaeMessageHandler,R=r.frameChangedHandler,D=r.fileEmbedHandler,O=r.dismissSplashScreenHandler,W=r.acquireOAuthTokenTeamsHandler,j=(0,mn.vJ)(mn.Fh.FeatureGate_UseNewEuplReporting,null==L?void 0:L.featureGates);Vn=function(n){var t=n.data;switch(n.type){case tn.Reboot:u(t);break;case tn.FileRenamed:s(t);break;case tn.UserAccessAndPermissions:c(t);break;case tn.Share:l(t);break;case tn.UserActivity:d(t);break;case tn.CreateNewDocument:f(t);break;case tn.RefreshSessionInfo:a(t);break;case tn.GetAuthToken:v(t);break;case tn.AccessibilityLoopCompleted:w(t);break;case tn.AcquireOAuthTokenTeams:W(t);break;case tn.GetClientUrlComplete:g(t);break;case tn.LoadingStatus:b(t);break;case tn.GetWebUrlComplete:S(t);break;case tn.NavigateBackToHost:m(t);break;case tn.SendConversationId:h(t);break;case tn.CloseTeamsConversation:p(t);break;case tn.GetWopiInfoFromUrl:H(t);break;case tn.Close:I();break;case tn.ActionCompleted:A(t);break;case tn.OpenInBrowser:U(t);break;case tn.OpenInMobileApp:y(t);break;case tn.MoveToFolder:T(t);break;case tn.SharedFilePicker:N(t);break;case tn.GetCustomAuthConfig:E(t);break;case tn.GetDavUrlFromIds:C(t);break;case tn.PushState:k(t);break;case tn.CAAEMessage:P(t);break;case tn.FrameChanged:R(t);break;case tn.FileEmbed:D();break;case tn.InitEnd:j&&(null==B||B(j));break;case tn.SplashScreenShown:j&&(null==x||x()),O()}},Zn.addEventListener(Vn)}),Jn,Xn,bn),$n=Yn.correlationId,nt=Yn.bootstrapperObservable,tt=Yn.fileNamePromise,et=Yn.applicationUrlPromise;null==Mn||Mn.ULS.sendTraceTag(546182048,o.W.uo,i.G.Info,"BootApp: Load document returned"),tt.then((function(n){return null==E?void 0:E(n)})).catch((function(){return"obligatory catch"}));var ot,it=void 0,rt=void 0,st=void 0,at=void 0,lt=new pn.C(Mn),ct=new pn.C(Mn),dt=new N.xQ,ft=function(n){(0,ln.R)(cn.KX.PostMessage_HostSendConversationId,{conversationId:n},et,it,Mn)},vt=function(n){var t=(0,a.a)(),e=(0,a.eR)();jn.PostWacTokenStartTime=_n.PostWacTokenStartTime=t,jn.PostWacTokenAttempted=_n.PostWacTokenAttempted=!0,null==Kn||Kn.recordKpiUsage(Fn,y.o.SuccessBased,Nn,void 0),null==Mn||Mn.ULS.sendTraceTag(507597022,o.W.uo,i.G.Important,"postWacToken flow initiated"),ut&&(null==Mn||Mn.ULS.sendTraceTag(507377673,o.W.uo,i.G.Warning,"Calling postWacToken after usage telemetry has been logged")),Promise.race([lt,ct]).then((function(r){r.run?(null==Mn||Mn.ULS.sendTraceTag(507597021,o.W.uo,i.G.Info,"officeDocSession created after ".concat((0,a.a)()-t," ms")),r.run(U.O.postWacToken,{wacToken:n,postWacTokenStart:e}).then((function(n){_n.PostWacTokenResult=n.completion,_n.PostWacTokenEndTime=(0,a.a)(),n.data&&void 0!==n.data.TokenAlreadySet&&(_n.TokenAlreadySet=n.data.TokenAlreadySet),Wn.resolve(hn.Completed)})).catch((function(n){_n.PostWacTokenResult="Unexpected JSAPI V2 error",_n.PostWacTokenEndTime=(0,a.a)(),null==Mn||Mn.ULS.sendTraceTag(507852515,o.W.uo,i.G.Warning,"Caught error running postWacToken flow: ".concat(n)),Wn.resolve(hn.Completed)}))):r.PostWacToken?(null==Mn||Mn.ULS.sendTraceTag(507597020,o.W.uo,i.G.Info,"wopiPending created after ".concat((0,a.a)()-t," ms")),_n.flush=function(){Wn.resolve(hn.Completed)},r.PostWacToken(n,e,_n)):(_n.PostWacTokenResult="Unexpected OWL error",_n.PostWacTokenEndTime=(0,a.a)(),null==Mn||Mn.ULS.sendTraceTag(507852514,o.W.uo,i.G.Warning,"postWacToken: WopiPending or OfficeDocumentSession is not defined. This should never happen, the catch callback should be hit instead."),Wn.resolve(hn.Completed))})).catch((function(){_n.PostWacTokenResult="Error occurred instantiating JSAPI session in OWL",_n.PostWacTokenEndTime=(0,a.a)(),null==Mn||Mn.ULS.sendTraceTag(507852513,o.W.uo,i.G.Warning,"Neither JSAPI v1 or v2 applications were created"),Wn.resolve(hn.Completed)}))};return st=function(n,t,e){return n.pipe(q((function(n){return n({container:t,flushTime:e})}),void 0,1))}(nt,C,m).subscribe((function(n){var t=n.officeApplication,r=n.bootedDocumentInfo,u=n.wopiHostData,s=n.wopiPendingApp,d=n.officeDocumentSession,f=n.wacBootDiagnostics;if(Zn=t,rt=s,it=d)lt.resolve(it);else if(rt)ct.resolve(rt);else{var v="No session found";lt.reject(v),ct.reject(v)}var h=(0,mn.vJ)(mn.Fh.FeatureGate_OwlPostWacTokenForTeamsHosts,null==L?void 0:L.featureGates);h&&!sn.nb&&xn&&(Mn.ULS.sendTraceTag(507347490,o.W.uo,i.G.Important,"WAC token posted after jsapi boot use postWacToken method"),null==xn||xn.then((function(n){vt(n)})).catch((function(n){Mn.ULS.sendTraceTag(507347290,o.W.uo,i.G.Error,"WAC token atempted to be posted after jsapi boot using postWacToken method, but failed: ".concat(n))}))),h&&(0,sn.dL)();var m=_(window,"message").pipe(nn((function(n){return!!n.data&&!!n.origin&&n.origin.endsWith(Tn)})),O((function(n){return JSON.parse(n.data)})),nn((function(n){return!(!n||!n.MessageId)})));if(!Gn){var g=Qn(u,r,d),S=g.documentRebootHandler,b=g.renameHandler,C=g.sessionRefreshInfoHandler,I=g.shareHandler,A=g.userAccessHandler,U=g.userActivityHandler,y=g.createNewHandler,F=g.getAuthTokenHandler,N=g.sendConversationIdHandler,E=g.closeTeamsConversationHandler,P=g.navigateBackToHostHandler,R=g.accessibilityLoopCompleteHandler,D=g.getClientUrlCompleteHandler,W=g.getWebUrlCompleteHandler,j=g.loadingStatusHandler,M=g.wopiInfoFromUrlHandler,B=g.davUrlFromIdsHandler,x=g.onCloseHandler,K=g.actionCompleteHandler,G=g.openInBrowserHandler,V=g.moveToFolderPickerHandler,J=g.commonFilePickerHandler,z=g.getCustomAuthConfigHandler,q=g.pushStateHandler,Q=g.caaeMessageHandler,X=g.fileEmbedHandler,Z=g.acquireOAuthTokenTeamsHandler;zn=[[cn.Dm.PostMessage_SendConversationId,N],[cn.Dm.PostMessage_CloseTeamsConversation,E],[cn.Dm.PostMessage_NavigateBackToHost,P],[cn.Dm.PostMessage_AccessibilityLoopComplete,R],[cn.Dm.PostMessage_GetClientUrlComplete,D],[cn.Dm.PostMessage_GetWebUrlComplete,W],[cn.Dm.PostMessage_LoadingStatus,j],[cn.E_.Event_DocumentReboot,S],[cn.Dm.PostMessage_FileRenamed,b],[cn.Dm.PostMessage_CheckUserAccess,A],[cn.Dm.PostMessage_Share,I],[cn.Dm.PostMessage_UserActivity,U],[cn.Dm.PostMessage_AppCreateNewDocument,y],[cn.Dm.PostMessage_OpenInBrowser,G],[cn.E_.Event_MoveToFolder,V],[cn.E_.Event_SharedFilePicker,J],[cn.E_.Event_GetCustomAuthConfig,z],[cn.Dm.PostMessage_CAAEMessage,Q],[cn.Dm.PostMessage_AcquireOAuthTokenTeams,Z]],w.fileType===T.T.Excel&&(zn.push([cn.E_.Event_GetWopiInfoFromUrl,M]),zn.push([cn.E_.Event_GetDavUrlFromIds,B])),zn.forEach((function(n){var o=(0,e.CR)(n,2),i=o[0],r=o[1];t.RegisterEventHandler(i,r)})),at=m.subscribe((function(n){switch(n.MessageId){case cn.Dm.PostMessage_AppRefreshSessionInfo:C(n.Values);break;case cn.Dm.PostMessage_GetAuthToken:F(n.Values);break;case cn.Dm.PostMessage_Close:x();break;case cn.Dm.PostMessage_ActionComplete:K(n.Values);break;case cn.Dm.PostMessage_AppPushState:q(n.Values);break;case cn.Dm.PostMessage_FileEmbed:X()}}))}if(k){if(null==Mn||Mn.ULS.sendTraceTag(546182049,o.W.uo,i.G.Info,"BootApp: About to execute OnBootComplete"),(0,a.l5)(l.r_.OwlOnBootComplete),!c.qj.isOwlFrame){var Y=(0,l.OV)((0,l.vY)("owl"));null==Mn||Mn.ULS.sendTraceTag(508568928,o.W.uo,i.G.Important,(0,c.T4)(w.fileType,H.wiseEnvironment,null==L?void 0:L.featureGates,null==L?void 0:L.uiHostName,null==L?void 0:L.uiHostIntegrationType,Mn)+", OwlTraditional Telemetry Data: "+JSON.stringify(Y))}"PRODUCTION"===H.wiseEnvironment&&"true"===localStorage.getItem("OWLandJSAPIPrefetchEnabled")&&setTimeout((function(){return(0,e.mG)(p,void 0,void 0,(function(){var n,t;return(0,e.Jh)(this,(function(e){return n=document.createElement("div"),document.body.appendChild(n),An(n,w.fileType,Mn),t=setInterval((function(){An(n,w.fileType,Mn)}),18e5),On.push(t),[2]}))}))}),3e4),k(w,f)}}),(function(n){P&&(null==Mn||Mn.ULS.sendTraceTag(546182050,o.W.uo,i.G.Info,"BootApp: About to execute OnBootFailure"),P(n)),null==st||st.unsubscribe(),null==at||at.unsubscribe()})),{endSession:qn,sessionEndObservable:dt.asObservable(),hostAccessibilityLoopComplete:function(n){return(0,ln.R)(cn.KX.PostMessage_HostAccessibilityLoopComplete,{Direction:n?"forward":"backward"},et,it,Mn),!0},hostGetClientUrl:function(){(0,ln.R)(cn.KX.PostMessage_HostGetClientUrl,{},et,it,Mn)},hostGetWebUrl:function(){(0,ln.R)(cn.KX.PostMessage_HostGetWebUrl,{},et,it,Mn)},postFrameDiagnostics:function(n){(0,ln.R)(cn.KX.PostMessage_OwlFrameDiagnostics,{FrameDiagnostics:n},et,it,Mn)},hostBackButtonPressed:function(){return(0,ln.R)(cn.KX.PostMessage_HostBackButtonPressed,{},et,it,Mn),!0},hostSendConversationId:ft,postWacToken:vt,completeCreateNew:function(n){wn.r.sessionPromise.then((function(t){t?t.run(U.O.completeCreateNew,n).then((function(n){return wn.r.completeCreateNew(n)})).catch((function(n){Mn.ULS.sendTraceTag(507778315,o.W.uo,i.G.Warning,"Caught error running completeCreateNew flow: ".concat(n)),wn.r.failCreateNew(n)})):(Mn.ULS.sendTraceTag(507778314,o.W.uo,i.G.Warning,"Attempting to run completeCreateNew flow without an OfficeDocumentSession."),wn.r.failCreateNew(new Error("session is undefined")))})).catch((function(n){Mn.ULS.sendTraceTag(507331607,o.W.uo,i.G.Error,"Encountered error in completeCreateNew: ".concat(n))}))}}}var Bn,xn,Ln,Kn,Gn,Vn,Jn,zn,qn,Qn,Xn,Zn,Yn,$n=u(9645),nt=u(5702),tt=u(8604),et=new pn.C,ot=(dn.NF.SharePointOnline,"owl-container"),it="PrebootDocumentOpen",rt=new pn.C,ut=!1;function st(n){var t,e,o;if(!(null===(t=null==n?void 0:n.clientVersion)||void 0===t?void 0:t.trim()))throw new Error("invalid clientVersion");if(!n.exposure||n.exposure<=0||n.exposure>100)throw new Error("invalid exposure ("+(null!==(e=n.exposure)&&void 0!==e?e:"undefined")+")");n.wiseEnvironment=null===(o=n.wiseEnvironment)||void 0===o?void 0:o.toLocaleUpperCase(),Bn=n}function at(n,t){var e=document.createElement("div");return e.id=t,n.appendChild(e)}function lt(n){qn?qn(n):rt.then((function(t){return t(n)})).catch((function(n){return null==Xn?void 0:Xn.ULS.sendTraceTag(507331606,o.W.uo,i.G.Error,"createNewComplete encountered error: ".concat(n))}))}function ct(n){var t,u,s,d,w=(0,a.a)();(0,a.l5)(l.r_.OwlWithCustomFunctionsStart),function(){var n,t;window.performance&&!((null===(n=window.performance.getEntriesByName(l.r_.OwlHostTimeOrigin))||void 0===n?void 0:n.length)>0||(null===(t=window.performance.getEntriesByName(l.r_.OwlFrameTimeOrigin))||void 0===t?void 0:t.length)>0)&&window.performance.mark("".concat(c.qj.isOwlFrame?l.r_.OwlFrameTimeOrigin:l.r_.OwlHostTimeOrigin),{startTime:0,detail:window.performance.timeOrigin})}();var g=null!==(t=null==Bn?void 0:Bn.wiseEnvironment)&&void 0!==t?t:n.sessionConfig.wiseEnvironment,S=function(){return{Hidden:document.hidden,VisibilityState:document.visibilityState,HasFocus:document.hasFocus(),Timestamp:(0,a.a)()}},C=[S()];window.addEventListener("visibilitychange",(function(){return C.push(S())})),window.addEventListener("focus",(function(){return C.push(S())})),window.addEventListener("blur",(function(){return C.push(S())})),jn.BootAttempted=!0,jn.Environment=_n.Environment=g,jn.Application=_n.Application=n.documentBootInfo.fileType,jn.BootStartTime=_n.BootStartTime=(0,a.a)(),jn.StateEvents=_n.StateEvents=C,n.uiHostConfig&&(n.uiHostConfig.uiHostName&&(jn.UiHost=_n.UiHost=n.uiHostConfig.uiHostName),n.uiHostConfig.uiHostIntegrationType&&(jn.UiHostIntegrationType=_n.UiHostIntegrationType=n.uiHostConfig.uiHostIntegrationType)),n.sessionConfig&&(n.sessionConfig.hostCorrelationId&&(jn.HostCorrelationId=_n.HostCorrelationId=n.sessionConfig.hostCorrelationId),jn.IsAnonymous=_n.IsAnonymous=!!n.sessionConfig.isAnonymous,jn.IsSynthetic=_n.IsSynthetic=!!n.sessionConfig.isSynthetic);var I=!!n.sessionConfig.health,A=function(n,t){var o,i,u,s,a,l,c,d,f,v,h,p=null!==(o=null==t?void 0:t.wiseEnvironment)&&void 0!==o?o:n.sessionConfig.wiseEnvironment,m=n.sessionConfig.sessionId||(0,r.n)();(n.sessionConfig.logger||(n.sessionConfig.logger=new $n.G2(m,p).logger),n.sessionConfig.owlRollout="".concat(p,".").concat(null==t?void 0:t.exposure),n.sessionConfig.owlVersion=null==t?void 0:t.clientVersion,n.sessionConfig.health)||(h="string"==typeof m?m:(0,e.CR)(m,1)[0],n.sessionConfig.health=function(n,t,e,o,i,r,u,s,a,l,c,d,f,v,h,p){var m=new $n.zP(n,e,t,a,s,l,o,i,r,c,d,f).health;return null==m||m.addQosPillar("Open"),null==m||m.addOrUpdatePartCDimension("HostCorrelationId",u),null==m||m.addOrUpdatePartCDimension("AppSessionId",n),null==m||m.addOrUpdatePartCDimension("HostRingId",null!=v?v:"n/a"),null==m||m.addOrUpdatePartCDimension("IsNewFile",(!!h).toString()),null==m||m.addOrUpdatePartCDimension("isOdcMigrated",(!!p).toString()),null==m||m.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),m}(h,p,null===(i=n.documentBootInfo)||void 0===i?void 0:i.fileType,null===(u=n.documentBootInfo)||void 0===u?void 0:u.uiCulture,null===(s=n.documentBootInfo)||void 0===s?void 0:s.puid,n.sessionConfig.tenantId,n.sessionConfig.hostCorrelationId,null==t?void 0:t.exposure,null==t?void 0:t.clientVersion,n.sessionConfig.isSynthetic,null===(a=n.uiHostConfig)||void 0===a?void 0:a.uiHostName,null===(l=n.uiHostConfig)||void 0===l?void 0:l.uiHostIntegrationType,null===(c=n.documentBootInfo)||void 0===c?void 0:c.wdOrigin,null===(d=n.sessionConfig.bootDiagnostics)||void 0===d?void 0:d.ringId,null===(f=n.documentBootInfo)||void 0===f?void 0:f.isNewFile,null===(v=n.sessionConfig.bootDiagnostics)||void 0===v?void 0:v.isOdcMigrated));return n}(n,Bn),U=null!==(u=A.sessionConfig.sessionId)&&void 0!==u?u:(0,r.n)()[0];n.sessionConfig.sessionId=U,c.qj.checkOwlFrameCookie(g,null===(s=n.uiHostConfig)||void 0===s?void 0:s.featureGates),I||(Zn=A.sessionConfig.health),Xn||(Xn=A.sessionConfig.logger),function(n,t){var e=n.onBootComplete,r=n.onBootFailure,u=function(n){ut?null==t||t.ULS.sendTraceTag(507540254,o.W.uo,i.G.Warning,"Calling success or failure callback after another callback has already been called. Calling ".concat(n)):(null==t||t.ULS.sendTraceTag(507540255,o.W.uo,i.G.Important,JSON.stringify(jn)),ut=!0,jn={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1})};n.onBootComplete=function(n,t){jn.BootSucceeded=_n.BootSucceeded=!0,u("onBootComplete"),et.resolve(!0),e&&e(n,t)},n.onBootFailure=function(n,t){_n.BootSucceeded=!1,u("onBootFailure"),et.resolve(!1),r&&r(n,t)}}(n,Xn),function(n){var t=Promise.all([et,Wn]).then((function(n){return n[1]})),e=new Promise((function(n){return window.addEventListener("beforeunload",(function(t){return n(hn.Unloaded)}))})),r=new Promise((function(n){return setTimeout((function(){return n(hn.Timeout)}),Dn)}));Promise.race([t,e,r]).then((function(t){var e=t===hn.Unloaded;_n.PostWacTokenLoggerFlushTime=(0,a.a)(),_n.Unloaded=e,_n.flush&&delete _n.flush,n&&(n.ULS.sendTraceTag(507540257,o.W.uo,i.G.Important,JSON.stringify(_n)),e?n.ULS.flushOnClose():n.ULS.flush()),_n={}})).catch((function(){n&&n.ULS.sendTraceTag(507540256,o.W.uo,i.G.Warning,"Failed to log PostWacTokenTelemetry")}))}(Xn),function(n,t){var e,o,i,r,u,s,a,l;n.sessionConfig.bootDiagnostics=n.sessionConfig.bootDiagnostics||{},n.sessionConfig.bootDiagnostics.packageEntryTime=n.sessionConfig.bootDiagnostics.packageEntryTime||t,n.sessionConfig.bootDiagnostics.perfNavigationTiming=n.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,$n.pb)(),c.qj.isOwlFrameBootEnabled(null===(e=n.uiHostConfig)||void 0===e?void 0:e.featureGates,Xn)&&(n.sessionConfig.bootDiagnostics.legacyPerformanceData=n.sessionConfig.bootDiagnostics.legacyPerformanceData||{host:(0,$n.vb)()},c.qj.isOwlFrame&&(n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming=n.sessionConfig.bootDiagnostics.owlFramePerfNavigationTiming||(0,$n.pb)(),n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame=n.sessionConfig.bootDiagnostics.legacyPerformanceData.owlFrame||(0,$n.vb)())),n.sessionConfig.bootDiagnostics.loadManifestStartTime=n.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(o=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadManifestStartTime)||0,n.sessionConfig.bootDiagnostics.loadManifestEndTime=n.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(i=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===i?void 0:i.loadManifestEndTime)||(null===(r=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===r?void 0:r.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed=n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed||(null===(u=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===u?void 0:u.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed=n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed||(null===(s=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===s?void 0:s.loadManifestServerTimeElapsed),n.sessionConfig.bootDiagnostics.loadOwlStartTime=n.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(a=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===a?void 0:a.loadOwlStartTime),n.sessionConfig.bootDiagnostics.loadOwlEndTime=n.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(l=null==Bn?void 0:Bn.owlBootstrapperDiagnostics)||void 0===l?void 0:l.loadOwlEndTime)}(A,w);var y=A.container;Yn=function(n){var t;return null!==(t=document.getElementById(ot))&&void 0!==t?t:at(n,ot)}(A.container),A.container=Yn;var T,F,N=U===(T=A.documentBootInfo,(F=(0,b.q_)(T))&&H.X?H.X.getItem(F):null),E=A.onBootFailure;A.onBootFailure=function(n,t){var e,o;if(null==Zn||Zn.recordQosError(n.qosErrorName,["UnifiedUiHostBootstrappingFailed"],(0,nt.aj)(n),(0,nt.SS)(n.wacErrorName),!0,!0,{inStaging:null===(e=n.inStaging)||void 0===e||e,extendedProperties:(0,tt.x)(n)}),N){var i=new Map;i.set("FailureTime",(new Date).toUTCString()),i.set("Error",n.error),t&&i.set("DocumentBootInfo",JSON.stringify(t)),n.httpErrorCode&&i.set("HttpErrorCode",n.httpErrorCode),null==Zn||Zn.recordKpiFailure(it,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,a.a)()-((null===(o=A.sessionConfig.bootDiagnostics)||void 0===o?void 0:o.packageEntryTime)||w),extendedProperties:i})}E&&E(n,t),null==Zn||Zn.shutdown()};var k=(0,e.pi)((0,e.pi)({},A),{initPackageParams:Bn});(null!==(d=k.initializeTwoStepCreateNew)&&void 0!==d?d:wn.f)(k,Xn);var P=Mn(k);Ln=P.endSession,Kn=P.hostAccessibilityLoopComplete,Gn=P.hostGetClientUrl,Vn=P.hostGetWebUrl,Qn=P.postFrameDiagnostics,Jn=P.hostBackButtonPressed,zn=P.hostSendConversationId,qn=P.completeCreateNew,rt.resolve(qn),c.qj.isOwlFrame&&function(n,t,r,u,s,a,c,d){var w=this;null==f||f.registerHandler(p.EndSession,(function(t){return(0,e.mG)(w,void 0,void 0,(function(){var o,i,r;return(0,e.Jh)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,3,4]),[4,n()];case 1:return o=e.sent(),[3,4];case 2:return r=e.sent(),i=r,[3,4];case 3:return null==f||f.sendMessage({id:h.EndSessionResponse,data:{result:o,error:i,correlationId:t.correlationId}}),[7];case 4:return[2]}}))}))})),null==f||f.registerHandler(p.HostAccessibilityLoopComplete,(function(n){return t(n.data.navigateForward)})),null==f||f.registerHandler(p.GetClientUrl,(function(n){return r()})),null==f||f.registerHandler(p.GetWebUrl,(function(n){return u()})),null==f||f.registerHandler(p.BackButtonPressed,(function(n){return s()})),null==f||f.registerHandler(p.SendConversationId,(function(n){return a(n.data.conversationId)})),null==f||f.registerHandler(p.GetAuthTokenResponse,v.getHandler(p.GetAuthTokenResponse,m.Token)),null==f||f.registerHandler(p.FetchItemFromNetworkResponse,v.getHandler(p.FetchItemFromNetworkResponse,m.Item)),null==f||f.registerHandler(p.FetchAccessTokenResponse,v.getHandler(p.FetchAccessTokenResponse,m.Response)),null==f||f.registerHandler(p.OpenShareControlResponse,v.getHandler(p.OpenShareControlResponse)),null==f||f.registerHandler(p.CreateDocumentResponse,v.getHandler(p.CreateDocumentResponse,m.URL)),null==f||f.registerHandler(p.TelemetryData,(function(n){var t=n.data,e=t.context,r=t.hostData,u=t.frameData,s=(0,l.W8)(JSON.parse(r.owlTelemetryData),JSON.parse(u.owlTelemetryData));c&&c(s.owlPerformanceTimeline),null==d||d.ULS.sendTraceTag(508614159,o.W.uo,i.G.Important,e+", OwlFrame Telemetry Data: "+JSON.stringify(s)),null==d||d.ULS.sendTraceTag(508614158,o.W.uo,i.G.Important,e+", Boot Telemetry Data: "+JSON.stringify({hostBoot:r.bootTelemetryData,frameBoot:u.bootTelemetryData}))}))}(Ln,Kn,Gn,Vn,Jn,zn,Qn,Xn);var R=function(n){var t=n.subscribe((function(n){var o,i;if(n&&(null===(o=A.uiHostConfig)||void 0===o?void 0:o.supportsInternalReboot)){var u=(0,r.n)(),s=new $n.G2(u,g);A.sessionConfig.sessionId=s.sessionId,A.sessionConfig.logger=s.logger,A.sessionConfig.bootDiagnostics=(i=A.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,a.a)(),isTestMode:null==i?void 0:i.isTestMode,isPrebooted:!1,ringId:null==i?void 0:i.ringId,teamsContextStartTime:0,teamsContextEndTime:0,owlFramePerfNavigationTiming:(0,$n.pb)(),perfNavigationTiming:(0,$n.pb)(),meetingLiveDiagnostics:void 0}),A.sessionConfig.highContrastMode=n.theme,y&&Yn&&Yn.parentNode===y&&y.removeChild(Yn),Yn=at(y,ot);var l=Mn((0,e.pi)((0,e.pi)({},A),{container:Yn,documentBootInfo:n.documentBootInfo,initPackageParams:Bn}));Ln=l.endSession,Kn=l.hostAccessibilityLoopComplete,Gn=l.hostGetClientUrl,Vn=l.hostGetWebUrl,Jn=l.hostBackButtonPressed,zn=l.hostSendConversationId,qn=l.completeCreateNew,rt.resolve(qn),t.unsubscribe(),R(l.sessionEndObservable)}else y&&Yn&&Yn.parentNode===y&&y.removeChild(Yn),t.unsubscribe();null==Zn||Zn.shutdown()}))};return R(P.sessionEndObservable),c.qj.isOwlFrame&&P.sessionEndObservable.subscribe((function(n){null==f||f.sendMessage({id:h.EndSessionObservable,data:{rebootInfo:n}})})),(0,a.l5)([l.r_.OwlEnd,l.r_.OwlWithCustomFunctionsEnd]),P}}(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=s}();