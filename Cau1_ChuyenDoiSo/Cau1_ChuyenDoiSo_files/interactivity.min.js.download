var interactivity;!function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{getInteractivityTrackerFactory:function(){return Pt}});var n,r,o,i,a,c=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),s=new(function(){function e(){this.externalLogger=new c}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}());(a=n||(n={}))[a.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",a[a.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",a[a.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",a[a.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",a[a.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",a[a.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",a[a.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",a[a.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",a[a.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",a[a.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",a[a.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",a[a.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",a[a.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",a[a.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",a[a.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",a[a.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",a[a.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",a[a.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",a[a.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",a[a.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",a[a.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",a[a.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",a[a.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",a[a.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",a[a.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",a[a.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",a[a.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",a[a.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",a[a.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",a[a.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",a[a.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",a[a.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",a[a.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",a[a.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",a[a.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",a[a.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",a[a.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",a[a.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",a[a.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",a[a.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",a[a.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",a[a.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",a[a.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",a[a.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",a[a.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",a[a.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",a[a.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",a[a.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",a[a.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",a[a.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",a[a.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",a[a.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",a[a.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",a[a.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",(i=r||(r={}))[i.Error=10]="Error",i[i.Warning=15]="Warning",i[i.Important=20]="Important",i[i.Info=50]="Info",i[i.Verbose=100]="Verbose",i[i.Spam=200]="Spam",function(e){e[e.StartTrackAction=0]="StartTrackAction",e[e.EndTrackSlowAction=1]="EndTrackSlowAction"}(o||(o={}));var u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)};function l(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create;var d=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mouseout","mouseover","mouseup","pointerover","pointerenter","pointerdown","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","touchstart","touchend","touchcancel","keydown","keypress","keyup","beforeinput","input","compositionstart","compositionupdate","compositionend","dragstart","dragend","dragenter","dragleave","dragover","drop"],p={events:["click","keypress","mousedown"],durationThresholdInMs:100},m="undefined",f={},g={};function v(e){void 0===e&&(e="EndOfState");var t=h(e);return JSON.parse(JSON.stringify(t))}function h(e){switch(e){case"Periodic":return g;case"EndOfState":return f;default:return s.sendTraceTag(508303315,n.msoulscat_Wac_BrowserGeneral,r.Error,"InteractivityTracker.getTrackedUserActionReportMap wrong report mode"),f}}function T(e,t,n){void 0===n&&(n=1),me()||y(e,t,"EndOfState",n),ge()&&y(e,t,"Periodic",n)}function y(e,t,n,r){void 0===r&&(r=1);var o=_(e,n);"total"===t&&(o.total+=r),"slow"===t&&(o.slow+=r)}function _(e,t){void 0===t&&(t="EndOfState");var n=h(t),r=n[e.action];return r||(r={total:0,slow:0,actionBucket:e.actionBucket},n[e.action]=r),r}function w(){me()||(f={}),ge()&&(g={})}var S=void 0,k={};function W(e){return k[e]}function O(e){var t=-1,o=de();e.getEntries().forEach((function(e){var i=e.entryType;s.shipAssertTag(539829780,n.msoulscat_Wac_BrowserGeneral,"event"===i,"ResponsivenessTracker:handleObservedEvents - unexpected observed entry type: ".concat(i)),function(e,t){if(W(e.name)){var o=function(e){return De(Ve(e.name,e.startTime))}(e);if(!function(e,t,n){var r=t[0];return void 0!==r.state&&r.state!==n&&(De(Ve(e.name,e.startTime)),!0)}(e,o,t)){var i=e.startTime+e.duration;o.forEach((function(t){"undefined"!==t.action?(function(e,t,o){var i=Y(),a=i.deviceMemory,c=i.hardwareConcurrency,u=t.name,l="InteractivityTracker:logSlowEvent - EventTiming - state: ".concat(e.state,", userAction: ").concat(e.action,", eventName: ").concat(u,", ")+"eventStartToNextFrame: ".concat(t.duration.toFixed(2),", startTime: ").concat(t.startTime.toFixed(2),", ")+"processingStart: ".concat(t.processingStart.toFixed(2),", processingEnd: ").concat(t.processingEnd.toFixed(2),", ")+"renderTime: ".concat(o.toFixed(2),", ")+"".concat(ee(),", ")+" deviceMemory: ".concat(a,", hardwareConcurrency: ").concat(c)+", actionBucket: ".concat(se(e),", context: ").concat(JSON.stringify(e.contexts));s.sendTraceTag(137704134,n.msoulscat_Wac_BrowserGeneral,r.Info,l);var d={};e.contexts.forEach((function(e){d[e.itemKey]=e.value}));var p={};p.state=e.state,p.userAction=e.action,p.eventName=u,p.eventStartToNextFrame=t.duration.toFixed(2),p.startTime=t.startTime.toFixed(2),p.processingStart=t.processingStart.toFixed(2),p.processingEnd=t.processingEnd.toFixed(2),p.renderTime=o.toFixed(2),p.appInfo=ee(),p.deviceMemory=a,p.hardwareConcurrency=c,p.actionBucket=se(e),p.contexts=d;var m=JSON.stringify(p);s.sendTraceTag(137704576,n.msoulscat_Wac_BrowserGeneral,r.Info,m),ae("VSO:8185150")&&function(e){var t;null===(t=null==R?void 0:R.logSlowActionsHandler)||void 0===t||t.call(R,e)}(m)}(t,e,i),Ge(e.startTime,t,i)):s.sendTraceTag(523621256,n.msoulscat_Wac_BrowserGeneral,r.Info,"ResponsivenessTracker:processEventTimingEntry - undefined slow action, probably due to duplicate slow actions")}))}}}(e,o),e.startTime>t&&(t=e.startTime)})),function(e){var t=0;for(var o in ke){var i=Le(o);i&&i<e&&performance.now()-i>3e3&&(De(o),t+=1)}s.sendTraceTag(539829781,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:clearTrackedEventsToUserAction - cleared ".concat(t," tracked events}"))}(t)}var A=300,E=void 0,I=1e4,C=new Map;function b(e){for(var t=function(e){var t=e.identifier;if(!t)return{NODE_ENV:"production"}.DEBUG&&s.debugAssertTag(508065293,n.msoulscat_Wac_BrowserGeneral,!1,"asyncUiTracker.handleObservedEvents - missing identifier on entry"),"continue";var o=e.element,i=null==o?void 0:o.getAttribute("data-ui-mutation-time");if(!i)return"continue";var a=We[t],c=null==o?void 0:o.getAttribute("data-ui-mutation-context-value"),u=null==o?void 0:o.getAttribute("data-ui-mutation-remove-element");if(ae("OfficeVSO:8650749_shouldRemoveElementFromDom")&&u&&(window.requestIdleCallback?window.requestIdleCallback((function(){return P(o)})):setTimeout((function(){return P(o)}),0)),!a||0===a.length)return s.sendTraceTag(508121942,n.msoulscat_Wac_BrowserGeneral,r.Warning,"AsyncUiTracker:handleObservedEvents - missing pending entry, identifier = ".concat(t,", contextValue = ").concat(c)),"continue";var l=parseFloat(i),d=function(e,t,o,i,a){for(var c,u=void 0,l=0,d=i;l<d.length;l++){var p=d[l];if(!p.isReported&&!(e.renderTime-p.startTime>I)&&p.startTime<=o&&(!u||p.startTime>u.startTime)){if(u&&!u.isReportedAsDuplicate){u.isReportedAsDuplicate=!0;var m=((c={}).matchingUserActionStartTime=u.startTime,c.userActionStartTime=p.startTime,c.identifier=t,c.uiMutationTime=o,c.userActionContexts=p.contexts,c.contextValue=a,c);s.sendTraceTag(508072512,n.msoulscat_Wac_BrowserGeneral,r.Info,"AsyncUiTracker:handleObservedEvents - more than one matching pending entry: ".concat(JSON.stringify(m)))}u=p}}return u}(e,t,l,a,c);if(!d)return s.sendTraceTag(508121941,n.msoulscat_Wac_BrowserGeneral,r.Warning,"AsyncUiTracker:handleObservedEvents - no matching pending entry, identifier = ".concat(t,", ")+"uiMutationTime = ".concat(l,", contextValue = ").concat(c," ")+"there are ".concat(a.length," pending entries.")),"continue";Boolean(c)&&(d.action=c),function(e,t,o){var i;if(!o.state||o.state===t){o.isReported=!0,function(e,t){var o,i={};e.contexts.forEach((function(e){i[e.itemKey]=e.value}));var a=Y(),c=a.deviceMemory,u=a.hardwareConcurrency,l=((o={}).userAction=e.action,o.startTime=e.startTime.toFixed(2),o.renderTime=t.renderTime.toFixed(2),o.appInfo=ee(),o.deviceMemory=c,o.hardwareConcurrency=u,o.actionBucket=se(e),o.contexts=i,o.appState=e.state,o),d=JSON.stringify(l);s.sendTraceTag(137703444,n.msoulscat_Wac_BrowserGeneral,r.Important,d),ae("OfficeVSO:8645877_addAsyncActionsCustomHandler")&&(l.contexts=e.contexts,function(e){var t;null===(t=null==R?void 0:R.logAsyncActionHandler)||void 0===t||t.call(R,e)}(l))}(o,e),T(o,"total"),j()&&Fe(o),performance.measure("Async UI Action: ".concat(o.action),{start:o.startTime,end:e.renderTime});var a=null!==(i=C.get(o.action))&&void 0!==i?i:A;e.renderTime-o.startTime>a&&Ge(o.startTime,o,e.renderTime)}}(e,de(),d)},o=0,i=e.getEntries();o<i.length;o++)t(i[o]);!function(e){for(var t=performance.now()-e,o=0,i=Object.keys(We);o<i.length;o++){var a=i[o],c=We[a];We[a]=c.filter((function(e){return e.startTime>t&&!e.isReported}));var u=c.filter((function(e){return e.isReported})).length,l=c.length-u-We[a].length;if(j())for(var d=0,p=c;d<p.length;d++){var m=p[d];m.startTime<=t&&Fe(m)}0===We[a].length&&delete We[a],l>0&&s.sendTraceTag(508121939,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:clearOldAsyncActions - cleared ".concat(l," timed out tracked actions for ").concat(a))}}(I)}function P(e){var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}var R,B,U,M=void 0,N=void 0,x=void 0,G=void 0,J=void 0,F=!1,D=void 0,V=void 0,L=void 0,H=void 0,q=!1;function j(){return q}function z(e){return H?H.has(e):!ae("OfficeVSO:8688553_MakeAsyncUINamesNonOptional")}function K(e){H||(H=new Set),H.add(e)}var Q,X=!1;function Y(){return D=null!=D?D:navigator.deviceMemory||0,V=null!=V?V:navigator.hardwareConcurrency||0,{deviceMemory:D,hardwareConcurrency:V}}function Z(){return null!=M?M:void 0}function $(){return null!=N?N:void 0}function ee(){var e;return x||(e=N,x=JSON.stringify(e)),null!=x?x:void 0}function te(e){var t,o;if(void 0===e&&(e=p),R=null==e?void 0:e.callbacks,oe()&&(s.sendTraceTag(539829774,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:canStartObserver:false - repeated start attempt"),1))return s.sendTraceTag(539829765,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:startInteractivityTracker - cannot start interactivityTracker"),{started:!1,failureReason:"cannot start interactivityTracker"};F=!0;var i=function(e){if(!e.durationThresholdInMs||e.durationThresholdInMs<0)return s.shipAssertTag(539829770,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.durationThresholdInMs undefined or < 0"),p;if(null==e.events||0===e.events.length)return s.shipAssertTag(539829771,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.events missing or empty"),p;for(var t=0,r=e.events;t<r.length;t++){var o=r[t];if(o&&d.indexOf(o)<0)return s.shipAssertTag(539829772,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - invalid event in options.events ".concat(o)),p}if(e.callbacks&&"function"!=typeof e.callbacks.getAppState)return s.shipAssertTag(539829773,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - getAppState is not a function"),p;if(e.periodicReport&&e.periodicReport.intervalMs<0)return s.shipAssertTag(509195584,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid periodicReport.intervalMs"),p;if(e.animationTracking){if(!e.animationTracking.chunkDurationMs||!e.animationTracking.minFramesPerChunk)return s.shipAssertTag(508343188,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking properties"),p;if(e.animationTracking.chunkDurationMs<100)return s.shipAssertTag(508343187,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.chunkDurationMs (less than 100)"),p;if(e.animationTracking.minFramesPerChunk<0)return s.shipAssertTag(508343186,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.minFramesPerChunk (less than 0)"),p}return e}(e);q=Boolean(i.allowAsyncUIContextReporting),B=i.periodicReport,U=i.animationTracking,X=Boolean(i.asyncUiTracking),le(),M=de(),N=pe(),ge()&&Te(),window.addEventListener("beforeunload",ne),window.addEventListener("visibilitychange",le);try{if(function(e){!function(e){var t;null===(t=e.events)||void 0===t||t.forEach((function(e){k[e]=!0}))}(e),(S=new PerformanceObserver(O)).observe({type:"event",buffered:!0,durationThreshold:e.durationThresholdInMs})}(i),he()){!function(e){var t,n,r,o,i,a;A=null!==(n=null===(t=e.asyncUiTracking)||void 0===t?void 0:t.slowUiEventThresholdMs)&&void 0!==n?n:A,I=null!==(o=null===(r=e.asyncUiTracking)||void 0===r?void 0:r.asyncUiEventTimeoutMs)&&void 0!==o?o:I,null===(a=null===(i=e.asyncUiTracking)||void 0===i?void 0:i.slowActionTimeoutOverrides)||void 0===a||a.forEach((function(e){(null==e?void 0:e.actionName)&&C.set(e.actionName,e.slowActionThreshold)})),(E=new PerformanceObserver(b)).observe({type:"element"})}(i);var a=null!==(o=null===(t=i.asyncUiTracking)||void 0===t?void 0:t.allowedAsyncUiNames)&&void 0!==o?o:[];a.length>0&&(H=new Set(a))}s.sendTraceTag(539829775,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:startInteractivityTracker - started")}catch(e){return s.sendTraceTag(539829776,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:startInteractivityTracker - failed to start. Error: ".concat(e)),re(),{started:!1,failureReason:"Error: ".concat(e)}}return{started:!0}}function ne(){_e(),w()}function re(){return oe()?(null==S||S.disconnect(),S=void 0,null==E||E.disconnect(),E=void 0,window.removeEventListener("beforeunload",ne),window.removeEventListener("visibilitychange",le),He(),w(),F=!1,!0):(s.shipAssertTag(539829766,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:stopInteractivityTracker - attempt stop non-started"),!1)}function oe(){return F}function ie(){return!ue(null==R?void 0:R.getCurrentAppInfo)}function ae(e){if(null==R?void 0:R.isChangeGateEnabled)try{return null==R?void 0:R.isChangeGateEnabled(e)}catch(e){s.sendTraceTag(539829767,n.msoulscat_Wac_BrowserGeneral,r.Error,"InteractivityTracker:isChangeGateEnabled - failed to call isChangeGateEnabledCallback. Error: ".concat(e))}return!1}function ce(e,t,o,i){(null==R?void 0:R.sendBeaconTraceTag)?null==R||R.sendBeaconTraceTag(e,t,o,i):(s.sendTraceTag(539550627,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:sendBeaconTraceTag - interactivityTrackerCallbacks.sendBeaconTraceTag does not exist. Sending trace tag instead for tag: ".concat(e)),s.sendTraceTag(e,n.msoulscat_Wac_BrowserGeneral,t,i))}function se(e){if(e.actionBucket)return e.actionBucket;var t=e.action;if(null==R?void 0:R.getActionBucket){var n=null==R?void 0:R.getActionBucket(t);return null!=n?n:"undefined"}return""}function ue(e){return null==e}function le(){ae("OfficeVSO:5610366_StopTrackingEventsWhenPageIsHidden")&&"hidden"===document.visibilityState&&He()}function de(){if(null==R?void 0:R.getAppState)try{return null==R?void 0:R.getAppState()}catch(e){s.sendTraceTag(539829768,n.msoulscat_Wac_BrowserGeneral,r.Error,"InteractivityTracker:getAppState - failed to call getAppStateCallback. Error: ".concat(e))}}function pe(){if(null==R?void 0:R.getCurrentAppInfo)try{return u({},null==R?void 0:R.getCurrentAppInfo())}catch(e){s.sendTraceTag(539829769,n.msoulscat_Wac_BrowserGeneral,r.Error,"InteractivityTracker:getCurrentAppInfo - failed to call getCurrentAppInfoCallback. Error: ".concat(e))}}function me(){return B&&!B.isPassiveTestEnabled}function fe(){return null==B?void 0:B.isPassiveTestEnabled}function ge(){return!!B}function ve(){return!ue(U)}function he(){return X&&(void 0===L&&((L=!("undefined"==typeof window||((null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||[]).indexOf("element")<0)&&"elementTiming"in new Image)||s.sendTraceTag(508118157,n.msoulscat_Wac_BrowserGeneral,r.Warning,"trackerState:isElementTimingSupported - element timing not supported")),L);var e}function Te(){J=window.setTimeout(ye,B.intervalMs)}function ye(){J&&window.clearTimeout(J),G&&window.cancelIdleCallback(G),G=window.requestIdleCallback((function(){we("Periodic"),g={},Te()}))}function _e(){me()||we("EndOfState"),ge()&&we("Periodic")}function we(e){s.shipAssertTag(539829777,n.msoulscat_Wac_BrowserGeneral,oe(),"InteractivityTracker:validateTrackerStarted - non-started tracker: caller ".concat("logInteractivityReport"));var t=function(e){var t=[];for(var n in e){var r=e[n];r.action=n,r.actionBucket=se(r),t.push(r)}return t}(v(e));if("Periodic"!==e||0!==t.length){var o,i,a,c=(ie()?(i=null===(o=$())||void 0===o?void 0:o.appState,ae("OfficeVSO:6215934_CoauthInteractivityRegressionDetection")&&(a="".concat(null==R?void 0:R.getAppInfoForReport()))):i=Z(),"".concat(a," state: ").concat(i).trim());"Periodic"===e&&fe()?ce(137704403,r.Warning,!1,"InteractivityTracker:logInteractivityReport - ".concat(c," totals: ").concat(JSON.stringify(t))):ce(137704527,r.Warning,!1,"InteractivityTracker:logInteractivityReport - ".concat(c," totals: ").concat(JSON.stringify(t)))}}function Se(){return void 0===Q&&((Q=new Map([])).set(o.EndTrackSlowAction,"EndTrackSlowAction"),Q.set(o.StartTrackAction,"StartTrackAction")),Q}var ke={},We={},Oe=new Map,Ae=new Map,Ee=new Map,Ie=void 0;function Ce(e,t){Ie||(Ie=new EventTarget);var n=Se().get(e);n&&Ie.addEventListener(n,(function(e){return t(e.detail)}))}var be="_@@@_";function Pe(e,t){return e+be+t}function Re(e,t,n,r){if(!Ue(r,e))return[];for(var i=[],a=0,c=e;a<c.length;a++){var s=c[a];if(s){if(!z(s)){if(!ae("OfficeVSO:8688553_MakeAsyncUINamesNonOptional"))continue;K(s)}var u={action:"".concat(s,"-default"),state:t,contexts:n?l([],n,!0):[],startTime:r.timeStamp,actionBucket:s};qe(u,s,!0),i.push(u),Je(o.StartTrackAction,u,t)}}return i}function Be(e,t,i,a){if(function(e,t){return!!Me(t)&&(!!Ne(e)&&(!!W(e.type)||({NODE_ENV:"production"}.DEBUG&&s.debugAssertTag(538543693,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ".concat(e.type,", userAction: ").concat(t)),s.sendTraceTag(508839814,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ".concat(e.type,", userAction: ").concat(t)),!1)))}(e,t)&&xe(t)){var c=Ve(e.type,e.timeStamp),u=function(e,t,o){var i=ke[e],a=void 0!==i&&void 0!==i.find((function(e){return e.action===o}));return(!a||"keypress"!==t.type)&&(!!a&&(s.sendTraceTag(539829784,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ".concat(o," was already tracked on the same event with type: ").concat(t.type)),s.debugAssertTag(539829785,n.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ".concat(o," was already tracked on the same event with type: ").concat(t.type)),!0))}(c,e,t),d=je(),p={action:t,state:d,contexts:i?l([],i,!0):[],startTime:e.timeStamp},m=[];if(!u&&(qe(p,c),T(p,"total"),Je(o.StartTrackAction,p,d),he()&&a)){var f=i?l([],i,!0):[];f.push({itemKey:"action",value:t}),m=Re(a,d,f,e)}var g="InteractivityTracker:trackEvent - userActionKey: ".concat(c," userAction: ").concat(t,", ").concat(ee(),", actionBucket: ").concat(se(p),", context: ").concat(JSON.stringify(i));he()&&(u&&(g+=", isDuplicateAction: ".concat(u)),a&&a.length>0&&(g+=", asyncUiNames: ".concat(JSON.stringify(a)))),s.sendTraceTag(137704644,n.msoulscat_Wac_BrowserGeneral,r.Info,g);var v=Pe(c,t);if(j()){Oe.set(v,new Set(l(l([],m,!0),[p],!1)));for(var h=0,y=m;h<y.length;h++)y[h].contextKey=v;p.contextKey=v}return v}}function Ue(e,t){return!(!Ne(e)||(!t||0===t.length)&&(s.sendTraceTag(507557069,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:validateTrackAsyncUiParams -  no async UI Names"),1))}function Me(e){return!(!e||0===e.length&&(s.sendTraceTag(539829786,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:validateEventAndAction -  no userAction value"),1))}function Ne(e){return!!e&&e instanceof Event}function xe(e){return!!oe()||(s.sendTraceTag(539829787,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTracker:validateTrackerStarted - tracker not started. userAction dropped: ".concat(e)),!1)}function Ge(e,t,i){var a,c=$(),u=_(t,me()?"Periodic":"EndOfState");if(Je(o.EndTrackSlowAction,t,null!==(a=t.state)&&void 0!==a?a:null==c?void 0:c.appState,e,i),T(t,"slow"),u.slow>u.total&&t.action!==m&&s.sendTraceTag(539829788,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:processSlowEventActionTimingEntry: action ".concat(t.action," slow count (").concat(u.slow,") higher then total (").concat(u.total,"). trackedEventsToUserAction size is ").concat(Object.keys(ke).length)),fe()){var l=_(t,me()?"Periodic":"EndOfState");l.slow>l.total&&t.action!==m&&s.sendTraceTag(509162321,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:processEventTimingEntry: action ".concat(t.action," slow count (").concat(l.slow,") higher then total (").concat(l.total,"). trackedEventsToUserAction size is ").concat(Object.keys(ke).length))}}function Je(e,t,n,r,o){var i;if(void 0===r&&(r=void 0),void 0===o&&(o=void 0),Ie){var a={name:t.action,appState:n,recentAppInfoProperties:null===(i=$())||void 0===i?void 0:i.appInfoProperties};a.actionBucket=se(t);var c=Se().get(e);c&&Ie.dispatchEvent(new CustomEvent(c,{detail:{startTime:r,endTime:o,actionProps:a}}))}}function Fe(e){var t=e.contextKey;if(t){var n=Oe.get(t);n&&(n.delete(e),0===n.size&&Oe.delete(t))}}function De(e){var t=ke[e];if(!t)return[{action:m,state:void 0,contexts:[],startTime:-1}];if(j())for(var n=0,r=t;n<r.length;n++)Fe(r[n]);return delete ke[e],t}function Ve(e,t){return"".concat(e,"_").concat(t)}function Le(e){var t=e.indexOf("_"),n=t>-1?e.substring(t+1):void 0;return n?parseFloat(n):void 0}function He(){ke={},We={},Oe=new Map}function qe(e,t,n){if(void 0===n&&(n=!1),n){var r=(Ae.get(e.action)||0)+1;Ae.set(e.action,r),e.contexts.push({itemKey:"actionIndex",value:r.toString()});var o=se(e),i=(Ee.get(o)||0)+1;Ee.set(o,i),e.contexts.push({itemKey:"bucketIndex",value:i.toString()})}var a=ke;n&&(a=We);var c=a[t];c?c.push(e):a[t]=[e]}function je(){var e,t,n;return ie()?(function(){var e,t,n=pe();(null===(e=$())||void 0===e?void 0:e.appState)!==(null==n?void 0:n.appState)&&(_e(),w()),(t=n)&&(N=t,x=void 0)}(),t=null===(e=$())||void 0===e?void 0:e.appState):((n=de())!==Z()&&(M=n,1)&&(_e(),w()),t=Z()),null!=t?t:"undefined"}var ze,Ke=function(){function e(){this.collectedActions=[],this.collectingEnabled=!1,this.startCollectingSlowActions=this.startCollectingSlowActions.bind(this),this.stopCollectingSlowActions=this.stopCollectingSlowActions.bind(this),this.collectSlowUserAction=this.collectSlowUserAction.bind(this),this.retrieveAllSlowActions=this.retrieveAllSlowActions.bind(this),this.cleanCollectedActions=this.cleanCollectedActions.bind(this),this.retrieveSlowActionsBetweenTimeRange=this.retrieveSlowActionsBetweenTimeRange.bind(this)}return e.prototype.startCollectingSlowActions=function(e){e||this.cleanCollectedActions(),this.collectingEnabled=!0},e.prototype.stopCollectingSlowActions=function(){this.collectingEnabled=!1},e.prototype.collectSlowUserAction=function(e){this.collectingEnabled&&e&&this.collectedActions.push(e)},e.prototype.retrieveAllSlowActions=function(){return l([],this.collectedActions,!0)},e.prototype.cleanCollectedActions=function(){this.collectedActions=[]},e.prototype.retrieveSlowActionsBetweenTimeRange=function(e,t){return this.collectedActions.filter((function(n){return e>=n.startTime&&e<=n.endTime||t>=n.startTime&&t<=n.endTime}))},e}(),Qe=function(){function e(){}return e.prototype.getCurrentTimestamp=function(){return performance.now()},e}(),Xe=-1,Ye=function(){function e(e,t,n){return this.performanceAPIChecker=e,this.performanceTimestampRetriever=t,this.logger=n,this.startTimestamp=Xe,this.stopTimestamp=Xe,this.performanceAPIChecker.isPerformanceAPIAvailable()?this.performanceAPIChecker.isPerformanceNowDefined()?void(this.unsupportedEnvironment=!1):(this.logger.logPerformanceNowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logPerformanceMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0))}return e.prototype.start=function(){this.unsupportedEnvironment?this.logger.logStopWatchStartingInUnsupportedEnvironment():this.startTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.stop=function(){this.unsupportedEnvironment?this.logger.logStopWatchStoppingInUnsupportedEnvironment():this.stopTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.getElapsedTime=function(){if(this.startTimestamp===Xe)return this.logger.logGetElapsedTimeCalledWithoutCallingStart(),Xe;if(this.stopTimestamp===Xe)return this.logger.logGetElapsedTimeCalledWithoutCallingStop(),Xe;var e=this.stopTimestamp-this.startTimestamp;return this.resetTimestamps(),e},e.prototype.resetTimestamps=function(){this.startTimestamp=Xe,this.stopTimestamp=Xe},e}(),Ze=function(){function e(){}return e.prototype.logPerformanceMissingInJSEnvironment=function(){s.sendTraceTag(579110677,n.msoulscat_Wac_Telemetry,r.Error,"Unable to find performance in the JS environment")},e.prototype.logPerformanceNowMissingInJSEnvironment=function(){s.sendTraceTag(579110678,n.msoulscat_Wac_Telemetry,r.Error,"Unable to find performance.now in the JS environment")},e.prototype.logStopWatchStartingInUnsupportedEnvironment=function(){s.sendTraceTag(579110679,n.msoulscat_Wac_Telemetry,r.Error,"Starting the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logStopWatchStoppingInUnsupportedEnvironment=function(){s.sendTraceTag(579110680,n.msoulscat_Wac_Telemetry,r.Error,"Stopping the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logGetElapsedTimeCalledWithoutCallingStart=function(){s.sendTraceTag(579110683,n.msoulscat_Wac_Telemetry,r.Error,"Stopwatch needs to be started before you can get elapsed time")},e.prototype.logGetElapsedTimeCalledWithoutCallingStop=function(){s.sendTraceTag(579110684,n.msoulscat_Wac_Telemetry,r.Error,"Stopwatch needs to be stopped before you can get elapsed time")},e}(),$e=function(){function e(){}return e.prototype.isPerformanceAPIAvailable=function(){return null!=performance},e.prototype.isPerformanceNowDefined=function(){return"now"in performance},e}(),et=function(){function e(){}return e.createNewStopWatch=function(){var e=new Ze,t=new $e,n=new Qe;return new Ye(t,n,e)},e}(),tt=function(){function e(){this.serializedException="",this.wasSerializeExceptionCalled=!1}return e.prototype.serializeException=function(e){this.wasSerializeExceptionCalled=!0,null!=JSON&&"stringify"in JSON?this.serializedException=null!=Object&&"getOwnPropertyNames"in Object?JSON.stringify(e,Object.getOwnPropertyNames(e)):"":this.serializedException=""},e.prototype.retrieveSerializedException=function(){return this.wasSerializeExceptionCalled?(this.wasSerializeExceptionCalled=!1,this.serializedException):""},e}(),nt=function(){function e(){}return e.prototype.logOperation=function(e,t,n,r,o,i,a,c){},e.prototype.logFallbackResultReturned=function(){},e}(),rt=new(function(){function e(){this.elements=[]}return e.prototype.push=function(e){this.elements.unshift(e)},e.prototype.pop=function(){return this.elements.shift()},e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e}()),ot=function(){function e(e,t,n,r,o,i){var a=rt.peek(),c=void 0!==a?a:"";rt.push(e),this.logs=[],this.propertyBag=new Map;var s=et.createNewStopWatch();s.start();var u=void 0,l=!1;try{l=(u=t(this)).didOperationFailUnexpectedly}catch(e){o.serializeException(e),this.exception=o.retrieveSerializedException(),l=!0}this.operationResult=void 0!==u?u:n,s.stop(),!l&&r||i.logOperation(e,c,this.operationResult.didOperationSucceed,s.getElapsedTime(),l,this.logs,this.propertyBag,this.exception),rt.pop()}return e.prototype.addLog=function(e){this.logs.push(e)},e.prototype.addProperty=function(e,t){this.propertyBag.set(e,t)},e.prototype.getResult=function(){return this.operationResult.result},e.startNew=function(t,n,r,o,i,a){return new e(t,n,r,null!=i&&i,null==a?new tt:a,null==o?new nt:o)},e}(),it=function(){function e(e,t,n){this.didOperationSucceed=e,this.didOperationFailUnexpectedly=t,this.result=n}return e.generateOperationResult=function(t){return new e(t.didOperationSucceed,null!=t.didOperationFailUnexpectedly&&t.didOperationFailUnexpectedly,t.result)},e}(),at=(function(){function e(e,t){var n=this;this.windowPropertyChecker=e,this.logger=t,this.callbacks=[],this.windowPropertyChecker.hasProperty("addEventListener")?window.addEventListener("beforeunload",(function(){var e=it.generateOperationResult({didOperationSucceed:!1,result:void 0});ot.startNew("BeforeUnloadEventCallback",(function(){return n.callbacks.forEach((function(t){ot.startNew("BeforeUnloadEventIndividualCallback",(function(){return t(),it.generateOperationResult({didOperationSucceed:!0,result:void 0})}),e)})),it.generateOperationResult({didOperationSucceed:!0,result:void 0})}),e)})):this.logger.logWindowAddEventListenerNotFound()}e.prototype.subscribeForBeforeWindowUnloadEvent=function(e){this.callbacks.push(e)}}(),function(){function e(){}return e.prototype.logWindowMissingInJSEnvironment=function(){s.sendTraceTag(578834847,n.msoulscat_Wac_Telemetry,r.Warning,"Unable to find window in the JS environment")},e.prototype.logEmptyUserAgentString=function(){s.sendTraceTag(578834850,n.msoulscat_Wac_Telemetry,r.Error,"Empty user agent string")},e.prototype.logChromiumOnIOS=function(){s.sendTraceTag(578834851,n.msoulscat_Wac_Telemetry,r.Info,"iOS version of Chromium based browser detected")},e.prototype.logBrowserUserAgentNotChromiumBased=function(){s.sendTraceTag(578834880,n.msoulscat_Wac_Telemetry,r.Info,"Browser not chromium based")},e.prototype.logUserAgentSpoofedToBeChromium=function(){s.sendTraceTag(578834881,n.msoulscat_Wac_Telemetry,r.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logUserAgentToParseChromiumMajorVersionNumber=function(e){s.sendTraceTag(578834882,n.msoulscat_Wac_Telemetry,r.Info,e)},e.prototype.logChromeNotPresentInUserAgent=function(){s.sendTraceTag(578834883,n.msoulscat_Wac_Telemetry,r.Error,"Chrome was not found in the user agent")},e.prototype.logUnableToIsolateChromeInformationFromUserAgent=function(){s.sendTraceTag(578834884,n.msoulscat_Wac_Telemetry,r.Error,"Unable to isolate chrome information from the user agent")},e.prototype.logUnableToExtractChromeVersionInformation=function(){s.sendTraceTag(578834885,n.msoulscat_Wac_Telemetry,r.Error,"Unable to extract chrome version information from the user agent")},e.prototype.logUnableToParseChromeMajorVersionString=function(){s.sendTraceTag(578834886,n.msoulscat_Wac_Telemetry,r.Error,"Unable to parse the chromium major version number")},e.prototype.logRequestIdleCallbackMissing=function(){s.sendTraceTag(576582740,n.msoulscat_Wac_Telemetry,r.Warning,"Unable to find window.requestIdleCallback in the JS environment")},e.prototype.logCallbackBeingInvokedImmediately=function(){s.sendTraceTag(576582743,n.msoulscat_Wac_Telemetry,r.Error,"Callback is being invoked immediately as there is no platform support for deferring work")},e.prototype.logCancelIdleCallbackMissing=function(){s.sendTraceTag(576582744,n.msoulscat_Wac_Telemetry,r.Warning,"Unable to find window.cancelIdleCallback in the JS environment")},e.prototype.logUnknownMechanism=function(){s.sendTraceTag(576582747,n.msoulscat_Wac_Telemetry,r.Error,"Unable to find a way to cancel the idle time job")},e.prototype.logWindowSetTimeOutMissingInJSEnvironment=function(){s.sendTraceTag(576239755,n.msoulscat_Wac_Telemetry,r.Error,"window.setTimeout is missing in JS environment")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){s.sendTraceTag(576218121,n.msoulscat_Wac_Telemetry,r.Error,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPerformanceNowMissingInJSEnvironment=function(){s.sendTraceTag(576218122,n.msoulscat_Wac_Telemetry,r.Error,"Unable to find window.performance.now in the JS environment")},e.prototype.logNavigatorMissingInJSEnvironment=function(){s.sendTraceTag(574657350,n.msoulscat_Wac_Telemetry,r.Error,"Navigator is missing in the JS environment")},e.prototype.logSendBeaconNotSupported=function(){s.sendTraceTag(573970625,n.msoulscat_Wac_Telemetry,r.Info,"SendBeacon not supported in current environment")},e.prototype.logBeaconURLIsEmpty=function(){s.sendTraceTag(573919702,n.msoulscat_Wac_Telemetry,r.Error,"We were passed an empty URL for sendBeacon")},e.prototype.logBeaconDataIsEmpty=function(){s.sendTraceTag(573907718,n.msoulscat_Wac_Telemetry,r.Error,"We were passed an empty data for sendBeacon")},e.prototype.logDocumentMissingInJsEnvironment=function(){s.sendTraceTag(573572181,n.msoulscat_Wac_Telemetry,r.Error,"Document is not present in JS Environment")},e.prototype.logDocumentVisibilityStateMissingInJsEnvironment=function(){s.sendTraceTag(573572182,n.msoulscat_Wac_Telemetry,r.Error,"Document VisibilityState is not present in JS Environment")},e.prototype.logDocumentAddEventListenerMissingInJsEnvironment=function(){s.sendTraceTag(573572183,n.msoulscat_Wac_Telemetry,r.Error,"Document AddEventListener is not present in JS Environment")},e.prototype.logWindowAddEventListenerNotFound=function(){s.sendTraceTag(538710337,n.msoulscat_Wac_Telemetry,r.Error,"Window AddEventListener is not present in JS Environment")},e.prototype.logPerformanceEventCountsNotSupported=function(){s.sendTraceTag(537522270,n.msoulscat_Wac_Telemetry,r.Warning,"Performance.EventCounts is not present in JS Environment")},e.prototype.logRemoveQueryParamsNotCalled=function(){s.sendTraceTag(527439250,n.msoulscat_Wac_Telemetry,r.Error,"Remove query params was not called before retrieve")},e.prototype.logWindowPerformanceEventCountsMissingInJSEnvironment=function(){s.sendTraceTag(525099864,n.msoulscat_Wac_Telemetry,r.Info,"window.performance.eventcounts was not present in the JS environment")},e}()),ct=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,n=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckWindowProperty",(function(n){if(null==window)return t.logger.logWindowMissingInJSEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("PropertyNameChecked",e);var r=e in window;return n.addProperty("DoesPropertyExistOnWindow",r),it.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()},e}(),st=(function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t,this.isEventCountsAPIAvailable=!0,this.windowPropertyChecker.hasProperty("performance")||(this.logger.logWindowPerformanceMissingInJSEnvironment(),this.isEventCountsAPIAvailable=!1),null==window.performance.eventCounts&&(this.logger.logWindowPerformanceEventCountsMissingInJSEnvironment(),this.isEventCountsAPIAvailable=!1)}e.prototype.getEventCounts=function(){return this.isEventCountsAPIAvailable,new Map}}(),function(){function e(e){this.logger=e,this.wasRemoveQueryParamsCalled=!1,this.queryParamsRemovedURL=""}e.prototype.removeQueryParams=function(e){this.wasRemoveQueryParamsCalled=!0,this.queryParamsRemovedURL=e.split("?")[0]},e.prototype.retrieveQueryParamsRemovedURL=function(){return this.wasRemoveQueryParamsCalled?(this.wasRemoveQueryParamsCalled=!1,this.queryParamsRemovedURL):(this.logger.logRemoveQueryParamsNotCalled(),"")}}(),function(){function e(){}e.prototype.addEventListener=function(e,t){},e.prototype.onError=function(e){},e.prototype.postMessage=function(e){},e.prototype.terminate=function(){}}(),function(){function e(){this.xmlHTTPRequest=new XMLHttpRequest}return e.prototype.open=function(e,t,n){this.xmlHTTPRequest.open(e,t,n)},e.prototype.send=function(e){this.xmlHTTPRequest.send(e)},e}()),ut=(function(){function e(){}e.prototype.generateXMLHTTPRequestWrapper=function(){return new st}}(),-1),lt="InvalidUnderlyingMechanism",dt="requestIdleCallback",pt="hidden";(function(){function e(e){this.logger=e}e.prototype.isBrowserChromiumBased=function(e){return function(e,t){var n=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckChromiumBrowser",(function(n){if(n.addProperty("UserAgent",e),0===e.localeCompare(""))return t.logEmptyUserAgentString(),it.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var r=e.match(/(Chrome\/|CriOS\/)/g);return null!=e.match(/(CriOS\/)/g)&&t.logChromiumOnIOS(),null===r?(t.logBrowserUserAgentNotChromiumBased(),it.generateOperationResult({didOperationSucceed:!0,result:!1})):it.generateOperationResult({didOperationSucceed:!0,result:!0})}),n).getResult()}(e,this.logger)},e.prototype.parseChromeMajorVersionNumber=function(e){return function(e,t){var n=it.generateOperationResult({didOperationSucceed:!1,result:ut});return ot.startNew("ParseChromiumMajorVersionNumber",(function(n){n.addProperty("UserAgent",e);var r=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==r)return t.logChromeNotPresentInUserAgent(),it.generateOperationResult({didOperationSucceed:!1,result:ut});var o=r[0].split("/");if(o.length<2)return t.logUnableToIsolateChromeInformationFromUserAgent(),it.generateOperationResult({didOperationSucceed:!1,result:ut});var i=o[1].split(".");if(i.length<4)return t.logUnableToExtractChromeVersionInformation(),it.generateOperationResult({didOperationSucceed:!1,result:ut});var a=i[0],c=parseInt(a,10);return isNaN(c)?(t.logUnableToParseChromeMajorVersionString(),it.generateOperationResult({didOperationSucceed:!1,result:ut})):(n.addProperty("MajorVersionNumber",c),it.generateOperationResult({didOperationSucceed:!0,result:c}))}),n).getResult()}(e,this.logger)}})(),function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t}e.prototype.scheduleJobForIdleTime=function(e){var t,n,r,o;t=function(){e()},n=this.windowPropertyChecker,r=this.logger,o=it.generateOperationResult({didOperationSucceed:!1,result:{id:-1,underlyingMechanism:lt}}),ot.startNew("RequestIdleCallbackShim",(function(){if(n.hasProperty(dt)){var e=window.requestIdleCallback(t,undefined);return it.generateOperationResult({didOperationSucceed:!0,result:{id:e,underlyingMechanism:dt}})}r.logRequestIdleCallbackMissing();Date.now();return r.logCallbackBeingInvokedImmediately(),t(),it.generateOperationResult({didOperationSucceed:!0,result:{id:-1,underlyingMechanism:lt}})}),o).getResult()}}(),function(){function e(){}e.prototype.getBooleanPropertyValue=function(e){var t=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckSelfProperty",(function(t){t.addProperty("PropertyChecked",e);var n=!!self.hasOwnProperty(e)&&self[e];return it.generateOperationResult({didOperationSucceed:!0,result:n})}),t).getResult()}}(),function(){function e(e){this.selfPropertyChecker=e}e.prototype.isSiteCrossOriginIsolated=function(){var e=this,t=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckCrossOriginSiteIsolation",(function(){var t=e.selfPropertyChecker.getBooleanPropertyValue("crossOriginIsolated");return it.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()}}(),function(){function e(e){this.logger=e}e.prototype.setTimerJob=function(e,t){var n=this,r=it.generateOperationResult({didOperationSucceed:!1,result:void 0});ot.startNew("SetTimerJob",(function(){return null==window?(n.logger.logWindowMissingInJSEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):null==window.setTimeout?(n.logger.logWindowSetTimeOutMissingInJSEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):(window.setTimeout(e,t),it.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),r)}}(),function(){function e(e){var t=this;this.logger=e,this.onVisibilityChange=function(){t.updateIsHidden()},this.isDocumentPresentInJsEnvironment()||this.logger.logDocumentMissingInJsEnvironment(),this.isDocumentVisibilityStatePresentInJsEnvironment()||this.logger.logDocumentVisibilityStateMissingInJsEnvironment(),this.isDocumentAddEventListenerPresentInJsEnvironment()||this.logger.logDocumentAddEventListenerMissingInJsEnvironment(),this.lastUnHiddenDate=void 0,this.isDocumentHidden=!1,this.updateIsHidden(),document.addEventListener("visibilitychange",this.onVisibilityChange)}e.prototype.isDocumentVisibleNow=function(){var e=this,t=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckDocumentVisibility",(function(){if(!e.isDocumentPresentInJsEnvironment())return e.logger.logDocumentMissingInJsEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});if(!e.isDocumentVisibilityStatePresentInJsEnvironment())return e.logger.logDocumentVisibilityStateMissingInJsEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var t=document.visibilityState!==pt;return it.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.wasDocumentHiddenDuringTimeRange=function(e){var t=this,n=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("WasDocumentHiddenDuringTimeRange",(function(){if(t.isDocumentHidden)return it.generateOperationResult({didOperationSucceed:!0,result:!0});if(void 0===t.lastUnHiddenDate)return it.generateOperationResult({didOperationSucceed:!0,result:!1});var n=Date.now()-t.lastUnHiddenDate<e;return it.generateOperationResult({didOperationSucceed:!0,result:n})}),n).getResult()},e.prototype.isDocumentPresentInJsEnvironment=function(){return null!=document},e.prototype.isDocumentVisibilityStatePresentInJsEnvironment=function(){return"visibilityState"in document},e.prototype.isDocumentAddEventListenerPresentInJsEnvironment=function(){return"addEventListener"in document},e.prototype.updateIsHidden=function(){this.isDocumentHidden=document.visibilityState===pt,this.isDocumentHidden||(this.lastUnHiddenDate=Date.now())}}();!function(e){e.SendBeacon="sendBeacon"}(ze||(ze={}));var mt;(function(){function e(e,t,n,r){this.navigatorPropertyChecker=e,this.navigatorAPI=t,this.xmlHTTPRequestWrapperFactory=n,this.logger=r}e.prototype.sendBeacon=function(e){return t=this.navigatorPropertyChecker,n=this.navigatorAPI,r=this.xmlHTTPRequestWrapperFactory,o=this.logger,i=e.url,a=e.data,c=it.generateOperationResult({didOperationSucceed:!1,result:!1}),ot.startNew("SendBeaconCall",(function(e){if(0===i.length)return o.logBeaconURLIsEmpty(),it.generateOperationResult({didOperationSucceed:!1,result:!1});if(0===a.length)return o.logBeaconDataIsEmpty(),it.generateOperationResult({didOperationSucceed:!1,result:!1});if(!t.hasProperty(ze.SendBeacon)){o.logSendBeaconNotSupported();var c=r.generateXMLHTTPRequestWrapper();return c.open("POST",i,!0),c.send(a),e.addProperty("POSTRequestSent",!0),it.generateOperationResult({didOperationSucceed:!0,result:!0})}var s=n.sendBeacon(i,a);return e.addProperty("BeaconRequestSuccessfullyQueued",s),it.generateOperationResult({didOperationSucceed:!0,result:s})}),c).getResult();var t,n,r,o,i,a,c}})(),function(){function e(e){this.logger=e}e.prototype.hasProperty=function(e){var t=this,n=it.generateOperationResult({didOperationSucceed:!1,result:!1});return ot.startNew("CheckNavigatorProperty",(function(n){if(null==navigator)return t.logger.logNavigatorMissingInJSEnvironment(),it.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("NavigatorPropertyChecked",e);var r=e in navigator;return n.addProperty("IsPropertyPresentInNavigatorResult",r),it.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()}}(),function(){function e(e){this.logger=e}e.prototype.sendBeacon=function(e,t){return null==navigator?(this.logger.logNavigatorMissingInJSEnvironment(),!1):navigator.sendBeacon(e,t)}}(),function(){function e(e){this.logger=e}e.prototype.getCurrentTimestamp=function(){if(null!=window)if(null!=window.performance){if(null!=window.performance.now)return window.performance.now();this.logger.logWindowPerformanceNowMissingInJSEnvironment()}else this.logger.logWindowPerformanceMissingInJSEnvironment();else this.logger.logWindowMissingInJSEnvironment()}}(),function(){function e(){this.elements=[]}e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e.prototype.queue=function(e){this.elements.push(e)},e.prototype.dequeue=function(){this.elements.shift()},e.prototype.length=function(){return this.elements.length}}(),function(){function e(e){this.logger=e,this.logger=e}e.prototype.retrieveUserAgent=function(){var e=this,t=it.generateOperationResult({didOperationSucceed:!1,result:""});return ot.startNew("RetrieveUserAgent",(function(){var t=e.getUserAgentFromNavigatorAPI();return it.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.getUserAgentFromNavigatorAPI=function(){return"undefined"==typeof navigator?(this.logger.logNavigatorMissingInJSEnvironment(),""):navigator.userAgent}}(),function(){function e(){this.elements=[]}e.prototype.peek=function(){var e=this.count();if(0!==e)return this.elements[e-1]},e.prototype.push=function(e){this.elements.push(e)},e.prototype.pop=function(){this.elements.pop()},e.prototype.count=function(){return this.elements.length}}(),function(){function e(){}e.getWindowPropertyChecker=function(){var e=new at;return new ct(e)}}(),function(){function e(e){this.windowPropertyChecker=e}e.prototype.isWebWorkerAPIAvailable=function(){return!!this.windowPropertyChecker.hasProperty("Worker")},e.prototype.isSharedWebWorkerAPIAvailable=function(){return!!this.windowPropertyChecker.hasProperty("SharedWorker")}}(),function(){function e(){}e.prototype.generateGuid=function(){return""}}();function ft(e){return void 0===e&&(e=void 0),mt={animationStart:e&&e.timeStamp?e.timeStamp:performance.now(),lastAnimationChunkStart:performance.now(),currentAnimationFrameTimestamp:performance.now(),currentChunkFrameCount:0,currentAnimationTotalChunks:0,currentAnimationSlowChunks:0,lastAppState:"",rafId:void 0,wasClearedOnTimeout:!1}}function gt(){return mt}var vt,ht="ConsecutiveChunksMeasure",Tt=!1;function yt(e){return window.requestAnimationFrame((function(){!function(e){!function(e){var t=gt();if(At(t))Ot(t,e);else{t.currentAnimationFrameTimestamp=performance.now();var n=t.currentAnimationFrameTimestamp-t.lastAnimationChunkStart,r=U.chunkDurationMs;if(n<r)t.currentChunkFrameCount++;else{var o=Math.floor(n/r);!function(e,t,n){var r={name:e,chunks:t,slowChunksDetails:void 0},o=gt();o.currentChunkFrameCount<U.minFramesPerChunk?r.slowChunksDetails={slowAnimationPeriodStart:o.lastAnimationChunkStart,slowAnimationPeriodDuration:t*n,slowChunksNumber:t}:t>1&&(r.slowChunksDetails={slowAnimationPeriodStart:o.lastAnimationChunkStart+n,slowAnimationPeriodDuration:(t-1)*n,slowChunksNumber:t-1}),performance.measure(ht,{start:o.lastAnimationChunkStart,duration:t*n,detail:r})}(e,o,r),t.lastAnimationChunkStart+=o*r,t.currentChunkFrameCount=1}}}(e),wt(gt())&&(gt().rafId=yt(e))}(e)}))}function _t(e){kt().disconnect(),performance.clearMeasures(ht),window.cancelAnimationFrame(e.rafId),e.currentAnimationTotalChunks=0,e.currentAnimationSlowChunks=0,e.rafId=void 0}function wt(e){return void 0!==(null==e?void 0:e.rafId)}function St(e){e.getEntriesByName(ht).forEach((function(e){!function(e){s.debugAssertTag(507912414,n.msoulscat_Wac_BrowserGeneral,"measure"===e.entryType,"AnimationTracker:validateMeasureEntry - unexpected observed entry type: ".concat(e.entryType))}(e);var t=gt(),r=e.detail,i=r.name;t.currentAnimationTotalChunks+=r.chunks;var a=r.slowChunksDetails;if(!ue(a)){t.currentAnimationSlowChunks+=a.slowChunksNumber;var c={action:i};Je(o.EndTrackSlowAction,c,t.lastAppState,a.slowAnimationPeriodStart,a.slowAnimationPeriodStart+a.slowAnimationPeriodDuration)}})),performance.clearMeasures(ht)}function kt(){return void 0!==vt?vt:vt=new PerformanceObserver(St)}function Wt(e){return"hidden"===document.visibilityState&&(_t(e),s.sendTraceTag(507593093,n.msoulscat_Wac_BrowserGeneral,r.Info,"AnimationTracker: updateDocumentVisibility - clear animation tracking due to document visibility: ".concat(document.visibilityState)),!0)}function Ot(e,t){_t(e),e.wasClearedOnTimeout=!0,s.sendTraceTag(507593045,n.msoulscat_Wac_BrowserGeneral,r.Info,"AnimationTracker:handleTimeOut - animation timeout for animation: ".concat(t,", gap: ").concat(e.currentAnimationFrameTimestamp-e.animationStart,", docmunet visibility: ").concat(document.visibilityState))}function At(e){return e.currentAnimationFrameTimestamp-e.animationStart>U.animationTimeoutMs}ft();var Et=!1,It=function(){function e(){}return e.prototype.create=function(){var e,t,o,i=new Error;if(null===(e=i.stack)||void 0===e?void 0:e.includes){var a=null===(t=i.stack)||void 0===t?void 0:t.includes("interactivity.min.js"),c=null===(o=i.stack)||void 0===o?void 0:o.includes("gridRenderer.min.js");s.sendTraceTag(539492420,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTrackerFactory.create: isScriptFromNewSlice: ".concat(a,", isScriptFromOldSlice: ").concat(c))}if(function(){var e;if(!window.PerformanceObserver)return s.sendTraceTag(539829760,n.msoulscat_Wac_BrowserGeneral,r.Warning,"InteractivityTracker:isInteractivityTrackerSupported:false - no PerformanceObserver"),!1;if(!PerformanceObserver.supportedEntryTypes)return s.sendTraceTag(539829761,n.msoulscat_Wac_BrowserGeneral,r.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver missing supportedEntryTypes"),!1;if((null===(e=null===PerformanceObserver||void 0===PerformanceObserver?void 0:PerformanceObserver.supportedEntryTypes)||void 0===e?void 0:e.indexOf("event"))<0)return s.sendTraceTag(539829762,n.msoulscat_Wac_BrowserGeneral,r.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver not supporting event timing"),!1;var t="undefined"==typeof navigator?"":navigator.userAgent;return function(e){return 0!==e.localeCompare("")&&null!==e.match(/(Chrome\/|CriOS\/)/g)}(t)?!(function(e){var t=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==t)return ut;var n=t[0].split("/");if(n.length<2)return ut;var r=n[1].split(".");if(r.length<4)return ut;var o=r[0],i=parseInt(o,10);return isNaN(i)?ut:i}(t)<85&&(s.sendTraceTag(539829764,n.msoulscat_Wac_BrowserGeneral,r.Warning,"isInteractivityTrackerSupported:false - user agent chromium version < 85"),1)):(s.sendTraceTag(539829763,n.msoulscat_Wac_BrowserGeneral,r.Warning,"isInteractivityTrackerSupported:false - user agent is not chromium based."),!1)}()){var u=window.__InteractivityTracker__;return u||(u=window.__InteractivityTracker__=new Ct),u}},e}(),Ct=function(){function e(){}return e.prototype.start=function(e){return te(e)},e.prototype.stop=function(){return re()},e.prototype.track=function(e,t,o){return Et||(Et=!0,s.sendTraceTag(508056529,n.msoulscat_Wac_BrowserGeneral,r.Info,"InteractivityTrackerFactory.track: used deprecated method track")),Be(e,t,o,void 0)},e.prototype.trackInteraction=function(e,t,n,r){return Be(e,t,n,r)},e.prototype.trackAsyncUi=function(e,t,n,r){!function(e,t,n,r){if(Ue(e,t)&&xe(r)&&he()){var o=n?l([],n,!0):[];Me(r)&&o.push({itemKey:"action",value:r});var i=Re(t,je(),n,e);if(j()&&i.length>0){var a=Pe(Ve(e.type,e.timeStamp),r||t[0]);Oe.set(a,new Set(i));for(var c=0,s=i;c<s.length;c++)s[c].contextKey=a}}}(e,t,n,r)},e.prototype.addContext=function(e,t,n){e&&t&&function(e,t){if(j())for(var n=0,r=Array.from(Oe.get(e)||[]);n<r.length;n++)r[n].contexts.push(t);else{var o=function(e){var t=e.split(be),n=t[0],r=t[1];if(ke[n])return ke[n].find((function(e){return e.action===r}))}(e);null==o||o.contexts.push(t)}}(e,{itemKey:t,value:n})},e.prototype.isEventSupportedForTracking=function(e){return!!e&&W(e.type)},e.prototype.createActionsRetriever=function(){var e=new Ke;return Ce(o.EndTrackSlowAction,e.collectSlowUserAction),e},e.prototype.addEventListener=function(e,t){t&&Ce(e,t)},e.prototype.removeEventListener=function(e,t){t&&function(e,t){if(Ie){var o=Se().get(e);o&&Ie.removeEventListener(o,(function(e){return t(e.detail)}))}else s.sendTraceTag(527522002,n.msoulscat_Wac_BrowserGeneral,r.Error,"InteractivityTracker.removeEventListener InteractivityTrackerEventTarget is null}")}(e,t)},e.prototype.recentAppState=function(){return Z()},e.prototype.trackedUserActionsReport=function(){var e=v();if(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],i=o[0],a=o[1],c={action:i,actionBucket:a.actionBucket};t.push({userAction:i,actionBucket:se(c),total:a.total,slow:a.slow})}return t}},e.prototype.startTrackAnimation=function(e,t){return!!t&&function(e,t){if(!ve()||ue(t))return!1;var n=gt();return wt(n)&&_t(n),n=ft(e),ae("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&!Tt&&function(e){window.addEventListener("visibilitychange",(function(){wt(e)&&Wt(e)})),Tt=!0}(n),n.lastAppState=je(),kt().observe({type:"measure",buffered:!0}),n.rafId=yt(t),!ae("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")||!Wt(n)}(e,t)},e.prototype.stopTrackAnimation=function(e){e&&function(e){if(ve()&&!ue(e)){var t=gt();if(t.wasClearedOnTimeout)return t.wasClearedOnTimeout=!1,void s.sendTraceTag(507912418,n.msoulscat_Wac_BrowserGeneral,r.Warning,"AnimationTracker:stopAnimationTracking - called stop animation after timeout: ".concat(e));if(void 0!==t.rafId)if(ae("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&At(t))Ot(t,e);else{var o={action:e};t.currentAnimationTotalChunks>0&&(T(o,"total",t.currentAnimationTotalChunks),T(o,"slow",t.currentAnimationSlowChunks),s.sendTraceTag(507912415,n.msoulscat_Wac_BrowserGeneral,r.Info,"AnimationTracker.stopTrackAnimation - animationName: ".concat(e," totalChunks: ").concat(t.currentAnimationTotalChunks," slowChunks: ").concat(t.currentAnimationSlowChunks))),_t(t)}else s.sendTraceTag(507912417,n.msoulscat_Wac_BrowserGeneral,r.Warning,"AnimationTracker:stopAnimationTracking - stop animation for animation wasn't started: ".concat(e))}}(e)},e.prototype.isAsyncUiNameAllowed=function(e){return!!e&&z(e)},e}(),bt=new It;function Pt(){return bt}interactivity=t}();
//# sourceMappingURL=interactivity.min.js.map